<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>PS51020A Research Methods &amp; Statistics 2024/5 – T-Tests</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../week31/dataskills.html" rel="next">
<link href="../week01/lecture-slides.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/monaco-editor@0.47.0/min/vs/editor/editor.main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
  
<style type="text/css">
.monaco-editor pre {
  background-color: unset !important;
}

.qwebr-editor-toolbar {
  width: 100%;
  display: flex;
  justify-content: space-between;
  box-sizing: border-box;
}

.qwebr-editor-toolbar-left-buttons, .qwebr-editor-toolbar-right-buttons {
  display: flex;
}

.qwebr-non-interactive-loading-container.qwebr-cell-needs-evaluation, .qwebr-non-interactive-loading-container.qwebr-cell-evaluated {
  justify-content: center;
  display: flex;
  background-color: rgba(250, 250, 250, 0.65);
  border: 1px solid rgba(233, 236, 239, 0.65);
  border-radius: 0.5rem;
  margin-top: 15px;
  margin-bottom: 15px;
}

.qwebr-r-project-logo {
  color: #2767B0; /* R Project's blue color */
}

.qwebr-icon-status-spinner {
  color: #7894c4;
}

.qwebr-icon-run-code {
  color: #0d9c29
}

body.quarto-light .qwebr-output-code-stdout {
  color: #111;
}

body.quarto-dark .qwebr-output-code-stdout {
  color: #EEE;
}

.qwebr-output-code-stderr {
  color: #db4133;
}

body.quarto-light .qwebr-editor {
  border: 1px solid #EEEEEE;
}

body.quarto-light .qwebr-editor-toolbar {
  background-color: #EEEEEE;
  padding: 0.2rem 0.5rem;
}

body.quarto-dark .qwebr-editor {
  border: 1px solid #111;
}

body.quarto-dark .qwebr-editor-toolbar {
  background-color: #111;
  padding: 0.2rem 0.5rem;
}

.qwebr-button {
  display: inline-block;
  font-weight: 400;
  line-height: 1;
  text-decoration: none;
  text-align: center;
  padding: 0.375rem 0.75rem;
  font-size: .9rem;
  border-radius: 0.25rem;
  transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;
}

body.quarto-light .qwebr-button {
  background-color: #EEEEEE;
  color: #000;
  border-color: #dee2e6;
  border: 1px solid rgba(0,0,0,0);
}

body.quarto-dark .qwebr-button {
  background-color: #111;
  color: #EEE;
  border-color: #dee2e6;
  border: 1px solid rgba(0,0,0,0);
}

body.quarto-light .qwebr-button:hover {
  color: #000;
  background-color: #d9dce0;
  border-color: #c8ccd0;
}

body.quarto-dark .qwebr-button:hover {
  color: #d9dce0;
  background-color: #323232;
  border-color: #d9dce0;
}

.qwebr-button:disabled,.qwebr-button.disabled,fieldset:disabled .qwebr-button {
  pointer-events: none;
  opacity: .65
}

.qwebr-button-reset {
  color: #696969; /*#4682b4;*/
}

.qwebr-button-copy {
  color: #696969;
}

/* Style the code highlight lines */
body.quarto-light .qwebr-editor-highlight-line {
  background-color: lightblue;
}

body.quarto-dark .qwebr-editor-highlight-line {
  background-color: darkblue;
}

/* Style the modal pop-up */

/* The Modal (background) */
.qwebr-modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
  padding-top: 60px;
}

/* Modal Content */
.qwebr-modal-content {
  background-color: #fefefe;
  margin: 5% auto; /* 15% from the top and centered */
  padding: 20px;
  border: 1px solid #888;
  width: 80%; /* Could be more or less, depending on screen size */
}

.qwebr-modal-content-code {
  max-height: 50vh;
  min-height: 5vh;
  overflow: scroll;
  border: 1px solid #888;
}

/* The Close Button */
.qwebr-modal-close {
  color: #aaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.qwebr-modal-close:hover,
.qwebr-modal-close:focus {
  color: black;
  text-decoration: none;
  cursor: pointer;
}

.qwebr-download-btn {
  margin-top: 10px;
  text-decoration: none !important;
}

/* Styling to download image that is created */

.qwebr-canvas-image {
  position: relative;
  display: inline-block;
  margin: 10px;
}

.qwebr-canvas-image-download-btn {
  position: absolute;
  top: 10px;
  right: 10px;
  padding: 5px 10px;
  background-color: #007BFF;
  color: white;
  border: none;
  cursor: pointer;
  display: none;
}

figure:hover .qwebr-canvas-image-download-btn {
  display: block;
}

/* Custom styling for RevealJS Presentations*/

/* Reset the style of the interactive area */
.reveal div.qwebr-interactive-area {
  display: block;
  box-shadow: none;
  max-width: 100%;
  max-height: 100%;
  margin: 0;
  padding: 0;
} 

/* Provide space to entries */
.reveal div.qwebr-output-code-area pre div {
  margin: 1px 2px 1px 10px;
}

/* Collapse the inside code tags to avoid extra space between line outputs */
.reveal pre div code.qwebr-output-code-stdout, .reveal pre div code.qwebr-output-code-stderr {
  padding: 0;
  display: contents;
}

body.reveal.quarto-light pre div code.qwebr-output-code-stdout {
  color: #111;
}

body.reveal.quarto-dark pre div code.qwebr-output-code-stdout {
  color: #EEEEEE;
}

.reveal pre div code.qwebr-output-code-stderr {
  color: #db4133;
}


/* Create a border around console and output (does not effect graphs) */
body.reveal.quarto-light div.qwebr-console-area {
  border: 1px solid #EEEEEE;
  box-shadow: 2px 2px 10px #EEEEEE;
}

body.reveal.quarto-dark div.qwebr-console-area {
  border: 1px solid #111;
  box-shadow: 2px 2px 10px #111;
}


/* Cap output height and allow text to scroll */
/* TODO: Is there a better way to fit contents/max it parallel to the monaco editor size? */
.reveal div.qwebr-output-code-area pre {
  max-height: 400px;
  overflow: scroll;
}

</style>
<script type="module">
// Document level settings ----

// Determine if we need to install R packages
globalThis.qwebrInstallRPackagesList = ['ggplot2', 'dplyr'];

// Specify possible locations to search for the repository
globalThis.qwebrPackageRepoURLS = ['https://repo.r-wasm.org/'];

// Check to see if we have an empty array, if we do set to skip the installation.
globalThis.qwebrSetupRPackages = !(qwebrInstallRPackagesList.indexOf("") !== -1);
globalThis.qwebrAutoloadRPackages = true;

// Display a startup message?
globalThis.qwebrShowStartupMessage = true;
globalThis.qwebrShowHeaderMessage = false;

// Describe the webR settings that should be used
globalThis.qwebrCustomizedWebROptions = {
  "baseURL": "https://webr.r-wasm.org/v0.4.0/",
  "serviceWorkerUrl": "",
  "homedir": "/home/web_user", 
  "channelType": "ChannelType.Automatic"
};

// Store cell data
globalThis.qwebrCellDetails = [{"code":"sample_mean <- length(1000)\nsample_se <- length(1000)\n\nfor (i in 1:1000) {\n  s <- rnorm(10, 0, 1)\n  sample_mean[i] <- mean(s)\n  sample_se[i] <- sd(s) / sqrt(length(s))\n}\n\nplot(sample_mean, sample_se)","id":1,"options":{"editor-word-wrap":"true","comment":"","dpi":72,"fig-cap":"","context":"interactive","message":"true","fig-height":5,"fig-width":7,"editor-quick-suggestions":"false","results":"markup","output":"true","warning":"true","editor-font-scale":"1","label":"unnamed-chunk-1","autorun":"false","out-width":"700px","read-only":"false","out-height":"","editor-max-height":"","classes":""}},{"code":"# Initialize vectors to store the sample means and standard errors, each of length 1000\nsample_mean <- numeric(1000)  # creates a numeric vector of length 1000 filled with zeros\nsample_se <- numeric(1000)    # creates a numeric vector of length 1000 filled with zeros\n\n# Run a loop 1000 times to generate samples, calculate their means, and standard errors\nfor (i in 1:1000) { # <1>\n  # Generate a sample of 10 random numbers from a normal distribution with mean 0 and standard deviation 1\n  s <- rnorm(10, 0, 1) # <2>\n  \n  # Calculate the mean of the sample and store it in the ith position of the sample_mean vector\n  sample_mean[i] <- mean(s)\n  \n  # Calculate the standard error of the sample mean and store it in the ith position of the sample_se vector\n  sample_se[i] <- sd(s) / sqrt(length(s))\n}\n\n# Plot the sample means against their corresponding standard errors\nplot(sample_mean, sample_se)","id":2,"options":{"editor-word-wrap":"true","comment":"","dpi":72,"fig-cap":"","context":"interactive","message":"true","fig-height":5,"fig-width":7,"editor-quick-suggestions":"false","results":"markup","output":"true","warning":"true","editor-font-scale":"1","label":"unnamed-chunk-2","autorun":"false","out-width":"700px","read-only":"false","out-height":"","editor-max-height":"","classes":""}},{"code":"# Simulated data\nCBT <- c(23, 19, 21, 22, 20, 24, 25, 18, 22, 23)\nPlacebo <- c(30, 28, 27, 29, 31, 32, 33, 30, 29, 28)\n\n# Combine into a data frame\ndata <- data.frame(\n  group = factor(rep(c(\"CBT\", \"Placebo\"), each = 10)),\n  anxiety = c(CBT, Placebo)\n)\n\n# View the data\nprint(data)","id":3,"options":{"editor-word-wrap":"true","comment":"","dpi":72,"fig-cap":"","context":"interactive","message":"true","fig-height":5,"fig-width":7,"editor-quick-suggestions":"false","results":"markup","output":"true","warning":"true","editor-font-scale":"1","label":"unnamed-chunk-3","autorun":"false","out-width":"700px","read-only":"false","out-height":"","editor-max-height":"","classes":""}},{"code":"# Independent samples t-test\nt_test_results <- t.test(anxiety ~ group, data = data)\n\n# Display the results\nprint(t_test_results)","id":4,"options":{"editor-word-wrap":"true","comment":"","dpi":72,"fig-cap":"","context":"interactive","message":"true","fig-height":5,"fig-width":7,"editor-quick-suggestions":"false","results":"markup","output":"true","warning":"true","editor-font-scale":"1","label":"unnamed-chunk-4","autorun":"false","out-width":"700px","read-only":"false","out-height":"","editor-max-height":"","classes":""}}];

</script>
<script type="module">
// Declare startupMessageQWebR globally
globalThis.qwebrStartupMessage = document.createElement("p");

// Verify if OffScreenCanvas is supported
globalThis.qwebrOffScreenCanvasSupport = function() {
  return typeof OffscreenCanvas !== 'undefined'
}

// Function to set the button text
globalThis.qwebrSetInteractiveButtonState = function(buttonText, enableCodeButton = true) {
  document.querySelectorAll(".qwebr-button-run").forEach((btn) => {
    btn.innerHTML = buttonText;
    btn.disabled = !enableCodeButton;
  });
}

// Function to update the status message in non-interactive cells
globalThis.qwebrUpdateStatusMessage = function(message) {
  document.querySelectorAll(".qwebr-status-text.qwebr-cell-needs-evaluation").forEach((elem) => {
    elem.innerText = message;
  });
}

// Function to update the status message
globalThis.qwebrUpdateStatusHeader = function(message) {
  qwebrStartupMessage.innerHTML = `
    <i class="fa-solid fa-spinner fa-spin qwebr-icon-status-spinner"></i>
    <span>${message}</span>`;
}

// Function to return true if element is found, false if not
globalThis.qwebrCheckHTMLElementExists = function(selector) {
  const element = document.querySelector(selector);
  return !!element;
}

// Function that detects whether reveal.js slides are present
globalThis.qwebrIsRevealJS = function() {
  // If the '.reveal .slides' selector exists, RevealJS is likely present
  return qwebrCheckHTMLElementExists('.reveal .slides');
}

// Initialize the Quarto sidebar element
function qwebrSetupQuartoSidebar() {
  var newSideBarDiv = document.createElement('div');
  newSideBarDiv.id = 'quarto-margin-sidebar';
  newSideBarDiv.className = 'sidebar margin-sidebar';
  newSideBarDiv.style.top = '0px';
  newSideBarDiv.style.maxHeight = 'calc(0px + 100vh)';

  return newSideBarDiv;
}

// Position the sidebar in the document
function qwebrPlaceQuartoSidebar() {
  // Get the reference to the element with id 'quarto-document-content'
  var referenceNode = document.getElementById('quarto-document-content');

  // Create the new div element
  var newSideBarDiv = qwebrSetupQuartoSidebar();

  // Insert the new div before the 'quarto-document-content' element
  referenceNode.parentNode.insertBefore(newSideBarDiv, referenceNode);
}

function qwebrPlaceMessageContents(content, html_location = "title-block-header", revealjs_location = "title-slide") {

  // Get references to header elements
  const headerHTML = document.getElementById(html_location);
  const headerRevealJS = document.getElementById(revealjs_location);

  // Determine where to insert the quartoTitleMeta element
  if (headerHTML || headerRevealJS) {
    // Append to the existing "title-block-header" element or "title-slide" div
    (headerHTML || headerRevealJS).appendChild(content);
  } else {
    // If neither headerHTML nor headerRevealJS is found, insert after "webr-monaco-editor-init" script
    const monacoScript = document.getElementById("qwebr-monaco-editor-init");
    const header = document.createElement("header");
    header.setAttribute("id", "title-block-header");
    header.appendChild(content);
    monacoScript.after(header);
  }
}



function qwebrOffScreenCanvasSupportWarningMessage() {
  
  // Verify canvas is supported.
  if(qwebrOffScreenCanvasSupport()) return;

  // Create the main container div
  var calloutContainer = document.createElement('div');
  calloutContainer.classList.add('callout', 'callout-style-default', 'callout-warning', 'callout-titled');

  // Create the header div
  var headerDiv = document.createElement('div');
  headerDiv.classList.add('callout-header', 'd-flex', 'align-content-center');

  // Create the icon container div
  var iconContainer = document.createElement('div');
  iconContainer.classList.add('callout-icon-container');

  // Create the icon element
  var iconElement = document.createElement('i');
  iconElement.classList.add('callout-icon');

  // Append the icon element to the icon container
  iconContainer.appendChild(iconElement);

  // Create the title container div
  var titleContainer = document.createElement('div');
  titleContainer.classList.add('callout-title-container', 'flex-fill');
  titleContainer.innerText = 'Warning: Web Browser Does Not Support Graphing!';

  // Append the icon container and title container to the header div
  headerDiv.appendChild(iconContainer);
  headerDiv.appendChild(titleContainer);

  // Create the body container div
  var bodyContainer = document.createElement('div');
  bodyContainer.classList.add('callout-body-container', 'callout-body');

  // Create the paragraph element for the body content
  var paragraphElement = document.createElement('p');
  paragraphElement.innerHTML = 'This web browser does not have support for displaying graphs through the <code>quarto-webr</code> extension since it lacks an <code>OffScreenCanvas</code>. Please upgrade your web browser to one that supports <code>OffScreenCanvas</code>.';

  // Append the paragraph element to the body container
  bodyContainer.appendChild(paragraphElement);

  // Append the header div and body container to the main container div
  calloutContainer.appendChild(headerDiv);
  calloutContainer.appendChild(bodyContainer);

  // Append the main container div to the document depending on format
  qwebrPlaceMessageContents(calloutContainer, "title-block-header"); 

}


// Function that attaches the document status message and diagnostics
function displayStartupMessage(showStartupMessage, showHeaderMessage) {
  if (!showStartupMessage) {
    return;
  }

  // Create the outermost div element for metadata
  const quartoTitleMeta = document.createElement("div");
  quartoTitleMeta.classList.add("quarto-title-meta");

  // Create the first inner div element
  const firstInnerDiv = document.createElement("div");
  firstInnerDiv.setAttribute("id", "qwebr-status-message-area");

  // Create the second inner div element for "WebR Status" heading and contents
  const secondInnerDiv = document.createElement("div");
  secondInnerDiv.setAttribute("id", "qwebr-status-message-title");
  secondInnerDiv.classList.add("quarto-title-meta-heading");
  secondInnerDiv.innerText = "WebR Status";

  // Create another inner div for contents
  const secondInnerDivContents = document.createElement("div");
  secondInnerDivContents.setAttribute("id", "qwebr-status-message-body");
  secondInnerDivContents.classList.add("quarto-title-meta-contents");

  // Describe the WebR state
  qwebrStartupMessage.innerText = "🟡 Loading...";
  qwebrStartupMessage.setAttribute("id", "qwebr-status-message-text");
  // Add `aria-live` to auto-announce the startup status to screen readers
  qwebrStartupMessage.setAttribute("aria-live", "assertive");

  // Append the startup message to the contents
  secondInnerDivContents.appendChild(qwebrStartupMessage);

  // Add a status indicator for COOP and COEP Headers if needed
  if (showHeaderMessage) {
    const crossOriginMessage = document.createElement("p");
    crossOriginMessage.innerText = `${crossOriginIsolated ? '🟢' : '🟡'} COOP & COEP Headers`;
    crossOriginMessage.setAttribute("id", "qwebr-coop-coep-header");
    secondInnerDivContents.appendChild(crossOriginMessage);
  }

  // Combine the inner divs and contents
  firstInnerDiv.appendChild(secondInnerDiv);
  firstInnerDiv.appendChild(secondInnerDivContents);
  quartoTitleMeta.appendChild(firstInnerDiv);

  // Place message on webpage
  qwebrPlaceMessageContents(quartoTitleMeta); 
}

function qwebrAddCommandHistoryModal() {
  // Create the modal div
  var modalDiv = document.createElement('div');
  modalDiv.id = 'qwebr-history-modal';
  modalDiv.className = 'qwebr-modal';

  // Create the modal content div
  var modalContentDiv = document.createElement('div');
  modalContentDiv.className = 'qwebr-modal-content';

  // Create the span for closing the modal
  var closeSpan = document.createElement('span');
  closeSpan.id = 'qwebr-command-history-close-btn';
  closeSpan.className = 'qwebr-modal-close';
  closeSpan.innerHTML = '&times;';

  // Create the h1 element for the modal
  var modalH1 = document.createElement('h1');
  modalH1.textContent = 'R History Command Contents';

  // Create an anchor element for downloading the Rhistory file 
  var downloadLink = document.createElement('a');
  downloadLink.href = '#';
  downloadLink.id = 'qwebr-download-history-btn';
  downloadLink.className = 'qwebr-download-btn';

  // Create an 'i' element for the icon
  var icon = document.createElement('i');
  icon.className = 'bi bi-file-code';

  // Append the icon to the anchor element
  downloadLink.appendChild(icon);

  // Add the text 'Download R History' to the anchor element
  downloadLink.appendChild(document.createTextNode(' Download R History File'));

  // Create the pre for command history contents
  var commandContentsPre = document.createElement('pre');
  commandContentsPre.id = 'qwebr-command-history-contents';
  commandContentsPre.className = 'qwebr-modal-content-code';

  // Append the close span, h1, and history contents pre to the modal content div
  modalContentDiv.appendChild(closeSpan);
  modalContentDiv.appendChild(modalH1);
  modalContentDiv.appendChild(downloadLink);
  modalContentDiv.appendChild(commandContentsPre);

  // Append the modal content div to the modal div
  modalDiv.appendChild(modalContentDiv);

  // Append the modal div to the body
  document.body.appendChild(modalDiv);
}

function qwebrRegisterRevealJSCommandHistoryModal() {
  // Select the <ul> element inside the <div> with data-panel="Custom0"
  let ulElement = document.querySelector('div[data-panel="Custom0"] > ul.slide-menu-items');

  // Find the last <li> element with class slide-tool-item
  let lastItem = ulElement.querySelector('li.slide-tool-item:last-child');

  // Calculate the next data-item value
  let nextItemValue = 0;
  if (lastItem) {
      nextItemValue = parseInt(lastItem.dataset.item) + 1;
  }

  // Create a new <li> element
  let newListItem = document.createElement('li');
  newListItem.className = 'slide-tool-item';
  newListItem.dataset.item = nextItemValue.toString(); // Set the next available data-item value

  // Create the <a> element inside the <li>
  let newLink = document.createElement('a');
  newLink.href = '#';
  newLink.id = 'qwebrRHistoryButton'; // Set the ID for the new link
  
  // Create the <kbd> element inside the <a>
  let newKbd = document.createElement('kbd');
  newKbd.textContent = ' '; // Set to empty as we are not registering a keyboard shortcut

  // Create text node for the link text
  let newText = document.createTextNode(' View R History');

  // Append <kbd> and text node to <a>
  newLink.appendChild(newKbd);
  newLink.appendChild(newText);

  // Append <a> to <li>
  newListItem.appendChild(newLink);

  // Append <li> to <ul>
  ulElement.appendChild(newListItem);
}

// Handle setting up the R history modal
function qwebrCodeLinks() {

  if (qwebrIsRevealJS()) {
    qwebrRegisterRevealJSCommandHistoryModal();
    return;
  }

  // Create the container div
  var containerDiv = document.createElement('div');
  containerDiv.className = 'quarto-code-links';

  // Create the h2 element
  var h2 = document.createElement('h2');
  h2.textContent = 'webR Code Links';

  // Create the ul element
  var ul = document.createElement('ul');

  // Create the li element
  var li = document.createElement('li');

  // Create the a_history_btn element
  var a_history_btn = document.createElement('a');
  a_history_btn.href = 'javascript:void(0)';
  a_history_btn.setAttribute('id', 'qwebrRHistoryButton');

  // Create the i_history_btn element
  var i_history_btn = document.createElement('i');
  i_history_btn.className = 'bi bi-file-code';

  // Create the text node for the link text
  var text_history_btn = document.createTextNode('View R History');

  // Append the icon element and link text to the a element
  a_history_btn.appendChild(i_history_btn);
  a_history_btn.appendChild(text_history_btn);

  // Append the a element to the li element
  li.appendChild(a_history_btn);

  // Append the li element to the ul element
  ul.appendChild(li);

  // Append the h2 and ul elements to the container div
  containerDiv.appendChild(h2);
  containerDiv.appendChild(ul);

  // Append the container div to the element with the ID 'quarto-margin-sidebar'
  var sidebar = document.getElementById('quarto-margin-sidebar');
    
  // If the sidebar element is not found, create it
  if(!sidebar) {
    qwebrPlaceQuartoSidebar();
  }
  
  // Re-select the sidebar element (if it was just created)
  sidebar = document.getElementById('quarto-margin-sidebar');   


  // If the sidebar element exists, append the container div to it
  if(sidebar) {
    // Append the container div to the sidebar
    sidebar.appendChild(containerDiv);
    // Force the sidebar to be clickable by removing the 'zindex-bottom' class
    // added in pre-release: https://github.com/quarto-dev/quarto-cli/commit/f0c53a1ffcaa1de4eccbf07803b096898248adcc
    sidebar.className = 'sidebar margin-sidebar';
  } else {
    // Get a debugger ...
    console.warn('Element with ID "quarto-margin-sidebar" not found.');
  }
}

// Call the function to append the code links for qwebR into the right sidebar
qwebrCodeLinks();

// Add the command history modal
qwebrAddCommandHistoryModal();

displayStartupMessage(qwebrShowStartupMessage, qwebrShowHeaderMessage);
qwebrOffScreenCanvasSupportWarningMessage();
</script>
<script type="module">
// Define a global storage and retrieval solution ----

// Store commands executed in R
globalThis.qwebrRCommandHistory = [];

// Function to retrieve the command history
globalThis.qwebrFormatRHistory = function() {
   return qwebrRCommandHistory.join("\n\n");
}

// Retrieve HTML Elements ----

// Get the command modal
const command_history_modal = document.getElementById("qwebr-history-modal");

// Get the button that opens the command modal
const command_history_btn = document.getElementById("qwebrRHistoryButton");

// Get the <span> element that closes the command modal
const command_history_close_span = document.getElementById("qwebr-command-history-close-btn");

// Get the download button for r history information
const command_history_download_btn = document.getElementById("qwebr-download-history-btn");

// Plug in command history into modal/download button ----

// Function to populate the modal with command history
function populateCommandHistoryModal() {
    document.getElementById("qwebr-command-history-contents").innerHTML = qwebrFormatRHistory() || "No commands have been executed yet.";
}

// Function to format the current date and time to
// a string with the format YYYY-MM-DD-HH-MM-SS
function formatDateTime() {
    const now = new Date();

    const year = now.getFullYear();
    const day = String(now.getDate()).padStart(2, '0');
    const month = String(now.getMonth() + 1).padStart(2, '0'); // Months are zero-based
    const hours = String(now.getHours()).padStart(2, '0');
    const minutes = String(now.getMinutes()).padStart(2, '0');
    const seconds = String(now.getSeconds()).padStart(2, '0');

    return `${year}-${month}-${day}-${hours}-${minutes}-${seconds}`;
}


// Function to convert document title with datetime to a safe filename
function safeFileName() {
    // Get the current page title
    let pageTitle = document.title;

    // Combine the current page title with the current date and time
    let pageNameWithDateTime = `Rhistory-${pageTitle}-${formatDateTime()}`;

    // Replace unsafe characters with safe alternatives
    let safeFilename = pageNameWithDateTime.replace(/[\\/:\*\?! "<>\|]/g, '-');

    return safeFilename;
}


// Function to download list contents as text file
function downloadRHistory() {
    // Get the current page title + datetime and use it as the filename
    const filename = `${safeFileName()}.R`;

    // Get the text contents of the R History list
    const text = qwebrFormatRHistory();

    // Create a new Blob object with the text contents
    const blob = new Blob([text], { type: 'text/plain' });
  
    // Create a new anchor element for the download
    const a = document.createElement('a');
    a.style.display = 'none';
    a.href = URL.createObjectURL(blob);
    a.download = filename;

    // Append the anchor to the body, click it, and remove it
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}

// Register event handlers ----

// When the user clicks the View R History button, open the command modal
command_history_btn.onclick = function() {
    populateCommandHistoryModal();
    command_history_modal.style.display = "block";
}

// When the user clicks on <span> (x), close the command modal
command_history_close_span.onclick = function() {
    command_history_modal.style.display = "none";
}

// When the user clicks anywhere outside of the command modal, close it
window.onclick = function(event) {
    if (event.target == command_history_modal) {
        command_history_modal.style.display = "none";
    }
}

// Add an onclick event listener to the download button so that
// the user can download the R history as a text file
command_history_download_btn.onclick = function() {
    downloadRHistory();
};
</script>
<script type="module">
// Supported Evaluation Types for Context
globalThis.EvalTypes = Object.freeze({
  Interactive: 'interactive',
  Setup: 'setup',
  Output: 'output',
});

// Function that obtains the font size for a given element 
globalThis.qwebrCurrentFontSizeOnElement = function(element, cssProperty = 'font-size') {

  const currentFontSize = parseFloat(
    window
    .getComputedStyle(element)
    .getPropertyValue(cssProperty)
  );
  
  return currentFontSize;
}

// Function to determine font scaling
globalThis.qwebrScaledFontSize = function(div, qwebrOptions) {
  // Determine if we should compute font-size using RevealJS's `--r-main-font-size` 
  // or if we can directly use the document's `font-size`.
  const cssProperty = document.body.classList.contains('reveal') ? 
    "--r-main-font-size" : "font-size";
  
  // Get the current font size on the div element
  const elementFontSize = qwebrCurrentFontSizeOnElement(div, cssProperty);

  // Determine the scaled font size value
  const scaledFontSize = ((qwebrOptions['editor-font-scale'] ?? 1) * elementFontSize) ?? 17.5;

  return scaledFontSize;
}


// Function that dispatches the creation request
globalThis.qwebrCreateHTMLElement = function (
  cellData
) {

  // Extract key components
  const evalType = cellData.options.context;
  const qwebrCounter = cellData.id;

  // We make an assumption that insertion points are defined by the Lua filter as:
  // qwebr-insertion-location-{qwebrCounter} 
  const elementLocator = document.getElementById(`qwebr-insertion-location-${qwebrCounter}`);

  // Figure out the routine to use to insert the element.
  let qwebrElement;
  switch ( evalType ) {
    case EvalTypes.Interactive:
      qwebrElement = qwebrCreateInteractiveElement(qwebrCounter, cellData.options);
      break;
    case EvalTypes.Output: 
      qwebrElement = qwebrCreateNonInteractiveOutputElement(qwebrCounter, cellData.options);
      break;
    case EvalTypes.Setup: 
      qwebrElement = qwebrCreateNonInteractiveSetupElement(qwebrCounter, cellData.options);
      break;
    default: 
      qwebrElement = document.createElement('div');
      qwebrElement.textContent = 'Error creating `quarto-webr` element';
  }

  // Insert the dynamically generated object at the document location.
  elementLocator.appendChild(qwebrElement);
};

// Function that setups the interactive element creation
globalThis.qwebrCreateInteractiveElement = function (qwebrCounter, qwebrOptions) {

  // Create main div element
  var mainDiv = document.createElement('div');
  mainDiv.id = 'qwebr-interactive-area-' + qwebrCounter;
  mainDiv.className = `qwebr-interactive-area`;
  if (qwebrOptions.classes) {
    mainDiv.className += " " + qwebrOptions.classes
  }

  // Add a unique cell identifier that users can customize
  if (qwebrOptions.label) {
    mainDiv.setAttribute('data-id', qwebrOptions.label);
  }

  // Create toolbar div
  var toolbarDiv = document.createElement('div');
  toolbarDiv.className = 'qwebr-editor-toolbar';
  toolbarDiv.id = 'qwebr-editor-toolbar-' + qwebrCounter;

  // Create a div to hold the left buttons
  var leftButtonsDiv = document.createElement('div');
  leftButtonsDiv.className = 'qwebr-editor-toolbar-left-buttons';

  // Create a div to hold the right buttons
  var rightButtonsDiv = document.createElement('div');
  rightButtonsDiv.className = 'qwebr-editor-toolbar-right-buttons';

  // Create Run Code button
  var runCodeButton = document.createElement('button');
  runCodeButton.className = 'btn btn-default qwebr-button qwebr-button-run';
  runCodeButton.disabled = true;
  runCodeButton.type = 'button';
  runCodeButton.id = 'qwebr-button-run-' + qwebrCounter;
  runCodeButton.textContent = '🟡 Loading webR...';
  runCodeButton.title = `Run code (Shift + Enter)`;

  // Append buttons to the leftButtonsDiv
  leftButtonsDiv.appendChild(runCodeButton);

  // Create Reset button
  var resetButton = document.createElement('button');
  resetButton.className = 'btn btn-light btn-xs qwebr-button qwebr-button-reset';
  resetButton.type = 'button';
  resetButton.id = 'qwebr-button-reset-' + qwebrCounter;
  resetButton.title = 'Start over';
  resetButton.innerHTML = '<i class="fa-solid fa-arrows-rotate"></i>';

  // Create Copy button
  var copyButton = document.createElement('button');
  copyButton.className = 'btn btn-light btn-xs qwebr-button qwebr-button-copy';
  copyButton.type = 'button';
  copyButton.id = 'qwebr-button-copy-' + qwebrCounter;
  copyButton.title = 'Copy code';
  copyButton.innerHTML = '<i class="fa-regular fa-copy"></i>';

  // Append buttons to the rightButtonsDiv
  rightButtonsDiv.appendChild(resetButton);
  rightButtonsDiv.appendChild(copyButton);

  // Create console area div
  var consoleAreaDiv = document.createElement('div');
  consoleAreaDiv.id = 'qwebr-console-area-' + qwebrCounter;
  consoleAreaDiv.className = 'qwebr-console-area';

  // Create editor div
  var editorDiv = document.createElement('div');
  editorDiv.id = 'qwebr-editor-' + qwebrCounter;
  editorDiv.className = 'qwebr-editor';

  // Create output code area div
  var outputCodeAreaDiv = document.createElement('div');
  outputCodeAreaDiv.id = 'qwebr-output-code-area-' + qwebrCounter;
  outputCodeAreaDiv.className = 'qwebr-output-code-area';
  outputCodeAreaDiv.setAttribute('aria-live', 'assertive');

  // Create pre element inside output code area
  var preElement = document.createElement('pre');
  preElement.style.visibility = 'hidden';
  outputCodeAreaDiv.appendChild(preElement);

  // Create output graph area div
  var outputGraphAreaDiv = document.createElement('div');
  outputGraphAreaDiv.id = 'qwebr-output-graph-area-' + qwebrCounter;
  outputGraphAreaDiv.className = 'qwebr-output-graph-area';

  // Append buttons to the toolbar
  toolbarDiv.appendChild(leftButtonsDiv);
  toolbarDiv.appendChild(rightButtonsDiv);

  // Append all elements to the main div
  mainDiv.appendChild(toolbarDiv);
  consoleAreaDiv.appendChild(editorDiv);
  consoleAreaDiv.appendChild(outputCodeAreaDiv);
  mainDiv.appendChild(consoleAreaDiv);
  mainDiv.appendChild(outputGraphAreaDiv);

  return mainDiv;
}

// Function that adds output structure for non-interactive output
globalThis.qwebrCreateNonInteractiveOutputElement = function(qwebrCounter, qwebrOptions) {
  // Create main div element
  var mainDiv = document.createElement('div');
  mainDiv.id = 'qwebr-noninteractive-area-' + qwebrCounter;
  mainDiv.className = `qwebr-noninteractive-area`;
  if (qwebrOptions.classes) {
    mainDiv.className += " " + qwebrOptions.classes
  }
  
  // Add a unique cell identifier that users can customize
  if (qwebrOptions.label) {
    mainDiv.setAttribute('data-id', qwebrOptions.label);
  }
  
  // Create a status container div
  var statusContainer = createLoadingContainer(qwebrCounter);

  // Create output code area div
  var outputCodeAreaDiv = document.createElement('div');
  outputCodeAreaDiv.id = 'qwebr-output-code-area-' + qwebrCounter;
  outputCodeAreaDiv.className = 'qwebr-output-code-area';
  outputCodeAreaDiv.setAttribute('aria-live', 'assertive');

  // Create pre element inside output code area
  var preElement = document.createElement('pre');
  preElement.style.visibility = 'hidden';
  outputCodeAreaDiv.appendChild(preElement);

  // Create output graph area div
  var outputGraphAreaDiv = document.createElement('div');
  outputGraphAreaDiv.id = 'qwebr-output-graph-area-' + qwebrCounter;
  outputGraphAreaDiv.className = 'qwebr-output-graph-area';

  // Append all elements to the main div
  mainDiv.appendChild(statusContainer);
  mainDiv.appendChild(outputCodeAreaDiv);
  mainDiv.appendChild(outputGraphAreaDiv);

  return mainDiv;
};

// Function that adds a stub in the page to indicate a setup cell was used.
globalThis.qwebrCreateNonInteractiveSetupElement = function(qwebrCounter, qwebrOptions) {
  // Create main div element
  var mainDiv = document.createElement('div');
  mainDiv.id = `qwebr-noninteractive-setup-area-${qwebrCounter}`;
  mainDiv.className = `qwebr-noninteractive-setup-area`;
  if (qwebrOptions.classes) {
    mainDiv.className += " " + qwebrOptions.classes
  }


  // Add a unique cell identifier that users can customize
  if (qwebrOptions.label) {
    mainDiv.setAttribute('data-id', qwebrOptions.label);
  }

  // Create a status container div
  var statusContainer = createLoadingContainer(qwebrCounter);

  // Append status onto the main div
  mainDiv.appendChild(statusContainer);

  return mainDiv;
}


// Function to create loading container with specified ID
globalThis.createLoadingContainer = function(qwebrCounter) {

  // Create a status container
  const container = document.createElement('div');
  container.id = `qwebr-non-interactive-loading-container-${qwebrCounter}`;
  container.className = 'qwebr-non-interactive-loading-container qwebr-cell-needs-evaluation';

  // Create an R project logo to indicate its a code space
  const rProjectIcon = document.createElement('i');
  rProjectIcon.className = 'fa-brands fa-r-project fa-3x qwebr-r-project-logo';

  // Setup a loading icon from font awesome
  const spinnerIcon = document.createElement('i');
  spinnerIcon.className = 'fa-solid fa-spinner fa-spin fa-1x qwebr-icon-status-spinner';

  // Add a section for status text
  const statusText = document.createElement('p');
  statusText.id = `qwebr-status-text-${qwebrCounter}`;
  statusText.className = `qwebr-status-text qwebr-cell-needs-evaluation`;
  statusText.innerText = 'Loading webR...';

  // Incorporate an inner container
  const innerContainer = document.createElement('div');

  // Append elements to the inner container
  innerContainer.appendChild(spinnerIcon);
  innerContainer.appendChild(statusText);

  // Append elements to the main container
  container.appendChild(rProjectIcon);
  container.appendChild(innerContainer);

  return container;
}
</script>
<script type="module">
// Function to install a single package
async function qwebrInstallRPackage(packageName) {
  await mainWebR.evalRVoid(`webr::install('${packageName}');`);
}

// Function to load a single package
async function qwebrLoadRPackage(packageName) {
  await mainWebR.evalRVoid(`require('${packageName}', quietly = TRUE)`);
}

// Generic function to process R packages
async function qwebrProcessRPackagesWithStatus(packages, processType, displayStatusMessageUpdate = true) {
  // Switch between contexts
  const messagePrefix = processType === 'install' ? 'Installing' : 'Loading';

  // Modify button state
  qwebrSetInteractiveButtonState(`🟡 ${messagePrefix} package ...`, false);

  // Iterate over packages
  for (let i = 0; i < packages.length; i++) {
    const activePackage = packages[i];
    const formattedMessage = `${messagePrefix} package ${i + 1} out of ${packages.length}: ${activePackage}`;

    // Display the update in header
    if (displayStatusMessageUpdate) {
      qwebrUpdateStatusHeader(formattedMessage);
    }

    // Display the update in non-active areas
    qwebrUpdateStatusMessage(formattedMessage);

    // Run package installation
    if (processType === 'install') {
      await qwebrInstallRPackage(activePackage);
    } else {
      await qwebrLoadRPackage(activePackage);
    }
  }

  // Clean slate
  if (processType === 'load') {
    await mainWebR.flush();
  }
}

// Start a timer
const initializeWebRTimerStart = performance.now();

// Encase with a dynamic import statement
globalThis.qwebrInstance = import(qwebrCustomizedWebROptions.baseURL + "webr.mjs").then(
  async ({ WebR, ChannelType }) => {
    // Populate WebR options with defaults or new values based on `webr` meta
    globalThis.mainWebR = new WebR(qwebrCustomizedWebROptions);

    // Initialization WebR
    await mainWebR.init();

    // Setup a shelter
    globalThis.mainWebRCodeShelter = await new mainWebR.Shelter();

    // Setup a pager to allow processing help documentation 
    await mainWebR.evalRVoid('webr::pager_install()'); 

    // Override the existing install.packages() to use webr::install()
    await mainWebR.evalRVoid('webr::shim_install()'); 

    // Specify the repositories to pull from
    // Note: webR does not use the `repos` option, but instead uses `webr_pkg_repos`
    // inside of `install()`. However, other R functions still pull from `repos`.
    await mainWebR.evalRVoid(`
      options(
        webr_pkg_repos = c(${qwebrPackageRepoURLS.map(repoURL => `'${repoURL}'`).join(',')}),
        repos = c(${qwebrPackageRepoURLS.map(repoURL => `'${repoURL}'`).join(',')})
      )
    `);

    // Check to see if any packages need to be installed
    if (qwebrSetupRPackages) {
      // Obtain only a unique list of packages
      const uniqueRPackageList = Array.from(new Set(qwebrInstallRPackagesList));

      // Install R packages one at a time (either silently or with a status update)
      await qwebrProcessRPackagesWithStatus(uniqueRPackageList, 'install', qwebrShowStartupMessage);

      if (qwebrAutoloadRPackages) {
        // Load R packages one at a time (either silently or with a status update)
        await qwebrProcessRPackagesWithStatus(uniqueRPackageList, 'load', qwebrShowStartupMessage);
      }
    }
  }
);

// Stop timer
const initializeWebRTimerEnd = performance.now();

</script>
<script type="module">
// Function to verify a given JavaScript Object is empty
globalThis.qwebrIsObjectEmpty = function (arr) {
    return Object.keys(arr).length === 0;
}

// Global version of the Escape HTML function that converts HTML 
// characters to their HTML entities.
globalThis.qwebrEscapeHTMLCharacters = function(unsafe) {
    return unsafe
      .replace(/&/g, "&amp;")
      .replace(/</g, "&lt;")
      .replace(/>/g, "&gt;")
      .replace(/"/g, "&quot;")
      .replace(/'/g, "&#039;");
  };

// Passthrough results
globalThis.qwebrIdentity = function(x) {
    return x;
};

// Append a comment
globalThis.qwebrPrefixComment = function(x, comment) {
    return `${comment}${x}`;
};

// Function to store the code in the history
globalThis.qwebrLogCodeToHistory = function(codeToRun, options) {
    qwebrRCommandHistory.push(
        `# Ran code in ${options.label} at ${new Date().toLocaleString()} ----\n${codeToRun}`
    );
}

// Function to attach a download button onto the canvas
// allowing the user to download the image.
function qwebrImageCanvasDownloadButton(canvas, canvasContainer) {

    // Create the download button
    const downloadButton = document.createElement('button');
    downloadButton.className = 'qwebr-canvas-image-download-btn';
    downloadButton.textContent = 'Download Image';
    canvasContainer.appendChild(downloadButton);

    // Trigger a download of the image when the button is clicked
    downloadButton.addEventListener('click', function() {
        const image = canvas.toDataURL('image/png');
        const link = document.createElement('a');
        link.href = image;
        link.download = 'qwebr-canvas-image.png';
        link.click();
    });
  }
  

// Function to parse the pager results
globalThis.qwebrParseTypePager = async function (msg) { 

    // Split out the event data
    const { path, title, deleteFile } = msg.data; 

    // Process the pager data by reading the information from disk
    const paged_data = await mainWebR.FS.readFile(path).then((data) => {
        // Obtain the file content
        let content = new TextDecoder().decode(data);

        // Remove excessive backspace characters until none remain
        while(content.match(/.[\b]/)){
        content = content.replace(/.[\b]/g, '');
        }

        // Returned cleaned data
        return content;
    });

    // Unlink file if needed
    if (deleteFile) { 
        await mainWebR.FS.unlink(path); 
    } 

    // Return extracted data with spaces
    return paged_data;
} 

// Function to run the code using webR and parse the output
globalThis.qwebrComputeEngine = async function(
    codeToRun, 
    elements, 
    options) {

    // Call into the R compute engine that persists within the document scope.
    // To be prepared for all scenarios, the following happens: 
    // 1. We setup a canvas device to write to by making a namespace call into the {webr} package
    // 2. We use values inside of the options array to set the figure size.
    // 3. We capture the output stream information (STDOUT and STERR)
    // 4. We disable the current device's image creation.
    // 5. Piece-wise parse the results into the different output areas

    // Create a pager variable for help/file contents
    let pager = [];

    // Handle how output is processed
    let showMarkup = options.results === "markup" && options.output !== "asis";
    let processOutput;

    if (showMarkup) {
        processOutput = qwebrEscapeHTMLCharacters;
    } else {
        processOutput = qwebrIdentity;
    }

    // ---- 
    // Convert from Inches to Pixels by using DPI (dots per inch)
    // for bitmap devices (dpi * inches = pixels)
    let fig_width = options["fig-width"] * options["dpi"]
    let fig_height = options["fig-height"] * options["dpi"]

    // Initialize webR
    await mainWebR.init();

    // Configure capture output
    let captureOutputOptions = {
        withAutoprint: true,
        captureStreams: true,
        captureConditions: false,
        // env: webR.objs.emptyEnv, // maintain a global environment for webR v0.2.0
    };
    
    // Determine if the browser supports OffScreen
    if (qwebrOffScreenCanvasSupport()) {
        // Mirror default options of webr::canvas()
        // with changes to figure height and width.
        captureOutputOptions.captureGraphics = {
            width: fig_width,
            height: fig_height,
            bg: "white", // default: transparent
            pointsize: 12,
            capture: true
        };
    }  else {
        // Disable generating graphics
        captureOutputOptions.captureGraphics = false;
    }

    // Store the code to run in history
    qwebrLogCodeToHistory(codeToRun, options);

    // Setup a webR canvas by making a namespace call into the {webr} package
    // Evaluate the R code
    // Remove the active canvas silently
    const result = await mainWebRCodeShelter.captureR(
        `${codeToRun}`,
        captureOutputOptions
    );

    // -----

    // Start attempting to parse the result data
    processResultOutput:try {
        
        // Avoid running through output processing
        if (options.results === "hide" || options.output === "false") { 
            break processResultOutput; 
        }

        // Merge output streams of STDOUT and STDErr (messages and errors are combined.)
        // Require both `warning` and `message` to be true to display `STDErr`. 
        const out = result.output
        .filter(
            evt => evt.type === "stdout" || 
            ( evt.type === "stderr" && (options.warning === "true" && options.message === "true")) 
        )
        .map((evt, index) => {
            const className = `qwebr-output-code-${evt.type}`;
            const outputResult = qwebrPrefixComment(processOutput(evt.data), options.comment);
            return `<code id="${className}-editor-${elements.id}-result-${index + 1}" class="${className}">${outputResult}</code>`;
        })
        .join("\n");


        // Clean the state
        // We're now able to process pager events.
        // As a result, we cannot maintain a true 1-to-1 output order 
        // without individually feeding each line
        const msgs = await mainWebR.flush();

        // Use `map` to process the filtered "pager" events asynchronously
        const pager = await Promise.all(
            msgs.filter(msg => msg.type === 'pager').map(
                async (msg) => {
                    return await qwebrParseTypePager(msg);
                }
            )
        );

        // Nullify the output area of content
        elements.outputCodeDiv.innerHTML = "";
        elements.outputGraphDiv.innerHTML = "";

        // Design an output object for messages
        const pre = document.createElement("pre");
        if (/\S/.test(out)) {
            // Display results as HTML elements to retain output styling
            const div = document.createElement("div");
            div.innerHTML = out;

            // Calculate a scaled font-size value
            const scaledFontSize = qwebrScaledFontSize(
                elements.outputCodeDiv, options);

            // Override output code cell size
            pre.style.fontSize = `${scaledFontSize}px`;
            pre.appendChild(div);
        } else {
            // If nothing is present, hide the element.
            pre.style.visibility = "hidden";
        }

        elements.outputCodeDiv.appendChild(pre);

        // Determine if we have graphs to display
        if (result.images.length > 0) {

            // Create figure element
            const figureElement = document.createElement("figure");
            figureElement.className = "qwebr-canvas-image";

            // Place each rendered graphic onto a canvas element
            result.images.forEach((img) => {

                // Construct canvas for object
                const canvas = document.createElement("canvas");

                // Add an image download button
                qwebrImageCanvasDownloadButton(canvas, figureElement);

                // Set canvas size to image
                canvas.width = img.width;
                canvas.height = img.height;

                // Apply output truncations
                canvas.style.width = options["out-width"] ? options["out-width"] : `${fig_width}px`;
                if (options["out-height"]) {
                    canvas.style.height = options["out-height"];
                }

                // Apply styling
                canvas.style.display = "block";
                canvas.style.margin = "auto";

                // Draw image onto Canvas
                const ctx = canvas.getContext("2d");
                ctx.drawImage(img, 0, 0, img.width, img.height);
          
                // Append canvas to figure output area
                figureElement.appendChild(canvas);

            });
            
            if (options['fig-cap']) {
                // Create figcaption element
                const figcaptionElement = document.createElement('figcaption');
                figcaptionElement.innerText = options['fig-cap'];
                // Append figcaption to figure
                figureElement.appendChild(figcaptionElement);    
            }
        
            elements.outputGraphDiv.appendChild(figureElement);

        }

        // Display the pager data
        if (pager) {
        // Use the `pre` element to preserve whitespace.
        pager.forEach((paged_data, index) => {
            let pre_pager = document.createElement("pre");
            pre_pager.innerText = paged_data;
            pre_pager.classList.add("qwebr-output-code-pager");
            pre_pager.setAttribute("id", `qwebr-output-code-pager-editor-${elements.id}-result-${index + 1}`);
            elements.outputCodeDiv.appendChild(pre_pager);
        });
        }
    } finally {
        // Clean up the remaining code
        mainWebRCodeShelter.purge();
    }
}

// Function to execute the code (accepts code as an argument)
globalThis.qwebrExecuteCode = async function (
    codeToRun,
    id,
    options = {}) {

    // If options are not passed, we fall back on the bare minimum to handle the computation
    if (qwebrIsObjectEmpty(options)) {
        options = { 
            "context": "interactive", 
            "fig-width": 7, "fig-height": 5, 
            "out-width": "700px", "out-height": "", 
            "dpi": 72,
            "results": "markup", 
            "warning": "true", "message": "true",
        };
    }

    // Next, we access the compute areas values
    const elements = {
        runButton: document.getElementById(`qwebr-button-run-${id}`),
        outputCodeDiv: document.getElementById(`qwebr-output-code-area-${id}`),
        outputGraphDiv: document.getElementById(`qwebr-output-graph-area-${id}`),
        id: id,
    }

    // Disallowing execution of other code cells
    document.querySelectorAll(".qwebr-button-run").forEach((btn) => {
        btn.disabled = true;
    });

    if (options.context == EvalTypes.Interactive) {
        // Emphasize the active code cell
        elements.runButton.innerHTML = '<i class="fa-solid fa-spinner fa-spin qwebr-icon-status-spinner"></i> <span>Run Code</span>';
    }

    // Evaluate the code and parse the output into the document
    await qwebrComputeEngine(codeToRun, elements, options);

    // Switch to allowing execution of code
    document.querySelectorAll(".qwebr-button-run").forEach((btn) => {
        btn.disabled = false;
    });

    if (options.context == EvalTypes.Interactive) {
        // Revert to the initial code cell state
        elements.runButton.innerHTML = '<i class="fa-solid fa-play qwebr-icon-run-code"></i> <span>Run Code</span>';
    }
}

</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../include/webex.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../weeklisting.html">Weeks</a></li><li class="breadcrumb-item"><a href="../week31/chapter.html">Week31</a></li><li class="breadcrumb-item"><a href="../week31/chapter.html">T-Tests</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../weeklisting.html">Weeks</a></li><li class="breadcrumb-item"><a href="../week31/chapter.html">Week31</a></li><li class="breadcrumb-item"><a href="../week31/chapter.html">T-Tests</a></li></ol></nav>
      <div class="quarto-title-block"><div><h1 class="title">T-Tests</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
            <p class="subtitle lead">A Year 1 Textbook Chapter</p>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Navigation</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../demos.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Demos</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../webr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">webR in Quarto HTML Documents</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../webexercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Webexercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../downloadthis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DownloadThis Demo</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../iframeslides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IframeSLides on Page</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="px-0"><hr class="sidebar-divider hi "></li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../weeklisting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Weeks</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Week01</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/chapter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Measuring Wellbeing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/dataskills.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The Great Wellbeing Challenge</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/lab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RM Lab Narrative Wellbeing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/lab-slides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RMLab Slides Week 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/lecture.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RM Lecture Narrative Wellbeing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week01/lecture-slides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">RMLecture Slides Week 01</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Week31</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week31/chapter.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">T-Tests</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week31/dataskills.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Expectations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week31/lab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Looking at Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week31/lab-slides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week31/lecture-slides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 01</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Week32</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week32/chapter.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Measuring Wellbeing</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week32/dataskills.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">DataSkills 02</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week32/lab.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Now it’s your turn</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week32/lab-slides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab 02 - Overview</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../week32/lecture-slides.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lecture 01</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item">
 <span class="menu-text">*-slides.qmd</span>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#chapter-t-tests-in-r" id="toc-chapter-t-tests-in-r" class="nav-link active" data-scroll-target="#chapter-t-tests-in-r">Chapter: T-Tests in R</a>
  <ul class="collapse">
  <li><a href="#check-your-confidence-in-your-mean" id="toc-check-your-confidence-in-your-mean" class="nav-link" data-scroll-target="#check-your-confidence-in-your-mean">Check your confidence in your mean</a></li>
  <li><a href="#one-sample-t-test-a-new-t-test" id="toc-one-sample-t-test-a-new-t-test" class="nav-link" data-scroll-target="#one-sample-t-test-a-new-t-test">One-sample t-test: A new t-test</a>
  <ul class="collapse">
  <li><a href="#formulas-for-one-sample-t-test" id="toc-formulas-for-one-sample-t-test" class="nav-link" data-scroll-target="#formulas-for-one-sample-t-test">Formulas for one-sample t-test</a></li>
  <li><a href="#what-does-t-represent" id="toc-what-does-t-represent" class="nav-link" data-scroll-target="#what-does-t-represent">What does t represent?</a></li>
  <li><a href="#calculating-t-from-data" id="toc-calculating-t-from-data" class="nav-link" data-scroll-target="#calculating-t-from-data">Calculating t from data</a></li>
  <li><a href="#how-does-t-behave" id="toc-how-does-t-behave" class="nav-link" data-scroll-target="#how-does-t-behave">How does t behave?</a></li>
  <li><a href="#making-a-decision" id="toc-making-a-decision" class="nav-link" data-scroll-target="#making-a-decision">Making a decision</a></li>
  </ul></li>
  <li><a href="#paired-samples-t-test" id="toc-paired-samples-t-test" class="nav-link" data-scroll-target="#paired-samples-t-test">Paired-samples t-test</a>
  <ul class="collapse">
  <li><a href="#mehr-song-and-spelke-2016" id="toc-mehr-song-and-spelke-2016" class="nav-link" data-scroll-target="#mehr-song-and-spelke-2016">Mehr, Song, and Spelke (2016)</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">The data</a></li>
  <li><a href="#the-difference-scores" id="toc-the-difference-scores" class="nav-link" data-scroll-target="#the-difference-scores">The difference scores</a></li>
  <li><a href="#the-mean-difference" id="toc-the-mean-difference" class="nav-link" data-scroll-target="#the-mean-difference">The mean difference</a></li>
  <li><a href="#calculate-t" id="toc-calculate-t" class="nav-link" data-scroll-target="#calculate-t">Calculate t</a></li>
  <li><a href="#interpreting-ts" id="toc-interpreting-ts" class="nav-link" data-scroll-target="#interpreting-ts">Interpreting <span class="math inline">\(t\)</span>s</a></li>
  <li><a href="#getting-the-p-values-for-t-values" id="toc-getting-the-p-values-for-t-values" class="nav-link" data-scroll-target="#getting-the-p-values-for-t-values">Getting the p-values for <span class="math inline">\(t\)</span>-values</a></li>
  <li><a href="#one-tailed-tests" id="toc-one-tailed-tests" class="nav-link" data-scroll-target="#one-tailed-tests">One-tailed tests</a></li>
  <li><a href="#two-tailed-tests" id="toc-two-tailed-tests" class="nav-link" data-scroll-target="#two-tailed-tests">Two-tailed tests</a></li>
  <li><a href="#one-or-two-tailed-which-one" id="toc-one-or-two-tailed-which-one" class="nav-link" data-scroll-target="#one-or-two-tailed-which-one">One or two tailed, which one?</a></li>
  <li><a href="#degrees-of-freedom" id="toc-degrees-of-freedom" class="nav-link" data-scroll-target="#degrees-of-freedom">Degrees of freedom</a></li>
  </ul></li>
  <li><a href="#the-paired-samples-t-test-strikes-back" id="toc-the-paired-samples-t-test-strikes-back" class="nav-link" data-scroll-target="#the-paired-samples-t-test-strikes-back">The paired samples t-test strikes back</a></li>
  <li><a href="#independent-samples-t-test-the-return-of-the-t-test" id="toc-independent-samples-t-test-the-return-of-the-t-test" class="nav-link" data-scroll-target="#independent-samples-t-test-the-return-of-the-t-test">Independent samples t-test: The return of the t-test?</a></li>
  <li><a href="#simulating-data-for-t-tests" id="toc-simulating-data-for-t-tests" class="nav-link" data-scroll-target="#simulating-data-for-t-tests">Simulating data for t-tests</a>
  <ul class="collapse">
  <li><a href="#simulating-a-one-sample-t-test" id="toc-simulating-a-one-sample-t-test" class="nav-link" data-scroll-target="#simulating-a-one-sample-t-test">Simulating a one-sample t-test</a></li>
  <li><a href="#simulating-a-paired-samples-t-test" id="toc-simulating-a-paired-samples-t-test" class="nav-link" data-scroll-target="#simulating-a-paired-samples-t-test">Simulating a paired samples t-test</a></li>
  <li><a href="#simulating-an-independent-samples-t.test" id="toc-simulating-an-independent-samples-t.test" class="nav-link" data-scroll-target="#simulating-an-independent-samples-t.test">Simulating an independent samples t.test</a></li>
  </ul></li>
  <li><a href="#videos" id="toc-videos" class="nav-link" data-scroll-target="#videos">Videos</a>
  <ul class="collapse">
  <li><a href="#one-or-two-tailed-tests" id="toc-one-or-two-tailed-tests" class="nav-link" data-scroll-target="#one-or-two-tailed-tests">One or Two tailed tests</a></li>
  </ul></li>
  <li><a href="#main-content" id="toc-main-content" class="nav-link" data-scroll-target="#main-content">2. Main Content</a>
  <ul class="collapse">
  <li><a href="#theory-of-t-tests" id="toc-theory-of-t-tests" class="nav-link" data-scroll-target="#theory-of-t-tests">2.1 Theory of T-Tests</a></li>
  <li><a href="#assumptions-of-t-tests" id="toc-assumptions-of-t-tests" class="nav-link" data-scroll-target="#assumptions-of-t-tests">2.2 Assumptions of T-Tests</a></li>
  </ul></li>
  <li><a href="#methods-and-measures" id="toc-methods-and-measures" class="nav-link" data-scroll-target="#methods-and-measures">3. Methods and Measures</a>
  <ul class="collapse">
  <li><a href="#example-study" id="toc-example-study" class="nav-link" data-scroll-target="#example-study">Example Study</a></li>
  </ul></li>
  <li><a href="#analysis-with-r-code" id="toc-analysis-with-r-code" class="nav-link" data-scroll-target="#analysis-with-r-code">4. Analysis with R Code</a>
  <ul class="collapse">
  <li><a href="#data-setup" id="toc-data-setup" class="nav-link" data-scroll-target="#data-setup">Data Setup</a></li>
  <li><a href="#conducting-the-t-test" id="toc-conducting-the-t-test" class="nav-link" data-scroll-target="#conducting-the-t-test">Conducting the T-Test</a></li>
  <li><a href="#r-output-interpretation" id="toc-r-output-interpretation" class="nav-link" data-scroll-target="#r-output-interpretation">R Output Interpretation</a></li>
  </ul></li>
  <li><a href="#debates-and-controversies" id="toc-debates-and-controversies" class="nav-link" data-scroll-target="#debates-and-controversies">5. Debates and Controversies</a>
  <ul class="collapse">
  <li><a href="#assumption-violations" id="toc-assumption-violations" class="nav-link" data-scroll-target="#assumption-violations">5.1 Assumption Violations</a></li>
  <li><a href="#p-value-misinterpretation" id="toc-p-value-misinterpretation" class="nav-link" data-scroll-target="#p-value-misinterpretation">5.2 P-Value Misinterpretation</a></li>
  <li><a href="#multiple-comparisons" id="toc-multiple-comparisons" class="nav-link" data-scroll-target="#multiple-comparisons">5.3 Multiple Comparisons</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">6. Conclusion</a>
  <ul class="collapse">
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#glossary" id="toc-glossary" class="nav-link" data-scroll-target="#glossary">Glossary</a></li>
  <li><a href="#self-assessment-quiz" id="toc-self-assessment-quiz" class="nav-link" data-scroll-target="#self-assessment-quiz">Self-Assessment Quiz</a>
  <ul class="collapse">
  <li><a href="#self-assessment-quiz-t-tests-in-r-with-theory-practicals-and-write-up-in-psychology-apa-style" id="toc-self-assessment-quiz-t-tests-in-r-with-theory-practicals-and-write-up-in-psychology-apa-style" class="nav-link" data-scroll-target="#self-assessment-quiz-t-tests-in-r-with-theory-practicals-and-write-up-in-psychology-apa-style">Self-Assessment Quiz: T-Tests in R with Theory, Practicals, and Write-up in Psychology APA-style</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/LittleMonkeyLab/introrm/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">
<script src="https://cdn.jsdelivr.net/npm/monaco-editor@0.47.0/min/vs/loader.js"></script>
<script type="module" id="qwebr-monaco-editor-init">

  // Configure the Monaco Editor's loader
  require.config({
    paths: {
      'vs': 'https://cdn.jsdelivr.net/npm/monaco-editor@0.47.0/min/vs'
    }
  });
</script>
<script type="module">
// Function to update Monaco Editors when body class changes
function updateMonacoEditorsOnBodyClassChange() {
    // Select the body element
    const body = document.querySelector('body');

    // Options for the observer (which mutations to observe)
    const observerOptions = {
        attributes: true,  // Observe changes to attributes
        attributeFilter: ['class'] // Only observe changes to the 'class' attribute
    };

    // Callback function to execute when mutations are observed
    const bodyClassChangeCallback = function(mutationsList, observer) {
        for(let mutation of mutationsList) {
            if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                // Class attribute has changed
                // Update all Monaco Editors on the page
                updateMonacoEditorTheme();
            }
        }
    };

    // Create an observer instance linked to the callback function
    const observer = new MutationObserver(bodyClassChangeCallback);

    // Start observing the target node for configured mutations
    observer.observe(body, observerOptions);
}

// Function to update all instances of Monaco Editors on the page
function updateMonacoEditorTheme() {
    // Determine what VS Theme to use
    const vsThemeToUse = document.body.classList.contains("quarto-dark") ? 'vs-dark' : 'vs' ;

    // Iterate through all initialized Monaco Editors
    qwebrEditorInstances.forEach( function(editorInstance) { 
        editorInstance.updateOptions({ theme: vsThemeToUse }); 
    });
}

// Call the function to start observing changes to body class
updateMonacoEditorsOnBodyClassChange();
</script>
<script type="module">
// Global array to store Monaco Editor instances
globalThis.qwebrEditorInstances = [];

function isValidCodeLineNumbers(stringCodeLineNumbers) {
  // Regular expression to match valid input strings
  const regex = /^(\d+(-\d+)?)(,\d+(-\d+)?)*$/;
  return regex.test(stringCodeLineNumbers);
}

// Function that builds and registers a Monaco Editor instance    
globalThis.qwebrCreateMonacoEditorInstance = function (cellData) {

  const initialCode = cellData.code;
  const qwebrCounter = cellData.id;
  const qwebrOptions = cellData.options;

  // Retrieve the previously created document elements
  let runButton = document.getElementById(`qwebr-button-run-${qwebrCounter}`);
  let resetButton = document.getElementById(`qwebr-button-reset-${qwebrCounter}`);
  let copyButton = document.getElementById(`qwebr-button-copy-${qwebrCounter}`);
  let editorDiv = document.getElementById(`qwebr-editor-${qwebrCounter}`);

  // Load the Monaco Editor and create an instance
  let editor;
  require(['vs/editor/editor.main'], function () {
    editor = monaco.editor.create(editorDiv, {
      value: initialCode,
      language: 'r',
      theme: 'vs-light',
      automaticLayout: true,           // Works wonderfully with RevealJS
      scrollBeyondLastLine: false,
      minimap: {
        enabled: false
      },
      fontSize: qwebrScaledFontSize(editorDiv, qwebrOptions),         
      renderLineHighlight: "none",      // Disable current line highlighting
      hideCursorInOverviewRuler: true,  // Remove cursor indictor in right hand side scroll bar
      readOnly: qwebrOptions['read-only'] ?? false,
      quickSuggestions: qwebrOptions['editor-quick-suggestions'] ?? false,
      wordWrap: (qwebrOptions['editor-word-wrap'] == 'true' ? "on" : "off")
    });

    // Store the official counter ID to be used in keyboard shortcuts
    editor.__qwebrCounter = qwebrCounter;

    // Store the official div container ID
    editor.__qwebrEditorId = `qwebr-editor-${qwebrCounter}`;

    // Store the initial code value and options
    editor.__qwebrinitialCode = initialCode;
    editor.__qwebrOptions = qwebrOptions;

    // Set at the model level the preferred end of line (EOL) character to LF.
    // This prevent `\r\n` from being given to the webR engine if the user is on Windows.
    // See details in: https://github.com/coatless/quarto-webr/issues/94
    // Associated error text: 
    // Error: <text>:1:7 unexpected input

    // Retrieve the underlying model
    const model = editor.getModel();
    // Set EOL for the model
    model.setEOL(monaco.editor.EndOfLineSequence.LF);
    
    // Dynamically modify the height of the editor window if new lines are added.
    let ignoreEvent = false;
    const updateHeight = () => {
      // Increment editor height by 2 to prevent vertical scroll bar from appearing
      const contentHeight = editor.getContentHeight() + 2;

      // Retrieve editor-max-height option
      const maxEditorHeight = qwebrOptions['editor-max-height'];

      // If editor-max-height is missing, allow infinite growth. Otherwise, threshold.
      const editorHeight = !maxEditorHeight ?  contentHeight : Math.min(contentHeight, maxEditorHeight);

      // We're avoiding a width change
      //editorDiv.style.width = `${width}px`;
      editorDiv.style.height = `${editorHeight}px`;
      try {
        ignoreEvent = true;

        // The key to resizing is this call
        editor.layout();
      } finally {
        ignoreEvent = false;
      }
    };

    // Function to generate decorations to highlight lines
    // in the editor based on input string.
    function decoratorHighlightLines(codeLineNumbers) {
      // Store the lines to be lighlight
      let linesToHighlight = [];
      
      // Parse the codeLineNumbers string to get the line numbers to highlight
      // First, split the string by commas
      codeLineNumbers.split(',').forEach(part => {
        // Check if we have a range of lines
        if (part.includes('-')) {
            // Handle range of lines (e.g., "6-8")
            const [start, end] = part.split('-').map(Number);
            for (let i = start; i <= end; i++) {
                linesToHighlight.push(i);
            }
        } else {
            // Handle single line (e.g., "7")
            linesToHighlight.push(Number(part));
        }
      });
  
      // Create monaco decorations for the lines to highlight
      const decorations = linesToHighlight.map(lineNumber => ({
          range: new monaco.Range(lineNumber, 1, lineNumber, 1),
          options: {
              isWholeLine: true,
              className: 'qwebr-editor-highlight-line'
          }
      }));
  
      // Return decorations to be applied to the editor
      return decorations;
    }

    // Ensure that the editor-code-line-numbers option is set and valid
    // then apply styling
    if (qwebrOptions['editor-code-line-numbers']) {
      // Remove all whitespace from the string
      const codeLineNumbers = qwebrOptions['editor-code-line-numbers'].replace(/\s/g,'');
      // Check if the string is valid for line numbers, e.g., "1,3-5,7"
      if (isValidCodeLineNumbers(codeLineNumbers)) {
        // Apply the decorations to the editor
        editor.createDecorationsCollection(decoratorHighlightLines(codeLineNumbers));
      } else {
        // Warn the user that the input is invalid
        console.warn(`Invalid "editor-code-line-numbers" value in code cell ${qwebrOptions['label']}: ${codeLineNumbers}`);
      }
    }

    // Helper function to check if selected text is empty
    function isEmptyCodeText(selectedCodeText) {
      return (selectedCodeText === null || selectedCodeText === undefined || selectedCodeText === "");
    }

    // Registry of keyboard shortcuts that should be re-added to each editor window
    // when focus changes.
    const addWebRKeyboardShortCutCommands = () => {
      // Add a keydown event listener for Shift+Enter to run all code in cell
      editor.addCommand(monaco.KeyMod.Shift | monaco.KeyCode.Enter, () => {

        // Retrieve all text inside the editor
        qwebrExecuteCode(editor.getValue(), editor.__qwebrCounter, editor.__qwebrOptions);
      });

      // Add a keydown event listener for CMD/Ctrl+Enter to run selected code
      editor.addCommand(monaco.KeyMod.CtrlCmd | monaco.KeyCode.Enter, () => {

        // Get the selected text from the editor
        const selectedText = editor.getModel().getValueInRange(editor.getSelection());
        // Check if no code is selected
        if (isEmptyCodeText(selectedText)) {
          // Obtain the current cursor position
          let currentPosition = editor.getPosition();
          // Retrieve the current line content
          let currentLine = editor.getModel().getLineContent(currentPosition.lineNumber);

          // Propose a new position to move the cursor to
          let newPosition = new monaco.Position(currentPosition.lineNumber + 1, 1);

          // Check if the new position is beyond the last line of the editor
          if (newPosition.lineNumber > editor.getModel().getLineCount()) {
            // Add a new line at the end of the editor
            editor.executeEdits("addNewLine", [{
            range: new monaco.Range(newPosition.lineNumber, 1, newPosition.lineNumber, 1),
            text: "\n", 
            forceMoveMarkers: true,
            }]);
          }
          
          // Run the entire line of code.
          qwebrExecuteCode(currentLine, editor.__qwebrCounter, editor.__qwebrOptions);

          // Move cursor to new position
          editor.setPosition(newPosition);
        } else {
          // Code to run when Ctrl+Enter is pressed with selected code
          qwebrExecuteCode(selectedText, editor.__qwebrCounter, editor.__qwebrOptions);
        }
      });
    }

    // Register an on focus event handler for when a code cell is selected to update
    // what keyboard shortcut commands should work.
    // This is a workaround to fix a regression that happened with multiple
    // editor windows since Monaco 0.32.0 
    // https://github.com/microsoft/monaco-editor/issues/2947
    editor.onDidFocusEditorText(addWebRKeyboardShortCutCommands);

    // Register an on change event for when new code is added to the editor window
    editor.onDidContentSizeChange(updateHeight);

    // Manually re-update height to account for the content we inserted into the call
    updateHeight();

    // Store the editor instance in the global dictionary
    qwebrEditorInstances[editor.__qwebrCounter] = editor;

  });

  // Add a click event listener to the run button
  runButton.onclick = function () {
    qwebrExecuteCode(editor.getValue(), editor.__qwebrCounter, editor.__qwebrOptions);
  };

  // Add a click event listener to the reset button
  copyButton.onclick = function () {
    // Retrieve current code data
    const data = editor.getValue();
    
    // Write code data onto the clipboard.
    navigator.clipboard.writeText(data || "");
  };
  
  // Add a click event listener to the copy button
  resetButton.onclick = function () {
    editor.setValue(editor.__qwebrinitialCode);
  };
  
}
</script>





<section id="chapter-t-tests-in-r" class="level1">
<h1>Chapter: T-Tests in R</h1>
<div class="callout callout-style-simple callout-note no-icon callout-titled" title="CC Attribution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
CC Attribution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Content below originally written by Matthew Crump under a CC-BY-NC-SA Licence. Original Content Chapter 6 of https://www.crumplab.com/statistics/06-ttests.html</p>
</div>
</div>
</div>
<p>Back in the day, William Sealy Gosset got a job working for Guinness Breweries. They make the famous Irish stout called Guinness. What happens next went something like this (total fabrication, but mostly on point).</p>
<p>Guinness wanted all of their beers to be the best beers. No mistakes, no bad beers. They wanted to improve their quality control so that when Guinness was poured anywhere in the world, it would always comes out fantastic: 5 stars out of 5 every time, the best.</p>
<p>Guinness had some beer tasters, who were super-experts. Every time they tasted a Guinness from the factory that wasn’t 5 out of 5, they knew right away.</p>
<p>But, Guinness had a big problem. They would make a keg of beer, and they would want to know if every single pint that would come out would be a 5 out of 5. So, the beer tasters drank pint after pint out of the keg, until it was gone. Some kegs were all 5 out of 5s. Some weren’t, Guinness needed to fix that. But, the biggest problem was that, after the testing, there <strong>was no beer left to sell</strong>, the testers drank it all (remember I’m making this part up to illustrate a point, they probably still had beer left to sell).</p>
<p>Guinness had a sampling and population problem. They wanted to know that the entire population of the beers they made were all 5 out of 5 stars. But, if they sampled the entire population, they would drink all of their beer, and wouldn’t have any left to sell.</p>
<p>Enter William Sealy Gosset. Gosset figured out the solution to the problem. He asked questions like this:</p>
<ol type="1">
<li><p>How many samples do I need to take to know the whole population is 5 out of 5?</p></li>
<li><p>What’s the fewest amount of samples I need to take to know the above, that would mean Guinness could test fewer beers for quality, sell more beers for profit, and make the product testing time shorter.</p></li>
</ol>
<p>Gosset solved those questions, and he invented something called the <em>Student’s t-test</em>. Gosset was working for Guinness, and could be fired for releasing trade-secrets that he invented (the t-test). But, Gosset published the work anyways, under a pseudonym <span class="citation" data-cites="Student1908">[@Student1908]</span>. He called himself Student, hence Student’s t-test. Now you know the rest of the story.</p>
<p>It turns out this was a very nice thing for Gosset to have done. t-tests are used all the time, and they are useful, that’s why they are used. In this chapter we learn how they work.</p>
<p>You’ll be surprised to learn that what we’ve already talked about, (the Crump Test, and the Randomization Test), are both very very similar to the t-test. So, in general, you have already been thinking about the things you need to think about to understand t-tests. You’re probably wondering what is this <span class="math inline">\(t\)</span>, what does <span class="math inline">\(t\)</span> mean? We will tell you. Before we tell what it means, we first tell you about one more idea.</p>
<section id="check-your-confidence-in-your-mean" class="level2">
<h2 class="anchored" data-anchor-id="check-your-confidence-in-your-mean">Check your confidence in your mean</h2>
<p>We’ve talked about getting a sample of data. We know we can find the mean, we know we can find the standard deviation. We know we can look at the data in a histogram. These are all useful things to do for us to learn something about the properties of our data.</p>
<p>You might be thinking of the mean and standard deviation as very different things that we would not put together. The mean is about central tendency (where most of the data is), and the standard deviation is about variance (where most of the data isn’t). Yes, they are different things, but we can use them together to create useful new things.</p>
<p>What if I told you my sample mean was 50, and I told you nothing else about my sample. Would you be confident that most of the numbers were near 50? Would you wonder if there was a lot of variability in the sample, and many of the numbers were very different from 50. You should wonder all of those things. The mean alone, just by itself, doesn’t tell you anything about well the mean represents all of the numbers in the sample.</p>
<p>It could be a representative number, when the standard deviation is very small, and all the numbers are close to 50. It could be a non-representative number, when the standard deviation is large, and many of the numbers are not near 50. You need to know the standard deviation in order to be confident in how well the mean represents the data.</p>
<p>How can we put the mean and the standard deviation together, to give us a new number that tells us about confidence in the mean?</p>
<p>We can do this using a ratio:</p>
<p><span class="math inline">\(\frac{mean}{\text{standard deviation}}\)</span></p>
<p>Think about what happens here. We are dividing a number by a number. Look at what happens:</p>
<p><span class="math inline">\(\frac{number}{\text{same number}} = 1\)</span></p>
<p><span class="math inline">\(\frac{number}{\text{smaller number}} = \text{big number}\)</span></p>
<p>compared to:</p>
<p><span class="math inline">\(\frac{number}{\text{bigger number}} = \text{smaller number}\)</span></p>
<p>Imagine we have a mean of 50, and a truly small standard deviation of 1. What do we get with our formula?</p>
<p><span class="math inline">\(\frac{50}{1} = 50\)</span></p>
<p>Imagine we have a mean of 50, and a big standard deviation of 100. What do we get with our formula?</p>
<p><span class="math inline">\(\frac{50}{100} = 0.5\)</span></p>
<p>Notice, when we have a mean paired with a small standard deviation, our formula gives us a big number, like 50. When we have a mean paired with a large standard deviation, our formula gives us a small number, like 0.5. These numbers can tell us something about confidence in our mean, in a general way. We can be 50 confident in our mean in the first case, and only 0.5 (not at a lot) confident in the second case.</p>
<p>What did we do here? We created a descriptive statistic by dividing the mean by the standard deviation. And, we have a sense of how to interpret this number, when it’s big we’re more confident that the mean represents all of the numbers, when it’s small we are less confident. This is a useful kind of number, a ratio between what we think about our sample (the mean), and the variability in our sample (the standard deviation). Get used to this idea. Almost everything that follows in this textbook is based on this kind of ratio. We will see that our ratio turns into different kinds of “statistics”, and the ratios will look like this in general:</p>
<p><span class="math inline">\(\text{name of statistic} = \frac{\text{measure of what we know}}{\text{measure of what we don't know}}\)</span></p>
<p>or, to say it using different words:</p>
<p><span class="math inline">\(\text{name of statistic} = \frac{\text{measure of effect}}{\text{measure of error}}\)</span></p>
<p>In fact, this is the general formula for the t-test. Big surprise!</p>
</section>
<section id="one-sample-t-test-a-new-t-test" class="level2">
<h2 class="anchored" data-anchor-id="one-sample-t-test-a-new-t-test">One-sample t-test: A new t-test</h2>
<p>Now we are ready to talk about t-test. We will talk about three of them. We start with the one-sample t-test.</p>
<p>Commonly, the one-sample t-test is used to estimate the chances that your sample came from a particular population. Specifically, you might want to know whether the mean that you found from your sample, could have come from a particular population having a particular mean.</p>
<p>Straight away, the one-sample t-test becomes a little confusing (and I haven’t even described it yet). Officially, it uses known parameters from the population, like the mean of the population and the standard deviation of the population. However, most times you don’t know those parameters of the population! So, you have to estimate them from your sample. Remember from the chapters on descriptive statistics and sampling, our sample mean is an unbiased estimate of the population mean. And, our sample standard deviation (the one where we divide by n-1) is an unbiased estimate of the population standard deviation. When Gosset developed the t-test, he recognized that he could use these estimates from his samples, to make the t-test. Here is the formula for the one sample t-test, we first use words, and then become more specific:</p>
<section id="formulas-for-one-sample-t-test" class="level3">
<h3 class="anchored" data-anchor-id="formulas-for-one-sample-t-test">Formulas for one-sample t-test</h3>
<p><span class="math inline">\(\text{name of statistic} = \frac{\text{measure of effect}}{\text{measure of error}}\)</span></p>
<p><span class="math inline">\(\text{t} = \frac{\text{measure of effect}}{\text{measure of error}}\)</span></p>
<p><span class="math inline">\(\text{t} = \frac{\text{Mean difference}}{\text{standard error}}\)</span></p>
<p><span class="math inline">\(\text{t} = \frac{\bar{X}-u}{S_{\bar{X}}}\)</span></p>
<p><span class="math inline">\(\text{t} = \frac{\text{Sample Mean  - Population Mean}}{\text{Sample Standard Error}}\)</span></p>
<p><span class="math inline">\(\text{Estimated Standard Error} = \text{Standard Error of Sample} = \frac{s}{\sqrt{N}}\)</span></p>
<p>Where, s is the sample standard deviation.</p>
<p>Some of you may have gone cross-eyed looking at all of this. Remember, we’ve seen it before when we divided our mean by the standard deviation in the first bit. The t-test is just a measure of a sample mean, divided by the standard error of the sample mean. That is it.</p>
</section>
<section id="what-does-t-represent" class="level3">
<h3 class="anchored" data-anchor-id="what-does-t-represent">What does t represent?</h3>
<p><span class="math inline">\(t\)</span> gives us a measure of confidence, just like our previous ratio for dividing the mean by a standard deviations. The only difference with <span class="math inline">\(t\)</span>, is that we divide by the standard error of mean (remember, this is also a standard deviation, it is the standard deviation of the sampling distribution of the mean)</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>What does the t in t-test stand for? Apparently nothing. Gosset originally labelled it z. And, Fisher later called it t, perhaps because t comes after s, which is often used for the sample standard deviation.</p>
</div>
</div>
<p><span class="math inline">\(t\)</span> is a property of the data that you collect. You compute it with a sample mean, and a sample standard error (there’s one more thing in the one-sample formula, the population mean, which we get to in a moment). This is why we call <span class="math inline">\(t\)</span>, a sample-statistic. It’s a statistic we compute from the sample.</p>
<p>What kinds of numbers should we expect to find for these <span class="math inline">\(ts\)</span>? How could we figure that out?</p>
<p>Let’s start small and work through some examples. Imagine your sample mean is 5. You want to know if it came from a population that also has a mean of 5. In this case, what would <span class="math inline">\(t\)</span> be? It would be zero: we first subtract the sample mean from the population mean, <span class="math inline">\(5-5=0\)</span>. Because the numerator is 0, <span class="math inline">\(t\)</span> will be zero. So, <span class="math inline">\(t\)</span> = 0, occurs, when there is no difference.</p>
<p>Let’s say you take another sample, do you think the mean will be 5 every time, probably not. Let’s say the mean is 6. So, what can <span class="math inline">\(t\)</span> be here? It will be a positive number, because 6-5= +1. But, will <span class="math inline">\(t\)</span> be +1? That depends on the standard error of the sample. If the standard error of the sample is 1, then <span class="math inline">\(t\)</span> could be 1, because 1/1 = 1.</p>
<p>If the sample standard error is smaller than 1, what happens to <span class="math inline">\(t\)</span>? It get’s bigger right? For example, 1 divided by 0.5 = 2. If the sample standard error was 0.5, <span class="math inline">\(t\)</span> would be 2. And, what could we do with this information? Well, it be like a measure of confidence. As <span class="math inline">\(t\)</span> get’s bigger we could be more confident in the mean difference we are measuring.</p>
<p>Can <span class="math inline">\(t\)</span> be smaller than 1? Sure, it can. If the sample standard error is big, say like 2, then <span class="math inline">\(t\)</span> will be smaller than one (in our case), e.g., 1/2 = .5. The direction of the difference between the sample mean and population mean, can also make the <span class="math inline">\(t\)</span> become negative. What if our sample mean was 4. Well, then <span class="math inline">\(t\)</span> will be negative, because the mean difference in the numerator will be negative, and the number in the bottom (denominator) will always be positive (remember why, it’s the standard error, computed from the sample standard deviation, which is always positive because of the squaring that we did.).</p>
<p>So, that is some intuitions about what the kinds of values t can take. <span class="math inline">\(t\)</span> can be positive or negative, and big or small.</p>
<p>Let’s do one more thing to build our intuitions about what <span class="math inline">\(t\)</span> can look like. How about we sample some numbers and then measure the sample mean <strong>and</strong> the standard error of the mean, and then plot those two things against each each. This will show us how a sample mean typically varies with respect to the standard error of the mean.</p>
<p>In <a href="#fig-6sampleMSEM" class="quarto-xref">Figure&nbsp;1</a>, I pulled 1,000 samples of <span class="math inline">\(N = 10\)</span> from a normal distribution (mean = 0, sd = 1). Each time I measured the mean and standard error of the sample. That gave two descriptive statistics for each sample, letting us plot each sample as dot in a scatter plot.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>The following package(s) will be installed:
- ggplot2 [3.5.1]
These packages will be installed into "~/Library/Mobile Documents/com~apple~CloudDocs/_Teaching2024/IntroRM/renv/library/macos/R-4.4/x86_64-apple-darwin20".

# Installing packages --------------------------------------------------------
- Installing ggplot2 ...                        OK [linked from cache]
Successfully installed 1 package in 11 milliseconds.</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sample_se <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  sample_mean[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(s)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  sample_se[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(s) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(s))</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sample_mean, sample_se)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6sampleMSEM" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6sampleMSEM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6sampleMSEM-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6sampleMSEM-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: A scatter plot with sample mean on the x-axis, and standard error of the mean on the y-axis
</figcaption>
</figure>
</div>
</div>
</div>
<div id="qwebr-insertion-location-1"></div>
<noscript>Please enable JavaScript to experience the dynamic code cell content on this page.</noscript>
<div id="qwebr-insertion-location-2"></div>
<noscript>Please enable JavaScript to experience the dynamic code cell content on this page.</noscript>
<ol type="1">
<li>Take <code>penguins</code>, and then,</li>
<li>add new columns for the bill ratio and bill area.</li>
</ol>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-4-1"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="annotated-cell-4-2"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-3" class="code-annotation-target"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2">2</button><span id="annotated-cell-4-4" class="code-annotation-target"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="annotated-cell-4-5"><a href="#annotated-cell-4-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_ratio =</span> bill_depth_mm <span class="sc">/</span> bill_length_mm,</span>
<span id="annotated-cell-4-6"><a href="#annotated-cell-4-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_area  =</span> bill_depth_mm <span class="sc">*</span> bill_length_mm</span>
<span id="annotated-cell-4-7"><a href="#annotated-cell-4-7" aria-hidden="true" tabindex="-1"></a>  )</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="3" data-code-annotation="1">Take <code>penguins</code>, and then,</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="4,5,6,7" data-code-annotation="2">add new columns for the bill ratio and bill area.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 10
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750
 2 Adelie  Torgersen           39.5          17.4               186        3800
 3 Adelie  Torgersen           40.3          18                 195        3250
 4 Adelie  Torgersen           NA            NA                  NA          NA
 5 Adelie  Torgersen           36.7          19.3               193        3450
 6 Adelie  Torgersen           39.3          20.6               190        3650
 7 Adelie  Torgersen           38.9          17.8               181        3625
 8 Adelie  Torgersen           39.2          19.6               195        4675
 9 Adelie  Torgersen           34.1          18.1               193        3475
10 Adelie  Torgersen           42            20.2               190        4250
# ℹ 334 more rows
# ℹ 4 more variables: sex &lt;fct&gt;, year &lt;int&gt;, bill_ratio &lt;dbl&gt;, bill_area &lt;dbl&gt;</code></pre>
</div>
</div>
<!-- ```{r}
library(countdown)

countdown(minutes = 0, seconds = 15)
``` -->
<div class="to-webr">
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-47"><pre class="sourceCode r code-annotation-code code-with-copy"><code class="sourceCode r"><span id="annotated-cell-47-1"><a href="#annotated-cell-47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="annotated-cell-47-2"><a href="#annotated-cell-47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="annotated-cell-47-3"><a href="#annotated-cell-47-3" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span></span>
<span id="annotated-cell-47-4"><a href="#annotated-cell-47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="annotated-cell-47-5"><a href="#annotated-cell-47-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_ratio =</span> bill_depth_mm <span class="sc">/</span> bill_length_mm,</span>
<span id="annotated-cell-47-6"><a href="#annotated-cell-47-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_area  =</span> bill_depth_mm <span class="sc">*</span> bill_length_mm</span>
<span id="annotated-cell-47-7"><a href="#annotated-cell-47-7" aria-hidden="true" tabindex="-1"></a>  )         </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 344 × 10
   species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
   &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
 1 Adelie  Torgersen           39.1          18.7               181        3750
 2 Adelie  Torgersen           39.5          17.4               186        3800
 3 Adelie  Torgersen           40.3          18                 195        3250
 4 Adelie  Torgersen           NA            NA                  NA          NA
 5 Adelie  Torgersen           36.7          19.3               193        3450
 6 Adelie  Torgersen           39.3          20.6               190        3650
 7 Adelie  Torgersen           38.9          17.8               181        3625
 8 Adelie  Torgersen           39.2          19.6               195        4675
 9 Adelie  Torgersen           34.1          18.1               193        3475
10 Adelie  Torgersen           42            20.2               190        4250
# ℹ 334 more rows
# ℹ 4 more variables: sex &lt;fct&gt;, year &lt;int&gt;, bill_ratio &lt;dbl&gt;, bill_area &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<p>What we get is a cloud of dots. You might notice the cloud has a circular quality. There’s more dots in the middle, and fewer dots as they radiate out from the middle. The dot cloud shows us the general range of the sample mean, for example most of the dots are in between -1 and 1. Similarly, the range for the sample standard error is roughly between .2 and .5. Remember, each dot represents one sample.</p>
<p>We can look at the same data a different way. For example, rather than using a scatter plot, we can divide the mean for each dot by the standard error for each dot. <a href="#fig-6thisexample" class="quarto-xref">Figure&nbsp;2</a> shows the result in a histogram.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_mean<span class="sc">/</span>sample_se, <span class="at">breaks=</span><span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6thisexample" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6thisexample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6thisexample-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6thisexample-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: A histogram of the sample means divided by the sample standard errors, this is a t-distribution.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Interesting, we can see the histogram is shaped like a normal curve. It is centered on 0, which is the most common value. As values become more extreme, they become less common. If you remember, our formula for <span class="math inline">\(t\)</span>, was the mean divided by the standard error of the mean. That’s what we did here. This histogram is showing you a <span class="math inline">\(t\)</span>-distribution.</p>
</section>
<section id="calculating-t-from-data" class="level3">
<h3 class="anchored" data-anchor-id="calculating-t-from-data">Calculating t from data</h3>
<p>Let’s briefly calculate a t-value from a small sample. Let’s say we had 10 students do a true/false quiz with 5 questions on it. There’s a 50% chance of getting each answer correct.</p>
<p>Every student completes the 5 questions, we grade them, and then we find their performance (mean percent correct). What we want to know is whether the students were guessing. If they were all guessing, then the sample mean should be about 50%, it shouldn’t be different from chance, which is 50%. Let’s look at <a href="#tbl-tsmall" class="quarto-xref">Table&nbsp;1</a>.</p>
<div class="cell">
<div id="tbl-tsmall" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-tsmall-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Calculating the t-value for a one-sample test.
</figcaption>
<div aria-describedby="tbl-tsmall-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">students</th>
<th style="text-align: left;">scores</th>
<th style="text-align: left;">mean</th>
<th style="text-align: left;">Difference_from_Mean</th>
<th style="text-align: left;">Squared_Deviations</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">50</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;">-11</td>
<td style="text-align: left;">121</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">70</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">81</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">60</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;">-1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">40</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;">-21</td>
<td style="text-align: left;">441</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">80</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;">19</td>
<td style="text-align: left;">361</td>
</tr>
<tr class="even">
<td style="text-align: left;">6</td>
<td style="text-align: left;">30</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;">-31</td>
<td style="text-align: left;">961</td>
</tr>
<tr class="odd">
<td style="text-align: left;">7</td>
<td style="text-align: left;">90</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;">29</td>
<td style="text-align: left;">841</td>
</tr>
<tr class="even">
<td style="text-align: left;">8</td>
<td style="text-align: left;">60</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;">-1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">9</td>
<td style="text-align: left;">70</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;">9</td>
<td style="text-align: left;">81</td>
</tr>
<tr class="even">
<td style="text-align: left;">10</td>
<td style="text-align: left;">60</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;">-1</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sums</td>
<td style="text-align: left;">610</td>
<td style="text-align: left;">610</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">2890</td>
</tr>
<tr class="even">
<td style="text-align: left;">Means</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;">61</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">289</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">sd</td>
<td style="text-align: left;">17.92</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">SEM</td>
<td style="text-align: left;">5.67</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">t</td>
<td style="text-align: left;">1.94003527336861</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>You can see the <code>scores</code> column has all of the test scores for each of the 10 students. We did the things we need to do to compute the standard deviation.</p>
<p>Remember the sample standard deviation is the square root of the sample variance, or:</p>
<p><span class="math inline">\(\text{sample standard deviation} = \sqrt{\frac{\sum_{i}^{n}({x_{i}-\bar{x})^2}}{N-1}}\)</span></p>
<p><span class="math inline">\(\text{sd} = \sqrt{\frac{2890}{10-1}} = 17.92\)</span></p>
<p>The standard error of the mean, is the standard deviation divided by the square root of N</p>
<p><span class="math inline">\(\text{SEM} = \frac{s}{\sqrt{N}} = \frac{17.92}{10} = 5.67\)</span></p>
<p><span class="math inline">\(t\)</span> is the difference between our sample mean (61), and our population mean (50, assuming chance), divided by the standard error of the mean.</p>
<p><span class="math inline">\(\text{t} = \frac{\bar{X}-u}{S_{\bar{X}}} = \frac{\bar{X}-u}{SEM} = \frac{61-50}{5.67} = 1.94\)</span></p>
<p>And, that is you how calculate <span class="math inline">\(t\)</span>, by hand. It’s a pain. I was annoyed doing it this way. In the lab, you learn how to calculate <span class="math inline">\(t\)</span> using software, so it will just spit out <span class="math inline">\(t\)</span>. For example in R, all you have to do is this:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(scores, <span class="at">mu=</span><span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  scores
t = 1.9412, df = 9, p-value = 0.08415
alternative hypothesis: true mean is not equal to 50
95 percent confidence interval:
 48.18111 73.81889
sample estimates:
mean of x 
       61 </code></pre>
</div>
</div>
</section>
<section id="how-does-t-behave" class="level3">
<h3 class="anchored" data-anchor-id="how-does-t-behave">How does t behave?</h3>
<p>If <span class="math inline">\(t\)</span> is just a number that we can compute from our sample (it is), what can we do with it? How can we use <span class="math inline">\(t\)</span> for statistical inference?</p>
<p>Remember back to the chapter on sampling and distributions, that’s where we discussed the sampling distribution of the sample mean. Remember, we made a lot of samples, then computed the mean for each sample, then we plotted a histogram of the sample means. Later, in that same section, we mentioned that we could generate sampling distributions for any statistic. For each sample, we could compute the mean, the standard deviation, the standard error, and now even <span class="math inline">\(t\)</span>, if we wanted to. We could generate 10,000 samples, and draw four histograms, one for each sampling distribution for each statistic.</p>
<p>This is exactly what I did, and the results are shown in the four panels of <a href="#fig-6sampdists" class="quarto-xref">Figure&nbsp;3</a> below. I used a sample size of 20, and drew random observations for each sample from a normal distribution, with mean = 0, and standard deviation = 1. Let’s look at the sampling distributions for each of the statistics. <span class="math inline">\(t\)</span> was computed assuming with the population mean assumed to be 0.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>all_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  sample_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(sample)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  sample_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(sample) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(sample))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  sample_t <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">t.test</span>(sample, <span class="at">mu =</span> <span class="dv">0</span>)<span class="sc">$</span>statistic)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  t_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(i, sample_mean, sample_sd, sample_se, sample_t)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  all_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_df, t_df)</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_df, <span class="fu">aes</span>(<span class="at">x =</span> sample_mean)) <span class="sc">+</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">20</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_df, <span class="fu">aes</span>(<span class="at">x =</span> sample_sd)) <span class="sc">+</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">20</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_df, <span class="fu">aes</span>(<span class="at">x =</span> sample_se)) <span class="sc">+</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">20</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_df, <span class="fu">aes</span>(<span class="at">x =</span> sample_t)) <span class="sc">+</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">20</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(a, b, c, d,</span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6sampdists" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6sampdists-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6sampdists-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6sampdists-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Sampling distributions for the mean, standard deviation, standard error of the mean, and <span class="math inline">\(t\)</span>.
</figcaption>
</figure>
</div>
</div>
</div>
<p>We see four sampling distributions. This is how statistical summaries of these summaries behave. We have used the word chance windows before. These are four chance windows, measuring different aspects of the sample. In this case, all of the samples came from the same normal distribution. Because of sampling error, each sample is not identical. The means are not identical, the standard deviations are not identical, sample standard error of the means are not identical, and the <span class="math inline">\(t\)</span>s of the samples are not identical. They all have some variation, as shown by the histograms. This is how samples of size 20 behave.</p>
<p>We can see straight away, that in this case, we are unlikely to get a sample mean of 2. That’s way outside the window. The range for the sampling distribution of the mean is around -.5 to +.5, and is centered on 0 (the population mean, would you believe!).</p>
<p>We are unlikely to get sample standard deviations of between .6 and 1.5, that is a different range, specific to the sample standard deviation.</p>
<p>Same thing with the sample standard error of the mean, the range here is even smaller, mostly between .1, and .3. You would rarely find a sample with a standard error of the mean greater than .3. Virtually never would you find one of say 1 (for this situation).</p>
<p>Now, look at <span class="math inline">\(t\)</span>. It’s range is basically between -3 and +3 here. 3s barely happen at all. You pretty much never see a 5 or -5 in this situation.</p>
<p>All of these sampling windows are chance windows, and they can all be used in the same way as we have used similar sampling distributions before (e.g., Crump Test, and Randomization Test) for statistical inference. For all of them we would follow the same process:</p>
<ol type="1">
<li>Generate these distributions</li>
<li>Look at your sample statistics for the data you have (mean, SD, SEM, and <span class="math inline">\(t\)</span>)</li>
<li>Find the likelihood of obtaining that value or greater</li>
<li>Obtain that probability</li>
<li>See if you think your sample statistics were probable or improbable.</li>
</ol>
<p>We’ll formalize this in a second. I just want you to know that what you will be doing is something that you have already done before. For example, in the Crump test and the Randomization test we focused on the distribution of mean differences. We could do that again here, but instead, we will focus on the distribution of <span class="math inline">\(t\)</span> values. We then apply the same kinds of decision rules to the <span class="math inline">\(t\)</span> distribution, as we did for the other distributions. Below you will see a graph you have already seen, except this time it is a distribution of <span class="math inline">\(t\)</span>s, not mean differences:</p>
<p>Remember, if we obtained a single <span class="math inline">\(t\)</span> from one sample we collected, we could consult the chance window in <a href="#fig-6tdecision" class="quarto-xref">Figure&nbsp;4</a> below to find out whether the <span class="math inline">\(t\)</span> we obtained from the sample was likely or unlikely to occur by chance.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sample_t <span class="ot">&lt;-</span> all_df<span class="sc">$</span>sample_t</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_df, <span class="fu">aes</span>(<span class="at">x =</span> sample_t)) <span class="sc">+</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">min</span>(sample_t),</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">max</span>(sample_t),</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"red"</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">min</span>(sample_t),</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="sc">-</span><span class="fl">1.94</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"light grey"</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fl">1.94</span>,</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">max</span>(sample_t),</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"light grey"</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">min</span>(sample_t),</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">"lightgreen"</span>) <span class="sc">+</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">max</span>(sample_t),</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="cn">Inf</span>,</span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb11-43"><a href="#cb11-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span></span>
<span id="cb11-44"><a href="#cb11-44" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb11-45"><a href="#cb11-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb11-46"><a href="#cb11-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">"lightgreen"</span>) <span class="sc">+</span></span>
<span id="cb11-47"><a href="#cb11-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb11-48"><a href="#cb11-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb11-49"><a href="#cb11-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(sample_t)) <span class="sc">+</span></span>
<span id="cb11-50"><a href="#cb11-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">max</span>(sample_t)) <span class="sc">+</span></span>
<span id="cb11-51"><a href="#cb11-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="sc">-</span><span class="fl">1.94</span>) <span class="sc">+</span></span>
<span id="cb11-52"><a href="#cb11-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">1.94</span>) <span class="sc">+</span></span>
<span id="cb11-53"><a href="#cb11-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb11-54"><a href="#cb11-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">250</span>, <span class="at">label =</span> <span class="st">"CHANCE"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb11-55"><a href="#cb11-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">y =</span> <span class="dv">250</span>, <span class="at">label =</span> <span class="st">"NOT </span><span class="sc">\n</span><span class="st"> CHANCE"</span>),</span>
<span id="cb11-56"><a href="#cb11-56" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb11-57"><a href="#cb11-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">250</span>, <span class="at">label =</span> <span class="st">"NOT </span><span class="sc">\n</span><span class="st"> CHANCE"</span>),</span>
<span id="cb11-58"><a href="#cb11-58" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb11-59"><a href="#cb11-59" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  geom_label(data = data.frame(x = min(sample_t), y = 600,</span></span>
<span id="cb11-60"><a href="#cb11-60" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                              label = paste0("min \n",round(min(sample_t)))),</span></span>
<span id="cb11-61"><a href="#cb11-61" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                             aes(x = x, y = y, label = label))+</span></span>
<span id="cb11-62"><a href="#cb11-62" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_label(data = data.frame(x = max(sample_t), y = 600,</span></span>
<span id="cb11-63"><a href="#cb11-63" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                            label = paste0("max \n",round(max(sample_t)))),</span></span>
<span id="cb11-64"><a href="#cb11-64" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                           aes(x = x, y = y, label = label))+</span></span>
<span id="cb11-65"><a href="#cb11-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">y =</span> <span class="dv">250</span>,</span>
<span id="cb11-66"><a href="#cb11-66" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> <span class="st">"?"</span>),</span>
<span id="cb11-67"><a href="#cb11-67" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb11-68"><a href="#cb11-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="dv">250</span>,</span>
<span id="cb11-69"><a href="#cb11-69" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> <span class="st">"?"</span>),</span>
<span id="cb11-70"><a href="#cb11-70" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb11-71"><a href="#cb11-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"mean sample_t"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6tdecision" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6tdecision-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6tdecision-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6tdecision-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Applying decision criteria to the <span class="math inline">\(t\)</span>-distribution. Histogram of <span class="math inline">\(t\)</span>s from samples (n=20) drawn from the same normal distribution (u=0, sd=1)
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="making-a-decision" class="level3">
<h3 class="anchored" data-anchor-id="making-a-decision">Making a decision</h3>
<p>From our early example involving the TRUE/FALSE quizzes, we are now ready to make some kind of decision about what happened there. We found a mean difference of 11. We found a <span class="math inline">\(t\)</span> = 1.9411765. The probability of this <span class="math inline">\(t\)</span> or larger occurring is <span class="math inline">\(p\)</span> = 0.0841503. We were testing the idea that our sample mean of 61 could have come from a normal distribution with mean = 50. The <span class="math inline">\(t\)</span> test tells us that the <span class="math inline">\(t\)</span> for our sample, or a larger one, would happen with p = 0.0841503. In other words, chance can do it a kind of small amount of time, but not often. In English, this means that all of the students could have been guessing, but it wasn’t that likely that were just guessing.</p>
<p>The next <span class="math inline">\(t\)</span>-test is called a <strong>paired samples t-test</strong>. And, spoiler alert, we will find out that a paired samples t-test is actually a one-sample t-test in disguise (WHAT!), yes it is. If the one-sample <span class="math inline">\(t\)</span>-test didn’t make sense to you, read the next section.</p>
</section>
</section>
<section id="paired-samples-t-test" class="level2">
<h2 class="anchored" data-anchor-id="paired-samples-t-test">Paired-samples t-test</h2>
<p>For me (Crump), many analyses often boil down to a paired samples t-test. It just happens that many things I do reduce down to a test like this.</p>
<p>I am a cognitive psychologist, I conduct research about how people do things like remember, pay attention, and learn skills. There are lots of Psychologists like me, who do very similar things.</p>
<p>We all often conduct the same kinds of experiments. They go like this, and they are called <strong>repeated measures</strong> designs. They are called <strong>repeated measures</strong> designs, because we measure how one person does something more than once, we <strong>repeat</strong> the measure.</p>
<p>So, I might measure somebody doing something in condition A, and measure the same person doing something in Condition B, and then I see that same person does different things in the two conditions. I <strong>repeatedly measure</strong> the same person in both conditions. I am interested in whether the experimental manipulation changes something about how people perform the task in question.</p>
<section id="mehr-song-and-spelke-2016" class="level3">
<h3 class="anchored" data-anchor-id="mehr-song-and-spelke-2016">Mehr, Song, and Spelke (2016)</h3>
<p>We will introduce the paired-samples t-test with an example using real data, from a real study. <span class="citation" data-cites="mehr20165">@mehr20165</span> were interested in whether singing songs to infants helps infants become more sensitive to social cues. For example, infants might need to learn to direct their attention toward people as a part of learning how to interact socially with people. Perhaps singing songs to infants aids this process of directing attention. When an infant hears a familiar song, they might start to pay more attention to the person singing that song, even after they are done singing the song. The person who sang the song might become more socially important to the infant. You will learn more about this study in the lab for this week. This example, prepares you for the lab activities. Here is a brief summary of what they did.</p>
<p>First, parents were trained to sing a song to their infants. After many days of singing this song to the infants, a parent came into the lab with their infant. In the first session, parents sat with their infants on their knees, so the infant could watch two video presentations. There were two videos. Each video involved two unfamiliar new people the infant had never seen before. Each new person in the video (the singers) sang one song to the infant. One singer sang the “familiar” song the infant had learned from their parents. The other singer sang an “unfamiliar” song the infant had not hear before.</p>
<p>There were two really important measurement phases: the baseline phase, and the test phase.</p>
<p>The baseline phase occurred before the infants saw and heard each singer sing a song. During the baseline phase, the infants watched a video of both singers at the same time. The researchers recorded the proportion of time that the infant looked at each singer. The baseline phase was conducted to determine whether infants had a preference to look at either person (who would later sing them a song).</p>
<p>The test phase occurred <strong>after</strong> infants saw and heard each song, sung by each singer. During the test phase, each infant had an opportunity to watch silent videos of both singers. The researchers measured the proportion of time the infants spent looking at each person. The question of interest, was whether the infants would spend a greater proportion of time looking at the singer who sang the familiar song, compared to the singer who sang the unfamiliar song.</p>
<p>There is more than one way to describe the design of this study. We will describe it like this. It was a repeated measures design, with one independent (manipulation) variable called Viewing phase: Baseline versus Test. There was one dependent variable (the measurement), which was proportion looking time (to singer who sung familiar song). This was a repeated measures design because the researchers measured proportion looking time twice (they repeated the measure), once during baseline (before infants heard each singer sing a song), and again during test (after infants head each singer sing a song).</p>
<p>The important question was whether infants would change their looking time, and look more at the singer who sang the familiar song during the test phase, than they did during the baseline phase. This is a question about a change within individual infants. In general, the possible outcomes for the study are:</p>
<ol type="1">
<li><p>No change: The difference between looking time toward the singer of the familiar song during baseline and test is zero, no difference.</p></li>
<li><p>Positive change: Infants will look longer toward the singer of the familiar song during the test phase (after they saw and heard the singers), compared to the baseline phase (before they saw and heard the singers). This is a positive difference if we use the formula: Test Phase Looking time - Baseline phase looking time (to familiar song singer).</p></li>
<li><p>Negative change: Infants will look longer toward the singer of the unfamiliar song during the test phase (after they saw and heard the singers), compared to the baseline phase (before they saw and heard the singers). This is a negative difference if we use the same formula: Test Phase Looking time - Baseline phase looking time (to familiar song singer).</p></li>
</ol>
</section>
<section id="the-data" class="level3">
<h3 class="anchored" data-anchor-id="the-data">The data</h3>
<p>Let’s take a look at the data for the first 5 infants in the study. This will help us better understand some properties of the data before we analyze it. We will see that the data is structured in a particular way that we can take advantage of with a paired samples t-test. Note, we look at the first 5 infants to show how the computations work. The results of the paired-samples t-test change when we use all of the data from the study.</p>
<p>Here is a table of the data:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">infant</th>
<th style="text-align: right;">Baseline</th>
<th style="text-align: right;">Test</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.60</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.68</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.72</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.28</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.50</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The table shows proportion looking times toward the singer of the familiar song during the Baseline and Test phases. Notice there are five different infants, (1 to 5). Each infant is measured twice, once during the Baseline phase, and once during the Test phase. To repeat from before, this is a repeated-measures design, because the infants are measured repeatedly (twice in this case). Or, this kind of design is also called a <strong>paired-samples</strong> design. Why? because each participant comes with a pair of samples (two samples), one for each level of the design.</p>
<p>Great, so what are we really interested in here? We want to know if the mean looking time toward the singer of the familiar song for the Test phase is higher than the Baseline phase. We are comparing the two sample means against each other and looking for a difference. We already know that differences could be obtained by chance alone, simply because we took two sets of samples, and we know that samples can be different. So, we are interested in knowing whether chance was likely or unlikely to have produced any difference we might observe.</p>
<p>In other words, we are interested in looking at the difference scores between the baseline and test phase for each infant. The question here is, for each infant, did their proportion looking time to the singer of the familiar song, increase during the test phase as compared to the baseline phase.</p>
</section>
<section id="the-difference-scores" class="level3">
<h3 class="anchored" data-anchor-id="the-difference-scores">The difference scores</h3>
<p>Let’s add the difference scores to the table of data so it is easier to see what we are talking about. The first step in creating difference scores is to decide how you will take the difference, there are two options:</p>
<ol type="1">
<li>Test phase score - Baseline Phase Score</li>
<li>Baseline phase score - Test Phase score</li>
</ol>
<p>Let’s use the first formula. Why? Because it will give us positive differences when the test phase score is higher than the baseline phase score. This makes a positive score meaningful with respect to the study design, we know (because we defined it to be this way), that positive scores will refer to longer proportion looking times (to singer of familiar song) during the test phase compared to the baseline phase.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>paired_sample_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(paired_sample_df, </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">differences =</span> (paired_sample_df<span class="sc">$</span>Test<span class="sc">-</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                                           paired_sample_df<span class="sc">$</span>Baseline))</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(paired_sample_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">infant</th>
<th style="text-align: right;">Baseline</th>
<th style="text-align: right;">Test</th>
<th style="text-align: right;">differences</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.68</td>
<td style="text-align: right;">0.27</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">-0.03</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">0.44</td>
<td style="text-align: right;">0.28</td>
<td style="text-align: right;">-0.16</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.03</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>There we have it, the difference scores. The first thing we can do here is look at the difference scores, and ask how many infants showed the effect of interest. Specifically, how many infants showed a positive difference score. We can see that three of five infants showed a positive difference (they looked more at the singer of the familiar song during the test than baseline phase), and two the infants showed the opposite effect (negative difference, they looked more at the singer of the familiar song during baseline than test).</p>
</section>
<section id="the-mean-difference" class="level3">
<h3 class="anchored" data-anchor-id="the-mean-difference">The mean difference</h3>
<p>As we have been discussing, the effect of interest in this study is the mean difference between the baseline and test phase proportion looking times. We can calculate the <strong>mean difference</strong>, by finding the <strong>mean of the difference scores</strong>. Let’s do that, in fact, for fun let’s calculate the mean of the baseline scores, the test scores, and the difference scores.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>paired_sample_df <span class="ot">&lt;-</span> paired_sample_df <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">"Sums"</span>,<span class="fu">colSums</span>(paired_sample_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]))) <span class="sc">%&gt;%</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">"Means"</span>,<span class="fu">colMeans</span>(paired_sample_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(paired_sample_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">infant</th>
<th style="text-align: left;">Baseline</th>
<th style="text-align: left;">Test</th>
<th style="text-align: left;">differences</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">0.44</td>
<td style="text-align: left;">0.6</td>
<td style="text-align: left;">0.16</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">0.41</td>
<td style="text-align: left;">0.68</td>
<td style="text-align: left;">0.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;">0.72</td>
<td style="text-align: left;">-0.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">0.44</td>
<td style="text-align: left;">0.28</td>
<td style="text-align: left;">-0.16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">0.47</td>
<td style="text-align: left;">0.5</td>
<td style="text-align: left;">0.03</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sums</td>
<td style="text-align: left;">2.51</td>
<td style="text-align: left;">2.78</td>
<td style="text-align: left;">0.27</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Means</td>
<td style="text-align: left;">0.502</td>
<td style="text-align: left;">0.556</td>
<td style="text-align: left;">0.054</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>We can see there was a positive mean difference of 0.054, between the test and baseline phases.</p>
<p>Can we rush to judgment and conclude that infants are more socially attracted to individuals who have sung them a familiar song? I would hope not based on this very small sample. First, the difference in proportion looking isn’t very large, and of course we recognize that this difference could have been produced by chance.</p>
<p>We will more formally evaluate whether this difference could have been caused by chance with the paired-samples t-test. But, before we do that, let’s again calculate <span class="math inline">\(t\)</span> and discuss what <span class="math inline">\(t\)</span> tells us over and above what our measure of the mean of the difference scores tells us.</p>
</section>
<section id="calculate-t" class="level3">
<h3 class="anchored" data-anchor-id="calculate-t">Calculate t</h3>
<p>OK, so how do we calculate <span class="math inline">\(t\)</span> for a paired-samples <span class="math inline">\(t\)</span>-test? Surprise, we use the one-sample t-test formula that you already learned about! Specifically, we use the one-sample <span class="math inline">\(t\)</span>-test formula on the difference scores. We have one sample of difference scores (you can see they are in one column), so we can use the one-sample <span class="math inline">\(t\)</span>-test on the difference scores. Specifically, we are interested in comparing whether the mean of our difference scores came from a distribution with mean difference = 0. This is a special distribution we refer to as the <strong>null distribution</strong>. It is the distribution no differences. Of course, this <strong>null distribution</strong> can produce differences due to to sampling error, but those differences are not caused by any experimental manipulation, they caused by the random sampling process.</p>
<p>We calculate <span class="math inline">\(t\)</span> in a moment. Let’s now consider again why we want to calculate <span class="math inline">\(t\)</span>? Why don’t we just stick with the mean difference we already have?</p>
<p>Remember, the whole concept behind <span class="math inline">\(t\)</span>, is that it gives an indication of how confident we should be in our mean. Remember, <span class="math inline">\(t\)</span> involves a measure of the mean in the numerator, divided by a measure of variation (standard error of the sample mean) in the denominator. The resulting <span class="math inline">\(t\)</span> value is small when the mean difference is small, or when the variation is large. So small <span class="math inline">\(t\)</span>-values tell us that we shouldn’t be that confident in the estimate of our mean difference. Large <span class="math inline">\(t\)</span>-values occur when the mean difference is large and/or when the measure of variation is small. So, large <span class="math inline">\(t\)</span>-values tell us that we can be more confident in the estimate of our mean difference. Let’s find <span class="math inline">\(t\)</span> for the mean difference scores. We use the same formulas as we did last time:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 17%">
<col style="width: 21%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">infant</th>
<th style="text-align: left;">Baseline</th>
<th style="text-align: left;">Test</th>
<th style="text-align: left;">differences</th>
<th style="text-align: left;">diff_from_mean</th>
<th style="text-align: left;">Squared_differences</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">0.44</td>
<td style="text-align: left;">0.6</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: left;">0.106</td>
<td style="text-align: left;">0.011236</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">0.41</td>
<td style="text-align: left;">0.68</td>
<td style="text-align: left;">0.27</td>
<td style="text-align: left;">0.216</td>
<td style="text-align: left;">0.046656</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;">0.72</td>
<td style="text-align: left;">-0.03</td>
<td style="text-align: left;">-0.084</td>
<td style="text-align: left;">0.00705600000000001</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">0.44</td>
<td style="text-align: left;">0.28</td>
<td style="text-align: left;">-0.16</td>
<td style="text-align: left;">-0.214</td>
<td style="text-align: left;">0.045796</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">0.47</td>
<td style="text-align: left;">0.5</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.024</td>
<td style="text-align: left;">0.000575999999999999</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sums</td>
<td style="text-align: left;">2.51</td>
<td style="text-align: left;">2.78</td>
<td style="text-align: left;">0.27</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0.11132</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Means</td>
<td style="text-align: left;">0.502</td>
<td style="text-align: left;">0.556</td>
<td style="text-align: left;">0.054</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0.022264</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">sd</td>
<td style="text-align: left;">0.167</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">SEM</td>
<td style="text-align: left;">0.075</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">t</td>
<td style="text-align: left;">0.72</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>If we did this test using R, we would obtain almost the same numbers (there is a little bit of rounding in the table).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(differences,<span class="at">mu=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  differences
t = 0.72381, df = 4, p-value = 0.5092
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.1531384  0.2611384
sample estimates:
mean of x 
    0.054 </code></pre>
</div>
</div>
<p>Here is a quick write up of our t-test results, t(4) = .72, p = .509.</p>
<p>What does all of that tell us? There’s a few things we haven’t gotten into much yet. For example, the 4 represents degrees of freedom, which we discuss later. The important part, the <span class="math inline">\(t\)</span> value should start to be a little bit more meaningful. We got a kind of small t-value didn’t we. It’s .72. What can we tell from this value? First, it is positive, so we know the mean difference is positive. The sign of the <span class="math inline">\(t\)</span>-value is always the same as the sign of the mean difference (ours was +0.054). We can also see that the p-value was .509. We’ve seen p-values before. This tells us that our <span class="math inline">\(t\)</span> value or larger, occurs about 50.9% of the time… Actually it means more than this. And, to understand it, we need to talk about the concept of two-tailed and one-tailed tests.</p>
</section>
<section id="interpreting-ts" class="level3">
<h3 class="anchored" data-anchor-id="interpreting-ts">Interpreting <span class="math inline">\(t\)</span>s</h3>
<p>Remember what it is we are doing here. We are evaluating whether our sample data could have come from a particular kind of distribution. The null distribution of no differences. This is the distribution of <span class="math inline">\(t\)</span>-values that would occur for samples of size 5, with a mean difference of 0, and a standard error of the sample mean of .075 (this is the SEM that we calculated from our sample). We can see what this particular null-distribution looks like in <a href="#fig-6tnull" class="quarto-xref">Figure&nbsp;5</a>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, .<span class="dv">1</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> <span class="fu">dt</span>(range, <span class="dv">4</span>, <span class="at">log =</span> <span class="cn">FALSE</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(range, null_distribution)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> range, <span class="at">y =</span> null_distribution)) <span class="sc">+</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t-values"</span>) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> (<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, .<span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="sc">-</span>.<span class="dv">7</span>, <span class="at">y =</span> .<span class="dv">1</span>, <span class="at">label =</span> <span class="st">"50% </span><span class="sc">\n</span><span class="st"> (-)"</span>),</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> .<span class="dv">7</span>, <span class="at">y =</span> .<span class="dv">1</span>, <span class="at">label =</span> <span class="st">"50% </span><span class="sc">\n</span><span class="st"> (+)"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6tnull" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6tnull-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6tnull-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6tnull-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: A distribution of <span class="math inline">\(t\)</span>-values that can occur by chance alone, when there is no difference between the sample and a population
</figcaption>
</figure>
</div>
</div>
</div>
<p>The <span class="math inline">\(t\)</span>-distribution above shows us the kinds of values <span class="math inline">\(t\)</span> will will take by chance alone, when we measure the mean differences for pairs of 5 samples (like our current). <span class="math inline">\(t\)</span> is most likely to be zero, which is good, because we are looking at the distribution of no-differences, which should most often be 0! But, sometimes, due to sampling error, we can get <span class="math inline">\(t\)</span>s that are bigger than 0, either in the positive or negative direction. Notice the distribution is symmetrical, a <span class="math inline">\(t\)</span> from the null-distribution will be positive half of the time, and negative half of the time, that is what we would expect by chance.</p>
<p>So, what kind of information do we want know when we find a particular <span class="math inline">\(t\)</span> value from our sample? We want to know how likely the <span class="math inline">\(t\)</span> value like the one we found occurs just by chance. This is actually a subtly nuanced kind of question. For example, any particular <span class="math inline">\(t\)</span> value doesn’t have a specific probability of occurring. When we talk about probabilities, we are talking about ranges of probabilities. Let’s consider some probabilities. We will use the letter <span class="math inline">\(p\)</span>, to talk about the probabilities of particular <span class="math inline">\(t\)</span> values.</p>
<ol type="1">
<li><p>What is the probability that <span class="math inline">\(t\)</span> is zero or positive or negative? The answer is p=1, or 100%. We will always have a <span class="math inline">\(t\)</span> value that is zero or non-zero…Actually, if we can’t compute the t-value, for example when the standard deviation is undefined, I guess then we would have a non-number. But, assuming we can calculate <span class="math inline">\(t\)</span>, then it will always be 0 or positive or negative.</p></li>
<li><p>What is the probability of <span class="math inline">\(t\)</span> = 0 or greater than 0? The answer is p=.5, or 50%. 50% of <span class="math inline">\(t\)</span>-values are 0 or greater.</p></li>
<li><p>What is the of <span class="math inline">\(t\)</span> = 0 or smaller than 0? The answer is p=.5, or 50%. 50% of <span class="math inline">\(t\)</span>-values are 0 or smaller.</p></li>
</ol>
<p>We can answer all of those questions just by looking at our t-distribution, and dividing it into two equal regions, the left side (containing 50% of the <span class="math inline">\(t\)</span> values), and the right side containing 50% of the <span class="math inline">\(t\)</span>-values).</p>
<p>What if we wanted to take a more fine-grained approach, let’s say we were interested in regions of 10%. What kinds of <span class="math inline">\(t\)</span>s occur 10% of the time. We would apply lines like the following. Notice, the likelihood of bigger numbers (positive or negative) gets smaller, so we have to increase the width of the bars for each of the intervals between the bars to contain 10% of the <span class="math inline">\(t\)</span>-values, it looks like <a href="#fig-6percentregions" class="quarto-xref">Figure&nbsp;6</a>.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, .<span class="dv">1</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> <span class="fu">dt</span>(range, <span class="dv">4</span>, <span class="at">log =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(range, null_distribution)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>t_ps <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), <span class="dv">4</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> range, <span class="at">y =</span> null_distribution)) <span class="sc">+</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t-values"</span>) <span class="sc">+</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> t_ps) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">round</span>(t_ps, <span class="at">digits =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">2.5</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"10%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">1.3</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"10%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"10%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fl">1.3</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"10%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6percentregions" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6percentregions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6percentregions-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6percentregions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Splitting the t distribution up into regions each containing 10% of the <span class="math inline">\(t\)</span>-values. The width between the bars narrows as they approach the center of the distribution, where there are more <span class="math inline">\(t\)</span>-values.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Consider the probabilities (<span class="math inline">\(p\)</span>) of <span class="math inline">\(t\)</span> for the different ranges.</p>
<ol type="1">
<li><span class="math inline">\(t\)</span> &lt;= -1.5 (<span class="math inline">\(t\)</span> is less than or equal to -1.5), <span class="math inline">\(p\)</span> = 10%</li>
<li>-1.5 &gt;= <span class="math inline">\(t\)</span> &lt;= -0.9 (<span class="math inline">\(t\)</span> is equal to or between -1.5 and -.9), <span class="math inline">\(p\)</span> = 10%</li>
<li>-.9 &gt;= <span class="math inline">\(t\)</span> &lt;= -0.6 (<span class="math inline">\(t\)</span> is equal to or between -.9 and -.6), <span class="math inline">\(p\)</span> = 10%</li>
<li><span class="math inline">\(t\)</span> &gt;= 1.5 (<span class="math inline">\(t\)</span> is greater than or equal to 1.5), <span class="math inline">\(p\)</span> = 10%</li>
</ol>
<p>Notice, that the <span class="math inline">\(p\)</span>s are always 10%. <span class="math inline">\(t\)</span>s occur in these ranges with 10% probability.</p>
</section>
<section id="getting-the-p-values-for-t-values" class="level3">
<h3 class="anchored" data-anchor-id="getting-the-p-values-for-t-values">Getting the p-values for <span class="math inline">\(t\)</span>-values</h3>
<p>You might be wondering where I am getting some of these values from. For example, how do I know that 10% of <span class="math inline">\(t\)</span> values (for this null distribution) have a value of approximately 1.5 or greater than 1.5? The answer is I used R to tell me.</p>
<p>In most statistics textbooks the answer would be: there is a table at the back of the book where you can look these things up…This textbook has no such table. We could make one for you. And, we might do that. But, we didn’t do that yet…</p>
<p>So, where do these values come from, how can you figure out what they are? The complicated answer is that we are not going to explain the math behind finding these values because, 1) the authors (some of us) admittedly don’t know the math well enough to explain it, and 2) it would sidetrack us to much, 3) you will learn how to get these numbers in the lab with software, 4) you will learn how to get these numbers in lab without the math, just by doing a simulation, and 5) you can do it in R, or excel, or you can use an <a href="http://www.socscistatistics.com/pvalues/tdistribution.aspx">online calculator</a>.</p>
<p>This is all to say that you can find the <span class="math inline">\(t\)</span>s and their associated <span class="math inline">\(p\)</span>s using software. But, the software won’t tell you what these values mean. That’s we are doing here. You will also see that software wants to know a few more things from you, such as the degrees of freedom for the test, and whether the test is one-tailed or two tailed. We haven’t explained any of these things yet. That’s what we are going to do now. Note, we explain degrees of freedom last. First, we start with a one-tailed test.</p>
</section>
<section id="one-tailed-tests" class="level3">
<h3 class="anchored" data-anchor-id="one-tailed-tests">One-tailed tests</h3>
<p>A <strong>one-tailed test</strong> is sometimes also called a directional test. It is called a directional test, because a researcher might have a hypothesis in mind suggesting that the difference they observe in their means is going to have a particular direction, either a positive difference, or a negative difference.</p>
<p>Typically, a researcher would set an <strong>alpha criterion</strong>. The alpha criterion describes a line in the sand for the researcher. Often, the alpha criterion is set at <span class="math inline">\(p = .05\)</span>. What does this mean? <a href="#fig-6critT" class="quarto-xref">Figure&nbsp;7</a> shows the <span class="math inline">\(t\)</span>-distribution and the alpha criterion.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, .<span class="dv">1</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> <span class="fu">dt</span>(range, <span class="dv">4</span>, <span class="at">log =</span> <span class="cn">FALSE</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(range, null_distribution)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>t_ps <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), <span class="dv">4</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> range, <span class="at">y =</span> null_distribution)) <span class="sc">+</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t-values"</span>) <span class="sc">+</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Critical t for one-tailed test"</span>) <span class="sc">+</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="dv">3</span>,</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"green"</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"5%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">3</span>,</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Critical t"</span></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span>)</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6critT" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6critT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6critT-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6critT-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: The critical value of t for an alpha criterion of 0.05. 5% of all ts are at this value or larger
</figcaption>
</figure>
</div>
</div>
</div>
<p>The figure shows that <span class="math inline">\(t\)</span> values of +2.13 or greater occur 5% of the time. Because the t-distribution is symmetrical, we also know that <span class="math inline">\(t\)</span> values of -2.13 or smaller also occur 5% of the time. Both of these properties are true under the null distribution of no differences. This means, that when there really are no differences, a researcher can expect to find <span class="math inline">\(t\)</span> values of 2.13 or larger 5% of the time.</p>
<p>Let’s review and connect some of the terms:</p>
<ol type="1">
<li><p><strong>alpha criterion</strong>: the criterion set by the researcher to make decisions about whether they believe chance did or did not cause the difference. The alpha criterion here is set to <span class="math inline">\(p = .05\)</span>.</p></li>
<li><p><strong>Critical</strong> <span class="math inline">\(t\)</span>. The critical <span class="math inline">\(t\)</span> is the <span class="math inline">\(t\)</span>-value associated with the alpha-criterion. In this case for a one-tailed test, it is the <span class="math inline">\(t\)</span> value where 5% of all <span class="math inline">\(t\)</span>s are this number or greater. In our example, the critical <span class="math inline">\(t\)</span> is 2.13. 5% of all <span class="math inline">\(t\)</span> values (with degrees of freedom = 4) are +2.13, or greater than +2.13.</p></li>
<li><p><strong>Observed</strong> <span class="math inline">\(t\)</span>. The observed <span class="math inline">\(t\)</span> is the one that you calculated from your sample. In our example about the infants, the observed <span class="math inline">\(t\)</span> was <span class="math inline">\(t\)</span> (4) = 0.72.</p></li>
<li><p><strong>p-value</strong>. The <span class="math inline">\(p\)</span>-value is the probability of obtaining the observed <span class="math inline">\(t\)</span> value or larger. Now, you could look back at our previous example, and find that the <span class="math inline">\(p\)</span>-value for <span class="math inline">\(t\)</span> (4) = .72, was <span class="math inline">\(p = .509\)</span> . HOWEVER, this p-value was not calculated for a one-directional test…(we talk about what .509 means in the next section).</p></li>
</ol>
<p><a href="#fig-6tonedirection" class="quarto-xref">Figure&nbsp;8</a> shows what the <span class="math inline">\(p\)</span>-value for <span class="math inline">\(t\)</span> (4) = .72 using a one-directional test would would look like:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, .<span class="dv">1</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> <span class="fu">dt</span>(range, <span class="dv">4</span>, <span class="at">log =</span> <span class="cn">FALSE</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(range, null_distribution)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>t_ps <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), <span class="dv">4</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> range, <span class="at">y =</span> null_distribution)) <span class="sc">+</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t-values"</span>) <span class="sc">+</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">72</span>) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"t value and p-range for one-directional test"</span>) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> .<span class="dv">72</span>,</span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="dv">3</span>,</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"grey"</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="dv">3</span>,</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> .<span class="dv">25</span>,</span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"green"</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"5%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">3</span>,</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Critical t"</span></span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span></span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span>)</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> .<span class="dv">72</span>, <span class="at">y =</span> .<span class="dv">1</span>,</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> <span class="st">"Observed t"</span>),</span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> .<span class="dv">72</span>, <span class="at">y =</span> .<span class="dv">05</span>,</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> <span class="st">".72, p="</span>),</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">1.5</span>,</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">05</span>,</span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">pt</span>(.<span class="dv">72</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>), <span class="at">digits =</span></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">3</span>)</span>
<span id="cb19-59"><a href="#cb19-59" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb19-60"><a href="#cb19-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6tonedirection" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6tonedirection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6tonedirection-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6tonedirection-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: A case where the observed value of t is much less than the critical value for a one-directional t-test.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Let’s take this one step at a time. We have located the observed <span class="math inline">\(t\)</span> of .72 on the graph. We shaded the right region all grey. What we see is that the grey region represents .256 or 25.6% of all <span class="math inline">\(t\)</span> values. In other words, 25.6% of <span class="math inline">\(t\)</span> values are .72 or larger than .72. You could expect, by chance alone, to a find a <span class="math inline">\(t\)</span> value of .72 or larger, 25.6% of the time. That’s fairly often. We did find a <span class="math inline">\(t\)</span> value of .72. Now that you know this kind of <span class="math inline">\(t\)</span> value or larger occurs 25.6% of the time, would you be confident that the mean difference was not due to chance? Probably not, given that chance can produce this difference fairly often.</p>
<p>Following the “standard” decision making procedure, we would claim that our <span class="math inline">\(t\)</span> value was <strong>not statistically significant</strong>, because it was not large enough. If our observed value was larger than the critical <span class="math inline">\(t\)</span> (larger than 2.13), defined by our alpha criterion, then we would claim that our <span class="math inline">\(t\)</span> value was <strong>statistically significant</strong>. This would be equivalent to saying that we believe it is unlikely that the difference we observed was due to chance. In general, for any observed <span class="math inline">\(t\)</span> value, the associated <span class="math inline">\(p\)</span>-value tells you how likely a <span class="math inline">\(t\)</span> of the observed size or larger would be observed. The <span class="math inline">\(p\)</span>-value <strong>always</strong> refers to a <strong>range</strong> of <span class="math inline">\(t\)</span>-values, never to a single <span class="math inline">\(t\)</span>-value. Researchers use the alpha criterion of .05, as a matter of convenience and convention. There are other ways to interpret these values that do not rely on a strict (significant versus not) dichotomy.</p>
</section>
<section id="two-tailed-tests" class="level3">
<h3 class="anchored" data-anchor-id="two-tailed-tests">Two-tailed tests</h3>
<p>OK, so that was one-tailed tests… What are two tailed tests? The <span class="math inline">\(p\)</span>-value that we originally calculated from our paired-samples <span class="math inline">\(t\)</span>-test was for a 2-tailed test. Often, the default is that the <span class="math inline">\(p\)</span>-value is for a two-tailed test.</p>
<p>The two-tailed test, is asking a more general question about whether a difference is likely to have been produced by chance. The question is: what is probability of any difference. It is also called a <strong>non-directional</strong> test, because here we don’t care about the direction or sign of the difference (positive or negative), we just care if there is any kind of difference.</p>
<p>The same basic things as before are involved. We define an alpha criterion (<span class="math inline">\(\alpha = 0.05\)</span>). And, we say that any observed <span class="math inline">\(t\)</span> value that has a probability of <span class="math inline">\(p\)</span> &lt;.05 (<span class="math inline">\(p\)</span> is less than .05) will be called <strong>statistically significant</strong>, and ones that are more likely (<span class="math inline">\(p\)</span> &gt;.05, <span class="math inline">\(p\)</span> is greater than .05) will be called null-results, or not statistically significant. The only difference is how we draw the alpha range. Before it was on the right side of the <span class="math inline">\(t\)</span> distribution (we were conducting a one-sided test remember, so we were only interested in one side).</p>
<p><a href="#fig-6twotailedt" class="quarto-xref">Figure&nbsp;9</a> shows what the most extreme 5% of the <span class="math inline">\(t\)</span>-values are when we ignore their sign (whether they are positive or negative).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, .<span class="dv">1</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> <span class="fu">dt</span>(range, <span class="dv">4</span>, <span class="at">log =</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(range, null_distribution)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>t_ps <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), <span class="dv">4</span>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> range, <span class="at">y =</span> null_distribution)) <span class="sc">+</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t-values"</span>) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">qt</span>(.<span class="dv">025</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Critical ts for two-tailed test"</span>) <span class="sc">+</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="dv">4</span>,</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"green"</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fl">3.5</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"2.5%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">3</span>,</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Critical t"</span></span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">qt</span>(.<span class="dv">975</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span></span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span>)</span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">qt</span>(.<span class="dv">025</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"green"</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">3.5</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"2.5%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">025</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">3</span>,</span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Critical t"</span></span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">025</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">qt</span>(.<span class="dv">025</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span></span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span>)</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6twotailedt" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6twotailedt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6twotailedt-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6twotailedt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;9: Critical values for a two-tailed test. Each line represents the location where 2.5% of all <span class="math inline">\(t\)</span>s are larger or smaller than critical value. The total for both tails is 5%
</figcaption>
</figure>
</div>
</div>
</div>
<p>Here is what we are seeing. A distribution of no differences (the null, which is what we are looking at), will produce <span class="math inline">\(t\)</span>s that are 2.78 or greater 2.5% of the time, and <span class="math inline">\(t\)</span>s that are -2.78 or smaller 2.5% of the time. 2.5% + 2.5% is a total of 5% of the time. We could also say that <span class="math inline">\(t\)</span>s larger than +/- 2.78 occur 5% of the time.</p>
<p>As a result, the critical <span class="math inline">\(t\)</span> value is (+/-) 2.78 for a two-tailed test. As you can see, the two-tailed test is blind to the direction or sign of the difference. Because of this, the critical <span class="math inline">\(t\)</span> value is also higher for a two-tailed test, than for the one-tailed test that we did earlier. Hopefully, now you can see why it is called a two-tailed test. There are two tails of the distribution, one on the left and right, both shaded in green.</p>
</section>
<section id="one-or-two-tailed-which-one" class="level3">
<h3 class="anchored" data-anchor-id="one-or-two-tailed-which-one">One or two tailed, which one?</h3>
<p>Now that you know there are two kinds of tests, one-tailed, and two-tailed, which one should you use? There is some conventional wisdom on this, but also some debate. In the end, it is up to you to be able to justify your choice and why it is appropriate for you data. That is the real answer.</p>
<p>The conventional answer is that you use a one-tailed test when you have a theory or hypothesis that is making a directional prediction (the theory predicts that the difference will be positive, or negative). Similarly, use a two-tailed test when you are looking for any difference, and you don’t have a theory that makes a directional prediction (it just makes the prediction that there will be a difference, either positive or negative).</p>
<p>Also, people appear to choose one or two-tailed tests based on how risky they are as researchers. If you always ran one-tailed tests, your critical <span class="math inline">\(t\)</span> values for your set alpha criterion would always be smaller than the critical <span class="math inline">\(t\)</span>s for a two-tailed test. Over the long run, you would make more type I errors, because the criterion to detect an effect is a lower bar for one than two tailed tests.</p>
<blockquote class="blockquote">
<p>Remember type 1 errors occur when you reject the idea that chance could have caused your difference. You often never know when you make this error. It happens anytime that sampling error was the actual cause of the difference, but a researcher dismisses that possibility and concludes that their manipulation caused the difference.</p>
</blockquote>
<p>Similarly, if you always ran two-tailed tests, even when you had a directional prediction, you would make fewer type I errors over the long run, because the <span class="math inline">\(t\)</span> for a two-tailed test is higher than the <span class="math inline">\(t\)</span> for a one-tailed test. It seems quite common for researchers to use a more conservative two-tailed test, even when they are making a directional prediction based on theory. In practice, researchers tend to adopt a standard for reporting that is common in their field. Whether or not the practice is justifiable can sometimes be an open question. The important task for any researcher, or student learning statistics, is to be able to justify their choice of test.</p>
</section>
<section id="degrees-of-freedom" class="level3">
<h3 class="anchored" data-anchor-id="degrees-of-freedom">Degrees of freedom</h3>
<p>Before we finish up with paired-samples <span class="math inline">\(t\)</span>-tests, we should talk about degrees of freedom. Our sense is that students don’t really understand degrees of freedom very well. If you are reading this textbook, you are probably still wondering what is degrees of freedom, seeing as we haven’t really talked about it all.</p>
<p>For the <span class="math inline">\(t\)</span>-test, there is a formula for degrees of freedom. For the one-sample and paired sample <span class="math inline">\(t\)</span>-tests, the formula is:</p>
<p><span class="math inline">\(\text{Degrees of Freedom} = \text{df} = n-1\)</span>. Where n is the number of samples in the test.</p>
<p>In our paired <span class="math inline">\(t\)</span>-test example, there were 5 infants. Therefore, degrees of freedom = 5-1 = 4.</p>
<p>OK, that’s a formula. Who cares about degrees of freedom, what does the number mean? And why do we report it when we report a <span class="math inline">\(t\)</span>-test… you’ve probably noticed the number in parentheses e.g., <span class="math inline">\(t\)</span>(4)=.72, the 4 is the <span class="math inline">\(df\)</span>, or degrees of freedom.</p>
<p>Degrees of freedom is both a concept, and a correction. The concept is that if you estimate a property of the numbers, and you use this estimate, you will be forcing some constraints on your numbers.</p>
<p>Consider the numbers: 1, 2, 3. The mean of these numbers is 2. Now, let’s say I told you that the mean of three numbers is 2. Then, how many of these three numbers have freedom? Funny question right. What we mean is, how many of the three numbers could be any number, or have the freedom to be any number.</p>
<p>The first two numbers could be any number. But, once those two numbers are set, the final number (the third number), MUST be a particular number that makes the mean 2. The first two numbers have freedom. The third number has no freedom.</p>
<p>To illustrate. Let’s freely pick two numbers: 51 and -3. I used my personal freedom to pick those two numbers. Now, if our three numbers are 51, -3, and x, and the mean of these three numbers is 2. There is only one solution, x has to be -42, otherwise the mean won’t be 2. This is one way to think about degrees of freedom. The degrees of freedom for these three numbers is n-1 = 3-1= 2, because 2 of the numbers can be free, but the last number has no freedom, it becomes fixed after the first two are decided.</p>
<p>Now, statisticians often apply degrees of freedom to their calculations, especially when a second calculation relies on an estimated value. For example, when we calculate the standard deviation of a sample, we first calculate the mean of the sample right! By estimating the mean, we are fixing an aspect of our sample, and so, our sample now has n-1 degrees of freedom when we calculate the standard deviation (remember for the sample standard deviation, we divide by n-1…there’s that n-1 again.)</p>
<section id="simulating-how-degrees-of-freedom-affects-the-t-distribution" class="level4">
<h4 class="anchored" data-anchor-id="simulating-how-degrees-of-freedom-affects-the-t-distribution">Simulating how degrees of freedom affects the <span class="math inline">\(t\)</span> distribution</h4>
<p>There are at least two ways to think the degrees of freedom for a <span class="math inline">\(t\)</span>-test. For example, if you want to use math to compute aspects of the <span class="math inline">\(t\)</span> distribution, then you need the degrees of freedom to plug in to the formula… If you want to see the formulas I’m talking about, scroll down on the <a href="https://en.wikipedia.org/wiki/Student%27s_t-distribution"><span class="math inline">\(t\)</span>-test wikipedia page</a> and look for the probability density or cumulative distribution functions…We think that is quite scary for most people, and one reason why degrees of freedom are not well-understood.</p>
<p>If we wanted to simulate the <span class="math inline">\(t\)</span> distribution we could more easily see what influence degrees of freedom has on the shape of the distribution. Remember, <span class="math inline">\(t\)</span> is a sample statistic, it is something we measure from the sample. So, we could simulate the process of measuring <span class="math inline">\(t\)</span> from many different samples, then plot the histogram of <span class="math inline">\(t\)</span> to show us the simulated <span class="math inline">\(t\)</span> distribution.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rt</span>(<span class="dv">10000</span>, <span class="dv">4</span>), <span class="fu">rt</span>(<span class="dv">10000</span>, <span class="dv">100</span>))</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>dfs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">100</span>), <span class="at">each =</span> <span class="dv">10000</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(dfs, ts)</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> t_df[<span class="fu">abs</span>(t_df<span class="sc">$</span>ts) <span class="sc">&lt;</span> <span class="dv">5</span>, ]</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(t_df, <span class="fu">aes</span>(<span class="at">x =</span> ts, <span class="at">group =</span> dfs, <span class="at">color =</span> dfs)) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> dfs) <span class="sc">+</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">15</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6dft" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6dft-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6dft-1.png" class="img-fluid figure-img" style="width:100.0%">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6dft-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;10: The width of the t distribution shrinks as sample size and degrees of freedom (from 4 to 100) increases.
</figcaption>
</figure>
</div>
</div>
</div>
<p>In <a href="#fig-6dft" class="quarto-xref">Figure&nbsp;10</a> notice that the red distribution for <span class="math inline">\(df = 4\)</span>, is a little bit shorter, and a little bit wider than the bluey-green distribution for <span class="math inline">\(df = 100\)</span>. As degrees of freedom increase the <span class="math inline">\(t\)</span> distribution gets taller (in the middle), and narrower in the range. It get’s more peaky. Can you guess the reason for this? Remember, we are estimating a sample statistic, and degrees of freedom is really just a number that refers to the number of subjects (well minus one). And, we already know that as we increase <span class="math inline">\(n\)</span>, our sample statistics become better estimates (less variance) of the distributional parameters they are estimating. So, <span class="math inline">\(t\)</span> becomes a better estimate of it’s “true” value as sample size increase, resulting in a more narrow distribution of <span class="math inline">\(t\)</span>s.</p>
<p>There is a slightly different <span class="math inline">\(t\)</span> distribution for every degrees of freedom, and the critical regions associated with 5% of the extreme values are thus slightly different every time. This is why we report the degrees of freedom for each t-test, they define the distribution of <span class="math inline">\(t\)</span> values for the sample-size in question. Why do we use n-1 and not n? Well, we calculate <span class="math inline">\(t\)</span> using the sample standard deviation to estimate the standard error or the mean, that estimate uses n-1 in the denominator, so our <span class="math inline">\(t\)</span> distribution is built assuming n-1. That’s enough for degrees of freedom…</p>
</section>
</section>
</section>
<section id="the-paired-samples-t-test-strikes-back" class="level2">
<h2 class="anchored" data-anchor-id="the-paired-samples-t-test-strikes-back">The paired samples t-test strikes back</h2>
<p>You must be wondering if we will ever be finished talking about paired samples t-tests… why are we doing round 2, oh no! Don’t worry, we’re just going to 1) remind you about what we were doing with the infant study, and 2) do a paired samples t-test on the entire data set and discuss.</p>
<p>Remember, we were wondering if the infants would look longer toward the singer who sang the familiar song during the test phase compared to the baseline phase. We showed you data from 5 infants, and walked through the computations for the <span class="math inline">\(t\)</span>-test. As a reminder, it looked like this:</p>
<div class="cell">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 10%">
<col style="width: 12%">
<col style="width: 8%">
<col style="width: 17%">
<col style="width: 21%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">infant</th>
<th style="text-align: left;">Baseline</th>
<th style="text-align: left;">Test</th>
<th style="text-align: left;">differences</th>
<th style="text-align: left;">diff_from_mean</th>
<th style="text-align: left;">Squared_differences</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">0.44</td>
<td style="text-align: left;">0.6</td>
<td style="text-align: left;">0.16</td>
<td style="text-align: left;">0.106</td>
<td style="text-align: left;">0.011236</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">0.41</td>
<td style="text-align: left;">0.68</td>
<td style="text-align: left;">0.27</td>
<td style="text-align: left;">0.216</td>
<td style="text-align: left;">0.046656</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">0.75</td>
<td style="text-align: left;">0.72</td>
<td style="text-align: left;">-0.03</td>
<td style="text-align: left;">-0.084</td>
<td style="text-align: left;">0.00705600000000001</td>
</tr>
<tr class="even">
<td style="text-align: left;">4</td>
<td style="text-align: left;">0.44</td>
<td style="text-align: left;">0.28</td>
<td style="text-align: left;">-0.16</td>
<td style="text-align: left;">-0.214</td>
<td style="text-align: left;">0.045796</td>
</tr>
<tr class="odd">
<td style="text-align: left;">5</td>
<td style="text-align: left;">0.47</td>
<td style="text-align: left;">0.5</td>
<td style="text-align: left;">0.03</td>
<td style="text-align: left;">-0.024</td>
<td style="text-align: left;">0.000575999999999999</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sums</td>
<td style="text-align: left;">2.51</td>
<td style="text-align: left;">2.78</td>
<td style="text-align: left;">0.27</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0.11132</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Means</td>
<td style="text-align: left;">0.502</td>
<td style="text-align: left;">0.556</td>
<td style="text-align: left;">0.054</td>
<td style="text-align: left;">0</td>
<td style="text-align: left;">0.022264</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">sd</td>
<td style="text-align: left;">0.167</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">SEM</td>
<td style="text-align: left;">0.075</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: left;">t</td>
<td style="text-align: left;">0.72</td>
</tr>
</tbody>
</table>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  round(differences, digits = 2)
t = 0.72381, df = 4, p-value = 0.5092
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.1531384  0.2611384
sample estimates:
mean of x 
    0.054 </code></pre>
</div>
</div>
<p>Let’s write down the finding one more time: The mean difference was 0.054, <span class="math inline">\(t\)</span>(4) = .72, <span class="math inline">\(p\)</span> =.509. We can also now confirm, that the <span class="math inline">\(p\)</span>-value was from a two-tailed test. So, what does this all really mean.</p>
<p>We can say that a <span class="math inline">\(t\)</span> value with an absolute of .72 or larger occurs 50.9% of the time. More precisely, the distribution of no differences (the null), will produce a <span class="math inline">\(t\)</span> value this large or larger 50.9% of the time. In other words, chance alone good have easily produced the <span class="math inline">\(t\)</span> value from our sample, and the mean difference we observed or .054, could easily have been a result of chance.</p>
<p>Let’s quickly put all of the data in the <span class="math inline">\(t\)</span>-test, and re-run the test using all of the infant subjects.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>paired_sample_df <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">infant=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>, </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Baseline =</span> <span class="fu">round</span>(experiment_one<span class="sc">$</span>Baseline_Proportion_Gaze_to_Singer[<span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>],<span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Test =</span> <span class="fu">round</span>(experiment_one<span class="sc">$</span>Test_Proportion_Gaze_to_Singer[<span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>], <span class="at">digits=</span><span class="dv">2</span>))</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>differences <span class="ot">&lt;-</span>  paired_sample_df<span class="sc">$</span>Test<span class="sc">-</span>paired_sample_df<span class="sc">$</span>Baseline</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(differences,<span class="at">mu=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  differences
t = 2.4388, df = 31, p-value = 0.02066
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 0.01192088 0.13370412
sample estimates:
mean of x 
0.0728125 </code></pre>
</div>
</div>
<p>Now we get a very different answer. We would summarize the results saying the mean difference was .073, t(31) = 2.44, p = 0.020. How many total infants were their? Well the degrees of freedom was 31, so there must have been 32 infants in the study. Now we see a much smaller <span class="math inline">\(p\)</span>-value. This was also a two-tailed test, so we that observing a <span class="math inline">\(t\)</span> value of 2.4 or greater (absolute value) only occurs 2% of the time. In other words, the distribution of no differences will produce the observed t-value very rarely. So, it is unlikely that the observed mean difference of .073 was due to chance (it could have been due to chance, but that is very unlikely). As a result, we can be somewhat confident in concluding that something about seeing and hearing a unfamiliar person sing a familiar song, causes an infant to draw their attention toward the singer, and this potentially benefits social learning on the part of the infant.</p>
</section>
<section id="independent-samples-t-test-the-return-of-the-t-test" class="level2">
<h2 class="anchored" data-anchor-id="independent-samples-t-test-the-return-of-the-t-test">Independent samples t-test: The return of the t-test?</h2>
<p>If you’ve been following the Star Wars references, we are on last movie (of the original trilogy)… the independent t-test. This is were basically the same story plays out as before, only slightly different.</p>
<p>Remember there are different <span class="math inline">\(t\)</span>-tests for different kinds of research designs. When your design is a <strong>between-subjects</strong> design, you use an <strong>independent samples t-test</strong>. Between-subjects design involve different people or subjects in each experimental condition. If there are two conditions, and 10 people in each, then there are 20 total people. And, there are no paired scores, because every single person is measured once, not twice, no repeated measures. Because there are no repeated measures we can’t look at the difference scores between conditions one and two. The scores are not paired in any meaningful way, to it doesn’t make sense to subtract them. So what do we do?</p>
<p>The logic of the independent samples t-test is the very same as the other <span class="math inline">\(t\)</span>-tests. We calculated the means for each group, then we find the difference. That goes into the numerator of the t formula. Then we get an estimate of the variation for the denominator. We divide the mean difference by the estimate of the variation, and we get <span class="math inline">\(t\)</span>. It’s the same as before.</p>
<p>The only wrinkle here is what goes into the denominator? How should we calculate the estimate of the variance? It would be nice if we could do something very straightforward like this, say for an experiment with two groups A and B:</p>
<p><span class="math inline">\(t = \frac{\bar{A}-\bar{B}}{(\frac{SEM_A+SEM_B}{2})}\)</span></p>
<p>In plain language, this is just:</p>
<ol type="1">
<li>Find the mean difference for the top part</li>
<li>Compute the SEM (standard error of the mean) for each group, and average them together to make a single estimate, pooling over both samples.</li>
</ol>
<p>This would be nice, but unfortunately, it turns out that finding the average of two standard errors of the mean is not the best way to do it. This would create a biased estimator of the variation for the hypothesized distribution of no differences. We won’t go into the math here, but instead of the above formula, we an use a different one that gives as an <strong>unbiased estimate of the pooled standard error of the sample mean</strong>. Our new and improved <span class="math inline">\(t\)</span> formula would look like this:</p>
<p><span class="math inline">\(t = \frac{\bar{X_A}-\bar{X_B}}{s_p * \sqrt{\frac{1}{n_A} + \frac{1}{n_B}}}\)</span></p>
<p>and, <span class="math inline">\(s_p\)</span>, which is the pooled sample standard deviation is defined as, note the $s$es in the formula are variances:</p>
<p><span class="math inline">\(s_p = \sqrt{\frac{(n_A-1)s_A^2 + (n_B-1)s^2_B}{n_A +n_B -2}}\)</span></p>
<p>Believe you me, that is so much more formula than I wanted to type out. Shall we do one independent <span class="math inline">\(t\)</span>-test example by hand, just to see the computations? Let’s do it…but in a slightly different way than you expect. I show the steps using R. I made some fake scores for groups A and B. Then, I followed all of the steps from the formula, but made R do each of the calculations. This shows you the needed steps by following the code. At the end, I print the <span class="math inline">\(t\)</span>-test values I computed “by hand”, and then the <span class="math inline">\(t\)</span>-test value that the R software outputs using the <span class="math inline">\(t\)</span>-test function. You should be able to get the same values for <span class="math inline">\(t\)</span>, if you were brave enough to compute <span class="math inline">\(t\)</span> by hand.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="do">## By "hand" using R r code</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">4</span>,<span class="dv">7</span>,<span class="dv">9</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>mean_difference <span class="ot">&lt;-</span> <span class="fu">mean</span>(a)<span class="sc">-</span><span class="fu">mean</span>(b) <span class="co"># compute mean difference</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>variance_a <span class="ot">&lt;-</span> <span class="fu">var</span>(a) <span class="co"># compute variance for A</span></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>variance_b <span class="ot">&lt;-</span> <span class="fu">var</span>(b) <span class="co"># compute variance for B</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute top part and bottom part of sp formula</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>sp_numerator <span class="ot">&lt;-</span> (<span class="dv">4</span><span class="sc">*</span>variance_a <span class="sc">+</span> <span class="dv">4</span><span class="sc">*</span> variance_b) </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>sp_denominator <span class="ot">&lt;-</span> <span class="dv">5</span><span class="sc">+</span><span class="dv">5-2</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>sp <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sp_numerator<span class="sc">/</span>sp_denominator) <span class="co"># compute sp</span></span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a><span class="co"># compute t following formulat</span></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> mean_difference <span class="sc">/</span> ( sp <span class="sc">*</span> <span class="fu">sqrt</span>( (<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) <span class="sc">+</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">5</span>) ) )</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>t <span class="co"># print results</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -2.017991</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using the R function t.test</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(a,b, <span class="at">paired=</span><span class="cn">FALSE</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  a and b
t = -2.018, df = 8, p-value = 0.0783
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -5.5710785  0.3710785
sample estimates:
mean of x mean of y 
      3.0       5.6 </code></pre>
</div>
</div>
</section>
<section id="simulating-data-for-t-tests" class="level2">
<h2 class="anchored" data-anchor-id="simulating-data-for-t-tests">Simulating data for t-tests</h2>
<p>An “advanced” topic for <span class="math inline">\(t\)</span>-tests is the idea of using R to conduct simulations for <span class="math inline">\(t\)</span>-tests.</p>
<p>If you recall, <span class="math inline">\(t\)</span> is a property of a sample. We calculate <span class="math inline">\(t\)</span> from our sample. The <span class="math inline">\(t\)</span> distribution is the hypothetical behavior of our sample. That is, if we had taken thousands upon thousands of samples, and calculated <span class="math inline">\(t\)</span> for each one, and then looked at the distribution of those <span class="math inline">\(t\)</span>’s, we would have the sampling distribution of <span class="math inline">\(t\)</span>!</p>
<p>It can be very useful to get in the habit of using R to simulate data under certain conditions, to see how your sample data, and things like <span class="math inline">\(t\)</span> behave. Why is this useful? It mainly prepares you with some intuitions about how sampling error (random chance) can influence your results, given specific parameters of your design, such as sample-size, the size of the mean difference you expect to find in your data, and the amount of variation you might find. These methods can be used formally to conduct power-analyses. Or more informally for data sense.</p>
<section id="simulating-a-one-sample-t-test" class="level3">
<h3 class="anchored" data-anchor-id="simulating-a-one-sample-t-test">Simulating a one-sample t-test</h3>
<p>Here are the steps you might follow to simulate data for a one sample <span class="math inline">\(t\)</span>-test.</p>
<ol type="1">
<li><p>Make some assumptions about what your sample (that you might be planning to collect) might look like. For example, you might be planning to collect 30 subjects worth of data. The scores of those data points might come from a normal distribution (mean = 50, sd = 10).</p></li>
<li><p>sample simulated numbers from the distribution, then conduct a <span class="math inline">\(t\)</span>-test on the simulated numbers. Save the statistics you want (such as <span class="math inline">\(t\)</span>s and <span class="math inline">\(p\)</span>s), and then see how things behave.</p></li>
</ol>
<p>Let’s do this a couple different times. First, let’s simulate samples with N = 30, taken from a normal (mean= 50, sd = 25). We’ll do a simulation with 1000 simulations. For each simulation, we will compare the sample mean with a population mean of 50. There should be no difference on average here. <a href="#fig-6nullt" class="quarto-xref">Figure&nbsp;11</a> is the null distribution that we are simulating.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># steps to create fake data from a distribution</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="co"># and conduct t-tests on the simulated data</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>save_ps <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>save_ts <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  my_sample <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">25</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span> (my_sample, <span class="at">mu =</span> <span class="dv">50</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>  save_ps[i] <span class="ot">&lt;-</span> t_test<span class="sc">$</span>p.value</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>  save_ts[i] <span class="ot">&lt;-</span> t_test<span class="sc">$</span>statistic</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot histograms of t and p values for 1000 simulations</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6nullt" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6nullt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6nullt-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6nullt-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11: The distribution of <span class="math inline">\(t\)</span>-values under the null. These are the <span class="math inline">\(t\)</span> values that are produced by chance alone.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6flatp" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6flatp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6flatp-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6flatp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;12: The distribution of <span class="math inline">\(p\)</span>-values that are observed is flat under the null.
</figcaption>
</figure>
</div>
</div>
</div>
<p>Neat. We see both a <span class="math inline">\(t\)</span> distribution, that looks like <span class="math inline">\(t\)</span> distribution as it should. And we see the <span class="math inline">\(p\)</span> distribution. This shows us how often we get <span class="math inline">\(t\)</span> values of particular sizes. You may find it interesting that the <span class="math inline">\(p\)</span>-distribution is flat under the null, which we are simulating here. This means that you have the same chances of a getting a <span class="math inline">\(t\)</span> with a p-value between 0 and 0.05, as you would for getting a <span class="math inline">\(t\)</span> with a p-value between .90 and .95. Those ranges are both ranges of 5%, so there are an equal amount of <span class="math inline">\(t\)</span> values in them by definition.</p>
<p>Here’s another way to do the same simulation in R, using the replicate function, instead a for loop:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>simulated_ts <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">t.test</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">25</span>), <span class="at">mu =</span> <span class="dv">50</span>)<span class="sc">$</span>statistic)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(simulated_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6simtsRep" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6simtsRep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6simtsRep-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6simtsRep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;13: Simulating <span class="math inline">\(t\)</span>s in R.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>simulated_ps <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">t.test</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">25</span>), <span class="at">mu =</span> <span class="dv">50</span>)<span class="sc">$</span>p.value)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(simulated_ps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6simpsRep" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6simpsRep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6simpsRep-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6simpsRep-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14: Simulating <span class="math inline">\(p\)</span>s in R.
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="simulating-a-paired-samples-t-test" class="level3">
<h3 class="anchored" data-anchor-id="simulating-a-paired-samples-t-test">Simulating a paired samples t-test</h3>
<p>The code below is set up to sample 10 scores for condition A and B from the same normal distribution. The simulation is conducted 1000 times, and the <span class="math inline">\(t\)</span>s and <span class="math inline">\(p\)</span>s are saved and plotted for each.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>save_ps <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>save_ts <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span> ){</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  condition_A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  condition_B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  differences <span class="ot">&lt;-</span> condition_A <span class="sc">-</span> condition_B</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>  t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(differences, <span class="at">mu=</span><span class="dv">0</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  save_ps[i] <span class="ot">&lt;-</span> t_test<span class="sc">$</span>p.value</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  save_ts[i] <span class="ot">&lt;-</span> t_test<span class="sc">$</span>statistic</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6simps1000" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6simps1000-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6simps1000-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6simps1000-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;15: 1000 simulated ts from the null distribution
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6simts1000" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6simts1000-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6simts1000-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6simts1000-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;16: 1000 simulated ps from the null distribution
</figcaption>
</figure>
</div>
</div>
</div>
<p>According to the simulation. When there are no differences between the conditions, and the samples are being pulled from the very same distribution, you get these two distributions for <span class="math inline">\(t\)</span> and <span class="math inline">\(p\)</span>. These again show how the null distribution of no differences behaves.</p>
<p>For any of these simulations, if you rejected the null-hypothesis (that your difference was only due to chance), you would be making a type I error. If you set your alpha criteria to <span class="math inline">\(\alpha = .05\)</span>, we can ask how many type I errors were made in these 1000 simulations. The answer is:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(save_ps[save_ps<span class="sc">&lt;</span>.<span class="dv">05</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 53</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(save_ps[save_ps<span class="sc">&lt;</span>.<span class="dv">05</span>])<span class="sc">/</span><span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.053</code></pre>
</div>
</div>
<p>We happened to make 53. The expectation over the long run is 5% type I error rates (if your alpha is .05).</p>
<p>What happens if there actually is a difference in the simulated data, let’s set one condition to have a larger mean than the other:</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>save_ps <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>save_ts <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span> ){</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  condition_A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  condition_B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">13</span>,<span class="dv">5</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  differences <span class="ot">&lt;-</span> condition_A <span class="sc">-</span> condition_B</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(differences, <span class="at">mu=</span><span class="dv">0</span>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>  save_ps[i] <span class="ot">&lt;-</span> t_test<span class="sc">$</span>p.value</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>  save_ts[i] <span class="ot">&lt;-</span> t_test<span class="sc">$</span>statistic</span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6simtruets" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6simtruets-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6simtruets-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6simtruets-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;17: 1000 ts when there is a true difference
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6simtrueps" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6simtrueps-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6simtrueps-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6simtrueps-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;18: 1000 ps when there is a true difference
</figcaption>
</figure>
</div>
</div>
</div>
<p>Now you can see that the <span class="math inline">\(p\)</span>-value distribution is skewed to the left. This is because when there is a true effect, you will get p-values that are less than .05 more often. Or, rather, you get larger <span class="math inline">\(t\)</span> values than you normally would if there were no differences.</p>
<p>In this case, we wouldn’t be making a type I error if we rejected the null when p was smaller than .05. How many times would we do that out of our 1000 experiments?</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(save_ps[save_ps<span class="sc">&lt;</span>.<span class="dv">05</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 230</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(save_ps[save_ps<span class="sc">&lt;</span>.<span class="dv">05</span>])<span class="sc">/</span><span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.23</code></pre>
</div>
</div>
<p>We happened to get 230 simulations where p was less than .05, that’s only 0.23 experiments. If you were the researcher, would you want to run an experiment that would be successful only 0.23 of the time? I wouldn’t. I would run a better experiment.</p>
<p>How would you run a better simulated experiment? Well, you could increase <span class="math inline">\(n\)</span>, the number of subjects in the experiment. Let’s increase <span class="math inline">\(n\)</span> from 10 to 100, and see what happens to the number of “significant” simulated experiments.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>save_ps <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>save_ts <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span> ){</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  condition_A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>  condition_B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>,<span class="dv">13</span>,<span class="dv">5</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>  differences <span class="ot">&lt;-</span> condition_A <span class="sc">-</span> condition_B</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>  t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(differences, <span class="at">mu=</span><span class="dv">0</span>)</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  save_ps[i] <span class="ot">&lt;-</span> t_test<span class="sc">$</span>p.value</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  save_ts[i] <span class="ot">&lt;-</span> t_test<span class="sc">$</span>statistic</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6simtsB" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6simtsB-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6simtsB-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6simtsB-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;19: 1000 ts for n =100, when there is a true effect
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ps)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(save_ps[save_ps<span class="sc">&lt;</span>.<span class="dv">05</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 990</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(save_ps[save_ps<span class="sc">&lt;</span>.<span class="dv">05</span>])<span class="sc">/</span><span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.99</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-6simpsB" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6simpsB-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6simpsB-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6simpsB-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;20: 1000 ps for n =100, when there is a true effect
</figcaption>
</figure>
</div>
</div>
</div>
<p>Cool, now almost all of the experiments show a <span class="math inline">\(p\)</span>-value of less than .05 (using a two-tailed test, that’s the default in R). See, you could use this simulation process to determine how many subjects you need to reliably find your effect.</p>
</section>
<section id="simulating-an-independent-samples-t.test" class="level3">
<h3 class="anchored" data-anchor-id="simulating-an-independent-samples-t.test">Simulating an independent samples t.test</h3>
<p>Just change the t.test function like so… this is for the null, assuming no difference between groups.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>save_ps <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>save_ts <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> ( i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span> ){</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  group_A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  group_B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>,<span class="dv">10</span>,<span class="dv">5</span>)</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(group_A, group_B, <span class="at">paired=</span><span class="cn">FALSE</span>, <span class="at">var.equal=</span><span class="cn">TRUE</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>  save_ps[i] <span class="ot">&lt;-</span> t_test<span class="sc">$</span>p.value</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>  save_ts[i] <span class="ot">&lt;-</span> t_test<span class="sc">$</span>statistic</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ts)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-6simtsC" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6simtsC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6simtsC-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6simtsC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;21: 1000 ts for n =100, when there is a true effect
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ps)</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(save_ps[save_ps<span class="sc">&lt;</span>.<span class="dv">05</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 45</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(save_ps[save_ps<span class="sc">&lt;</span>.<span class="dv">05</span>])<span class="sc">/</span><span class="dv">1000</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.045</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-6simpsC" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-6simpsC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="chapter_files/figure-html/fig-6simpsC-1.png" class="img-fluid figure-img" width="672">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-6simpsC-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;22: 1000 ps for n =100, when there is a true effect
</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="videos" class="level2">
<h2 class="anchored" data-anchor-id="videos">Videos</h2>
<section id="one-or-two-tailed-tests" class="level3">
<h3 class="anchored" data-anchor-id="one-or-two-tailed-tests">One or Two tailed tests</h3>
<iframe width="560" height="315" src="https://www.youtube.com/embed/PuoGsguuY30" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen="">
</iframe>
<hr>
<p>Gordon Original ## 1. Introduction</p>
<p>The t-test is a fundamental statistical method used in psychology to compare the means of two groups. This chapter will explore the theory behind t-tests, demonstrate practical applications using R, and provide a structured write-up in APA style. Whether you’re examining the effectiveness of a new therapy or comparing cognitive performance between groups, the t-test is an essential tool for psychological research.</p>
</section>
</section>
<section id="main-content" class="level2">
<h2 class="anchored" data-anchor-id="main-content">2. Main Content</h2>
<section id="theory-of-t-tests" class="level3">
<h3 class="anchored" data-anchor-id="theory-of-t-tests">2.1 Theory of T-Tests</h3>
<p>A t-test evaluates whether the means of two groups are statistically different from each other. The most common types are the independent samples t-test, paired samples t-test, and one-sample t-test. Each type tests different hypotheses and has unique assumptions.</p>
<section id="independent-samples-t-test" class="level4">
<h4 class="anchored" data-anchor-id="independent-samples-t-test">2.1.1 Independent Samples T-Test</h4>
<p>This test compares the means of two independent groups to ascertain if there is statistical evidence that the associated population means are significantly different.</p>
</section>
<section id="paired-samples-t-test-1" class="level4">
<h4 class="anchored" data-anchor-id="paired-samples-t-test-1">2.1.2 Paired Samples T-Test</h4>
<p>This test compares means from the same group at different times (e.g., before and after a treatment) or matched pairs.</p>
</section>
<section id="one-sample-t-test" class="level4">
<h4 class="anchored" data-anchor-id="one-sample-t-test">2.1.3 One-Sample T-Test</h4>
<p>This test determines whether the mean of a single group is different from a known mean.</p>
</section>
</section>
<section id="assumptions-of-t-tests" class="level3">
<h3 class="anchored" data-anchor-id="assumptions-of-t-tests">2.2 Assumptions of T-Tests</h3>
<ul>
<li><strong>Independence</strong>: Observations within each group must be independent.</li>
<li><strong>Normality</strong>: Data in each group should be approximately normally distributed.</li>
<li><strong>Homogeneity of Variance</strong>: Variances in the two groups should be roughly equal (for independent samples t-test).</li>
</ul>
</section>
</section>
<section id="methods-and-measures" class="level2">
<h2 class="anchored" data-anchor-id="methods-and-measures">3. Methods and Measures</h2>
<p>To conduct a t-test, you need to: 1. Formulate the null (H0) and alternative (H1) hypotheses. 2. Collect and organize data. 3. Check assumptions. 4. Calculate the t-statistic and degrees of freedom. 5. Determine the p-value. 6. Make a decision to reject or fail to reject H0 based on the p-value.</p>
<section id="example-study" class="level3">
<h3 class="anchored" data-anchor-id="example-study">Example Study</h3>
<p><strong>Research Question</strong>: Does a new cognitive-behavioral therapy (CBT) improve anxiety levels more than a placebo?</p>
<p><strong>Hypotheses</strong>: - H0: There is no difference in anxiety levels between the CBT and placebo groups. - H1: The CBT group has lower anxiety levels than the placebo group.</p>
<p><strong>Measures</strong>: Anxiety levels are measured using a standardized anxiety inventory.</p>
</section>
</section>
<section id="analysis-with-r-code" class="level2">
<h2 class="anchored" data-anchor-id="analysis-with-r-code">4. Analysis with R Code</h2>
<p>Let’s use R for an independent samples t-test.</p>
<section id="data-setup" class="level3">
<h3 class="anchored" data-anchor-id="data-setup">Data Setup</h3>
<div id="qwebr-insertion-location-3"></div>
<noscript>Please enable JavaScript to experience the dynamic code cell content on this page.</noscript>
</section>
<section id="conducting-the-t-test" class="level3">
<h3 class="anchored" data-anchor-id="conducting-the-t-test">Conducting the T-Test</h3>
<div id="qwebr-insertion-location-4"></div>
<noscript>Please enable JavaScript to experience the dynamic code cell content on this page.</noscript>
</section>
<section id="r-output-interpretation" class="level3">
<h3 class="anchored" data-anchor-id="r-output-interpretation">R Output Interpretation</h3>
<p>The <code>t.test</code> function provides the t-statistic, degrees of freedom, and p-value. If the p-value is less than the significance level (e.g., 0.05), we reject H0.</p>
<pre><code>    Welch Two Sample t-test

data:  anxiety by group
t = -8.6943, df = 17.564, p-value = 8.922e-08
alternative hypothesis: true difference in means between group CBT and group Placebo is not equal to 0
95 percent confidence interval:
 -9.936595 -6.063405
sample estimates:
    mean in group CBT mean in group Placebo 
                 21.7                  29.7</code></pre>
</section>
</section>
<section id="debates-and-controversies" class="level2">
<h2 class="anchored" data-anchor-id="debates-and-controversies">5. Debates and Controversies</h2>
<section id="assumption-violations" class="level3">
<h3 class="anchored" data-anchor-id="assumption-violations">5.1 Assumption Violations</h3>
<p>Violating assumptions (e.g., normality, homogeneity of variance) can lead to incorrect conclusions. Robust alternatives or data transformations may be necessary (Wilcox, 2012).</p>
</section>
<section id="p-value-misinterpretation" class="level3">
<h3 class="anchored" data-anchor-id="p-value-misinterpretation">5.2 P-Value Misinterpretation</h3>
<p>Overreliance on p-values can lead to misinterpretation of results. It’s crucial to report effect sizes and confidence intervals (Cumming, 2014).</p>
</section>
<section id="multiple-comparisons" class="level3">
<h3 class="anchored" data-anchor-id="multiple-comparisons">5.3 Multiple Comparisons</h3>
<p>Conducting multiple t-tests increases the risk of Type I errors. Methods like Bonferroni correction adjust for this but can be overly conservative (Perneger, 1998).</p>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">6. Conclusion</h2>
<p>T-tests are a vital statistical method in psychological research for comparing means between groups. Understanding their theory, assumptions, and correct application in R can significantly enhance the rigor of your analyses. Always ensure to check assumptions, consider effect sizes, and be mindful of the limitations and debates surrounding t-tests.</p>
<section id="references" class="level3">
<h3 class="anchored" data-anchor-id="references">References</h3>
<p>Cumming, G. (2014). The new statistics: Why and how. <em>Psychological Science</em>, 25(1), 7-29.</p>
<p>Perneger, T. V. (1998). What’s wrong with Bonferroni adjustments. <em>BMJ</em>, 316(7139), 1236-1238.</p>
<p>Wilcox, R. R. (2012). Modern statistics for the social and behavioral sciences: A practical introduction. <em>CRC Press</em>.</p>
<p>This chapter provides a comprehensive overview of conducting t-tests in R, essential for first-year psychology students. Future chapters will delve into more advanced statistical methods to further enhance your analytical skills.</p>
</section>
</section>
</section>
<section id="glossary" class="level1">
<h1>Glossary</h1>
<p>Certainly! Here’s a glossary of key terms related to ‘T-Tests in R with theory, practicals, and write-up in Psychology APA-style’:</p>
<ol type="1">
<li><strong>T-Test</strong>
<ul>
<li><strong>Definition</strong>: A statistical test used to determine if there is a significant difference between the means of two groups. It is commonly used in hypothesis testing.</li>
</ul></li>
<li><strong>Independent Samples T-Test</strong>
<ul>
<li><strong>Definition</strong>: A type of t-test used when comparing the means of two independent groups to see if there is a significant difference between them.</li>
</ul></li>
<li><strong>Paired Samples T-Test</strong>
<ul>
<li><strong>Definition</strong>: A t-test used when comparing the means of two related groups, such as measurements taken from the same subjects at two different times.</li>
</ul></li>
<li><strong>Null Hypothesis (H0)</strong>
<ul>
<li><strong>Definition</strong>: A hypothesis that there is no significant difference between specified populations, any observed difference being due to sampling or experimental error.</li>
</ul></li>
<li><strong>Alternative Hypothesis (H1)</strong>
<ul>
<li><strong>Definition</strong>: A hypothesis that states there is a significant difference between specified populations, contrary to the null hypothesis.</li>
</ul></li>
<li><strong>P-Value</strong>
<ul>
<li><strong>Definition</strong>: The probability that the observed results occurred by chance. A p-value less than 0.05 is typically considered statistically significant.</li>
</ul></li>
<li><strong>Degrees of Freedom (df)</strong>
<ul>
<li><strong>Definition</strong>: The number of values in a calculation that are free to vary. In t-tests, degrees of freedom are used to determine the critical value from the t-distribution.</li>
</ul></li>
<li><strong>Effect Size</strong>
<ul>
<li><strong>Definition</strong>: A measure of the magnitude of the difference between groups. Common effect size metrics include Cohen’s d.</li>
</ul></li>
<li><strong>R Programming Language</strong>
<ul>
<li><strong>Definition</strong>: A programming language and environment commonly used for statistical computing and graphics, including performing t-tests.</li>
</ul></li>
<li><strong>Psychology APA-Style</strong>
<ul>
<li><strong>Definition</strong>: The writing and citation style prescribed by the American Psychological Association, commonly used in psychology for structuring research papers and reports.</li>
</ul></li>
<li><strong>Mean (M or μ)</strong>
<ul>
<li><strong>Definition</strong>: The average of a set of numbers, calculated by summing them up and dividing by the count of numbers.</li>
</ul></li>
<li><strong>Standard Deviation (SD or σ)</strong>
<ul>
<li><strong>Definition</strong>: A measure of the amount of variation or dispersion in a set of values.</li>
</ul></li>
<li><strong>Confidence Interval (CI)</strong>
<ul>
<li><strong>Definition</strong>: A range of values derived from the sample data that is likely to contain the population parameter with a specified level of confidence, usually 95%.</li>
</ul></li>
<li><strong>T-Distribution</strong>
<ul>
<li><strong>Definition</strong>: A type of probability distribution that is symmetric and bell-shaped but has heavier tails than the normal distribution. It is used in t-tests, especially when sample sizes are small.</li>
</ul></li>
<li><strong>Data Frame</strong>
<ul>
<li><strong>Definition</strong>: A table or two-dimensional array-like structure in R, where each column contains values of one variable and each row contains one set of values from each column.</li>
</ul></li>
</ol>
<p>These terms will help students grasp the fundamental concepts and techniques involved in performing and reporting t-tests in R, especially within the context of psychological research adhering to APA style.</p>
</section>
<section id="self-assessment-quiz" class="level1">
<h1>Self-Assessment Quiz</h1>
<section id="self-assessment-quiz-t-tests-in-r-with-theory-practicals-and-write-up-in-psychology-apa-style" class="level3">
<h3 class="anchored" data-anchor-id="self-assessment-quiz-t-tests-in-r-with-theory-practicals-and-write-up-in-psychology-apa-style">Self-Assessment Quiz: T-Tests in R with Theory, Practicals, and Write-up in Psychology APA-style</h3>
<section id="multiple-choice-questions" class="level4">
<h4 class="anchored" data-anchor-id="multiple-choice-questions">Multiple-Choice Questions</h4>
<p><strong>1. What is the primary purpose of a t-test in statistics?</strong> a) To compare three or more means<br>
b) To determine the relationship between two categorical variables<br>
c) To compare the means of two groups<br>
d) To analyze the variance within a single group</p>
<p><strong>Answer: c) To compare the means of two groups</strong></p>
<p><strong>2. In R, which function is commonly used to perform an independent t-test?</strong> a) t_test()<br>
b) ttest()<br>
c) t.test()<br>
d) TTest()</p>
<p><strong>Answer: c) t.test()</strong></p>
<p><strong>3. What is the null hypothesis in an independent samples t-test?</strong> a) The means of the two groups are equal<br>
b) The means of the two groups are not equal<br>
c) The variances of the two groups are equal<br>
d) The variances of the two groups are not equal</p>
<p><strong>Answer: a) The means of the two groups are equal</strong></p>
<p><strong>4. Which of the following is NOT a requirement for conducting a t-test?</strong> a) The data should be approximately normally distributed<br>
b) The samples should be independent<br>
c) The sample sizes must be equal<br>
d) The variances should be roughly equal (for independent t-tests)</p>
<p><strong>Answer: c) The sample sizes must be equal</strong></p>
</section>
<section id="truefalse-questions" class="level4">
<h4 class="anchored" data-anchor-id="truefalse-questions">True/False Questions</h4>
<p><strong>5. A paired t-test is appropriate when comparing the means of two related groups.</strong> <strong>True</strong></p>
<p><strong>6. In R, the <code>t.test()</code> function can only be used for independent t-tests.</strong> <strong>False</strong></p>
<p><strong>7. The p-value in a t-test indicates the probability that the observed differences in sample means occurred by chance.</strong> <strong>True</strong></p>
<p><strong>8. The degrees of freedom for an independent t-test with two samples of 15 participants each would be 28.</strong> <strong>False</strong> (It’s 28; df = n1 + n2 - 2, so 15 + 15 - 2 = 28)</p>
</section>
<section id="short-answer-questions" class="level4">
<h4 class="anchored" data-anchor-id="short-answer-questions">Short Answer Questions</h4>
<p><strong>9. Describe in a few sentences the steps to perform an independent t-test in R, including any necessary data preparation.</strong></p>
<p><strong>Answer: To perform an independent t-test in R, follow these steps:</strong> - Load your data into R, typically using <code>read.csv()</code> or similar functions. - Inspect and clean your data to ensure it meets the assumptions of the t-test (e.g., checking for normality and independence). - Use the <code>t.test()</code> function, specifying the two groups you wish to compare. - Interpret the output, which includes the t-value, degrees of freedom, and p-value, to determine whether to reject the null hypothesis.</p>
<p><strong>10. Write an example of how to report the results of an independent t-test in APA style.</strong></p>
<p><strong>Answer: An example APA-style write-up might look like this:</strong> - “An independent samples t-test was conducted to compare the test scores for Group A and Group B. There was a significant difference in scores between Group A (M = 85.3, SD = 5.2) and Group B (M = 78.4, SD = 6.1); t(28) = 3.45, p &lt; .01. These results suggest that the intervention had a significant effect on test scores.”</p>
</section>
<section id="answer-key" class="level4">
<h4 class="anchored" data-anchor-id="answer-key">Answer Key</h4>
<ol type="1">
<li><ol start="3" type="a">
<li>To compare the means of two groups</li>
</ol></li>
<li><ol start="3" type="a">
<li>t.test()</li>
</ol></li>
<li><ol type="a">
<li>The means of the two groups are equal</li>
</ol></li>
<li><ol start="3" type="a">
<li>The sample sizes must be equal</li>
</ol></li>
<li><p>True</p></li>
<li><p>False</p></li>
<li><p>True</p></li>
<li><p>False</p></li>
<li><p>Answer provided above.</p></li>
<li><p>Answer provided above.</p></li>
</ol>
<p>This quiz should help students test their understanding of the key concepts related to t-tests in R, including theoretical understanding, practical application, and APA-style reporting.</p>


<!-- -->

</section>
</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{untitled,
  author = {},
  title = {T-Tests},
  url = {http://introrm.littlemonkeylab.com/week31/chapter.html},
  langid = {en}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-untitled" class="csl-entry quarto-appendix-citeas" role="listitem">
<span>“T-Tests.”</span> n.d. <a href="http://introrm.littlemonkeylab.com/week31/chapter.html">http://introrm.littlemonkeylab.com/week31/chapter.html</a>.
</div></div></section></div></main> <!-- /main -->
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("http:\/\/introrm\.littlemonkeylab\.com");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../week01/lecture-slides.html" class="pagination-link" aria-label="RMLecture Slides Week 01">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">RMLecture Slides Week 01</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../week31/dataskills.html" class="pagination-link" aria-label="Expectations">
        <span class="nav-page-text">Expectations</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb61" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "T-Tests"</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="an">subtitle:</span><span class="co"> A Year 1 Textbook Chapter</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html: </span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co">    code-annotations: hover</span></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a><span class="co">    title-block-banner: true</span></span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a><span class="an">webr:</span></span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a><span class="co">  packages: ['ggplot2', 'dplyr'] # Install R packages on document open</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb61-13"><a href="#cb61-13" aria-hidden="true" tabindex="-1"></a><span class="an">filters:</span><span class="co"> </span></span>
<span id="cb61-14"><a href="#cb61-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - webr</span></span>
<span id="cb61-15"><a href="#cb61-15" aria-hidden="true" tabindex="-1"></a><span class="co">  </span></span>
<span id="cb61-16"><a href="#cb61-16" aria-hidden="true" tabindex="-1"></a><span class="an">execute:</span><span class="co"> </span></span>
<span id="cb61-17"><a href="#cb61-17" aria-hidden="true" tabindex="-1"></a><span class="co">  freeze: true</span></span>
<span id="cb61-18"><a href="#cb61-18" aria-hidden="true" tabindex="-1"></a><span class="co">  warning: false</span></span>
<span id="cb61-19"><a href="#cb61-19" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb61-20"><a href="#cb61-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-21"><a href="#cb61-21" aria-hidden="true" tabindex="-1"></a><span class="fu"># Chapter: T-Tests in R</span></span>
<span id="cb61-22"><a href="#cb61-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-23"><a href="#cb61-23" aria-hidden="true" tabindex="-1"></a>::: {.callout-note title="CC Attribution" collapse="true" appearance="minimal" icon="false"}</span>
<span id="cb61-24"><a href="#cb61-24" aria-hidden="true" tabindex="-1"></a>Content below originally written by Matthew Crump under a CC-BY-NC-SA Licence. Original Content Chapter 6 of https://www.crumplab.com/statistics/06-ttests.html</span>
<span id="cb61-25"><a href="#cb61-25" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb61-26"><a href="#cb61-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-27"><a href="#cb61-27" aria-hidden="true" tabindex="-1"></a>Back in the day, William Sealy Gosset got a job working for Guinness Breweries. They make the famous Irish stout called Guinness. What happens next went something like this (total fabrication, but mostly on point).</span>
<span id="cb61-28"><a href="#cb61-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-29"><a href="#cb61-29" aria-hidden="true" tabindex="-1"></a>Guinness wanted all of their beers to be the best beers. No mistakes, no bad beers. They wanted to improve their quality control so that when Guinness was poured anywhere in the world, it would always comes out fantastic: 5 stars out of 5 every time, the best.</span>
<span id="cb61-30"><a href="#cb61-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-31"><a href="#cb61-31" aria-hidden="true" tabindex="-1"></a>Guinness had some beer tasters, who were super-experts. Every time they tasted a Guinness from the factory that wasn't 5 out of 5, they knew right away.</span>
<span id="cb61-32"><a href="#cb61-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-33"><a href="#cb61-33" aria-hidden="true" tabindex="-1"></a>But, Guinness had a big problem. They would make a keg of beer, and they would want to know if every single pint that would come out would be a 5 out of 5. So, the beer tasters drank pint after pint out of the keg, until it was gone. Some kegs were all 5 out of 5s. Some weren't, Guinness needed to fix that. But, the biggest problem was that, after the testing, there **was no beer left to sell**, the testers drank it all (remember I'm making this part up to illustrate a point, they probably still had beer left to sell).</span>
<span id="cb61-34"><a href="#cb61-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-35"><a href="#cb61-35" aria-hidden="true" tabindex="-1"></a>Guinness had a sampling and population problem. They wanted to know that the entire population of the beers they made were all 5 out of 5 stars. But, if they sampled the entire population, they would drink all of their beer, and wouldn't have any left to sell.</span>
<span id="cb61-36"><a href="#cb61-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-37"><a href="#cb61-37" aria-hidden="true" tabindex="-1"></a>Enter William Sealy Gosset. Gosset figured out the solution to the problem. He asked questions like this:</span>
<span id="cb61-38"><a href="#cb61-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-39"><a href="#cb61-39" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>How many samples do I need to take to know the whole population is 5 out of 5?</span>
<span id="cb61-40"><a href="#cb61-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-41"><a href="#cb61-41" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>What's the fewest amount of samples I need to take to know the above, that would mean Guinness could test fewer beers for quality, sell more beers for profit, and make the product testing time shorter.</span>
<span id="cb61-42"><a href="#cb61-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-43"><a href="#cb61-43" aria-hidden="true" tabindex="-1"></a>Gosset solved those questions, and he invented something called the *Student's t-test*. Gosset was working for Guinness, and could be fired for releasing trade-secrets that he invented (the t-test). But, Gosset published the work anyways, under a pseudonym <span class="co">[</span><span class="ot">@Student1908</span><span class="co">]</span>. He called himself Student, hence Student's t-test. Now you know the rest of the story.</span>
<span id="cb61-44"><a href="#cb61-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-45"><a href="#cb61-45" aria-hidden="true" tabindex="-1"></a>It turns out this was a very nice thing for Gosset to have done. t-tests are used all the time, and they are useful, that's why they are used. In this chapter we learn how they work.</span>
<span id="cb61-46"><a href="#cb61-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-47"><a href="#cb61-47" aria-hidden="true" tabindex="-1"></a>You'll be surprised to learn that what we've already talked about, (the Crump Test, and the Randomization Test), are both very very similar to the t-test. So, in general, you have already been thinking about the things you need to think about to understand t-tests. You're probably wondering what is this $t$, what does $t$ mean? We will tell you. Before we tell what it means, we first tell you about one more idea.</span>
<span id="cb61-48"><a href="#cb61-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-49"><a href="#cb61-49" aria-hidden="true" tabindex="-1"></a><span class="fu">## Check your confidence in your mean</span></span>
<span id="cb61-50"><a href="#cb61-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-51"><a href="#cb61-51" aria-hidden="true" tabindex="-1"></a>We've talked about getting a sample of data. We know we can find the mean, we know we can find the standard deviation. We know we can look at the data in a histogram. These are all useful things to do for us to learn something about the properties of our data.</span>
<span id="cb61-52"><a href="#cb61-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-53"><a href="#cb61-53" aria-hidden="true" tabindex="-1"></a>You might be thinking of the mean and standard deviation as very different things that we would not put together. The mean is about central tendency (where most of the data is), and the standard deviation is about variance (where most of the data isn't). Yes, they are different things, but we can use them together to create useful new things.</span>
<span id="cb61-54"><a href="#cb61-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-55"><a href="#cb61-55" aria-hidden="true" tabindex="-1"></a>What if I told you my sample mean was 50, and I told you nothing else about my sample. Would you be confident that most of the numbers were near 50? Would you wonder if there was a lot of variability in the sample, and many of the numbers were very different from 50. You should wonder all of those things. The mean alone, just by itself, doesn't tell you anything about well the mean represents all of the numbers in the sample.</span>
<span id="cb61-56"><a href="#cb61-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-57"><a href="#cb61-57" aria-hidden="true" tabindex="-1"></a>It could be a representative number, when the standard deviation is very small, and all the numbers are close to 50. It could be a non-representative number, when the standard deviation is large, and many of the numbers are not near 50. You need to know the standard deviation in order to be confident in how well the mean represents the data.</span>
<span id="cb61-58"><a href="#cb61-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-59"><a href="#cb61-59" aria-hidden="true" tabindex="-1"></a>How can we put the mean and the standard deviation together, to give us a new number that tells us about confidence in the mean?</span>
<span id="cb61-60"><a href="#cb61-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-61"><a href="#cb61-61" aria-hidden="true" tabindex="-1"></a>We can do this using a ratio:</span>
<span id="cb61-62"><a href="#cb61-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-63"><a href="#cb61-63" aria-hidden="true" tabindex="-1"></a>$\frac{mean}{\text{standard deviation}}$</span>
<span id="cb61-64"><a href="#cb61-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-65"><a href="#cb61-65" aria-hidden="true" tabindex="-1"></a>Think about what happens here. We are dividing a number by a number. Look at what happens:</span>
<span id="cb61-66"><a href="#cb61-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-67"><a href="#cb61-67" aria-hidden="true" tabindex="-1"></a>$\frac{number}{\text{same number}} = 1$</span>
<span id="cb61-68"><a href="#cb61-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-69"><a href="#cb61-69" aria-hidden="true" tabindex="-1"></a>$\frac{number}{\text{smaller number}} = \text{big number}$</span>
<span id="cb61-70"><a href="#cb61-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-71"><a href="#cb61-71" aria-hidden="true" tabindex="-1"></a>compared to:</span>
<span id="cb61-72"><a href="#cb61-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-73"><a href="#cb61-73" aria-hidden="true" tabindex="-1"></a>$\frac{number}{\text{bigger number}} = \text{smaller number}$</span>
<span id="cb61-74"><a href="#cb61-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-75"><a href="#cb61-75" aria-hidden="true" tabindex="-1"></a>Imagine we have a mean of 50, and a truly small standard deviation of 1. What do we get with our formula?</span>
<span id="cb61-76"><a href="#cb61-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-77"><a href="#cb61-77" aria-hidden="true" tabindex="-1"></a>$\frac{50}{1} = 50$</span>
<span id="cb61-78"><a href="#cb61-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-79"><a href="#cb61-79" aria-hidden="true" tabindex="-1"></a>Imagine we have a mean of 50, and a big standard deviation of 100. What do we get with our formula?</span>
<span id="cb61-80"><a href="#cb61-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-81"><a href="#cb61-81" aria-hidden="true" tabindex="-1"></a>$\frac{50}{100} = 0.5$</span>
<span id="cb61-82"><a href="#cb61-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-83"><a href="#cb61-83" aria-hidden="true" tabindex="-1"></a>Notice, when we have a mean paired with a small standard deviation, our formula gives us a big number, like 50. When we have a mean paired with a large standard deviation, our formula gives us a small number, like 0.5. These numbers can tell us something about confidence in our mean, in a general way. We can be 50 confident in our mean in the first case, and only 0.5 (not at a lot) confident in the second case.</span>
<span id="cb61-84"><a href="#cb61-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-85"><a href="#cb61-85" aria-hidden="true" tabindex="-1"></a>What did we do here? We created a descriptive statistic by dividing the mean by the standard deviation. And, we have a sense of how to interpret this number, when it's big we're more confident that the mean represents all of the numbers, when it's small we are less confident. This is a useful kind of number, a ratio between what we think about our sample (the mean), and the variability in our sample (the standard deviation). Get used to this idea. Almost everything that follows in this textbook is based on this kind of ratio. We will see that our ratio turns into different kinds of "statistics", and the ratios will look like this in general:</span>
<span id="cb61-86"><a href="#cb61-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-87"><a href="#cb61-87" aria-hidden="true" tabindex="-1"></a>$\text{name of statistic} = \frac{\text{measure of what we know}}{\text{measure of what we don't know}}$</span>
<span id="cb61-88"><a href="#cb61-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-89"><a href="#cb61-89" aria-hidden="true" tabindex="-1"></a>or, to say it using different words:</span>
<span id="cb61-90"><a href="#cb61-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-91"><a href="#cb61-91" aria-hidden="true" tabindex="-1"></a>$\text{name of statistic} = \frac{\text{measure of effect}}{\text{measure of error}}$</span>
<span id="cb61-92"><a href="#cb61-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-93"><a href="#cb61-93" aria-hidden="true" tabindex="-1"></a>In fact, this is the general formula for the t-test. Big surprise!</span>
<span id="cb61-94"><a href="#cb61-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-95"><a href="#cb61-95" aria-hidden="true" tabindex="-1"></a><span class="fu">## One-sample t-test: A new t-test</span></span>
<span id="cb61-96"><a href="#cb61-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-97"><a href="#cb61-97" aria-hidden="true" tabindex="-1"></a>Now we are ready to talk about t-test. We will talk about three of them. We start with the one-sample t-test.</span>
<span id="cb61-98"><a href="#cb61-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-99"><a href="#cb61-99" aria-hidden="true" tabindex="-1"></a>Commonly, the one-sample t-test is used to estimate the chances that your sample came from a particular population. Specifically, you might want to know whether the mean that you found from your sample, could have come from a particular population having a particular mean.</span>
<span id="cb61-100"><a href="#cb61-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-101"><a href="#cb61-101" aria-hidden="true" tabindex="-1"></a>Straight away, the one-sample t-test becomes a little confusing (and I haven't even described it yet). Officially, it uses known parameters from the population, like the mean of the population and the standard deviation of the population. However, most times you don't know those parameters of the population! So, you have to estimate them from your sample. Remember from the chapters on descriptive statistics and sampling, our sample mean is an unbiased estimate of the population mean. And, our sample standard deviation (the one where we divide by n-1) is an unbiased estimate of the population standard deviation. When Gosset developed the t-test, he recognized that he could use these estimates from his samples, to make the t-test. Here is the formula for the one sample t-test, we first use words, and then become more specific:</span>
<span id="cb61-102"><a href="#cb61-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-103"><a href="#cb61-103" aria-hidden="true" tabindex="-1"></a><span class="fu">### Formulas for one-sample t-test</span></span>
<span id="cb61-104"><a href="#cb61-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-105"><a href="#cb61-105" aria-hidden="true" tabindex="-1"></a>$\text{name of statistic} = \frac{\text{measure of effect}}{\text{measure of error}}$</span>
<span id="cb61-106"><a href="#cb61-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-107"><a href="#cb61-107" aria-hidden="true" tabindex="-1"></a>$\text{t} = \frac{\text{measure of effect}}{\text{measure of error}}$</span>
<span id="cb61-108"><a href="#cb61-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-109"><a href="#cb61-109" aria-hidden="true" tabindex="-1"></a>$\text{t} = \frac{\text{Mean difference}}{\text{standard error}}$</span>
<span id="cb61-110"><a href="#cb61-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-111"><a href="#cb61-111" aria-hidden="true" tabindex="-1"></a>$\text{t} = \frac{\bar{X}-u}{S_{\bar{X}}}$</span>
<span id="cb61-112"><a href="#cb61-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-113"><a href="#cb61-113" aria-hidden="true" tabindex="-1"></a>$\text{t} = \frac{\text{Sample Mean  - Population Mean}}{\text{Sample Standard Error}}$</span>
<span id="cb61-114"><a href="#cb61-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-115"><a href="#cb61-115" aria-hidden="true" tabindex="-1"></a>$\text{Estimated Standard Error} = \text{Standard Error of Sample} = \frac{s}{\sqrt{N}}$</span>
<span id="cb61-116"><a href="#cb61-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-117"><a href="#cb61-117" aria-hidden="true" tabindex="-1"></a>Where, s is the sample standard deviation.</span>
<span id="cb61-118"><a href="#cb61-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-119"><a href="#cb61-119" aria-hidden="true" tabindex="-1"></a>Some of you may have gone cross-eyed looking at all of this. Remember, we've seen it before when we divided our mean by the standard deviation in the first bit. The t-test is just a measure of a sample mean, divided by the standard error of the sample mean. That is it.</span>
<span id="cb61-120"><a href="#cb61-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-121"><a href="#cb61-121" aria-hidden="true" tabindex="-1"></a><span class="fu">### What does t represent?</span></span>
<span id="cb61-122"><a href="#cb61-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-123"><a href="#cb61-123" aria-hidden="true" tabindex="-1"></a>$t$ gives us a measure of confidence, just like our previous ratio for dividing the mean by a standard deviations. The only difference with $t$, is that we divide by the standard error of mean (remember, this is also a standard deviation, it is the standard deviation of the sampling distribution of the mean)</span>
<span id="cb61-124"><a href="#cb61-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-125"><a href="#cb61-125" aria-hidden="true" tabindex="-1"></a>::: callout-note</span>
<span id="cb61-126"><a href="#cb61-126" aria-hidden="true" tabindex="-1"></a>What does the t in t-test stand for? Apparently nothing. Gosset originally labelled it z. And, Fisher later called it t, perhaps because t comes after s, which is often used for the sample standard deviation.</span>
<span id="cb61-127"><a href="#cb61-127" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb61-128"><a href="#cb61-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-129"><a href="#cb61-129" aria-hidden="true" tabindex="-1"></a>$t$ is a property of the data that you collect. You compute it with a sample mean, and a sample standard error (there's one more thing in the one-sample formula, the population mean, which we get to in a moment). This is why we call $t$, a sample-statistic. It's a statistic we compute from the sample.</span>
<span id="cb61-130"><a href="#cb61-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-131"><a href="#cb61-131" aria-hidden="true" tabindex="-1"></a>What kinds of numbers should we expect to find for these $ts$? How could we figure that out?</span>
<span id="cb61-132"><a href="#cb61-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-133"><a href="#cb61-133" aria-hidden="true" tabindex="-1"></a>Let's start small and work through some examples. Imagine your sample mean is 5. You want to know if it came from a population that also has a mean of 5. In this case, what would $t$ be? It would be zero: we first subtract the sample mean from the population mean, $5-5=0$. Because the numerator is 0, $t$ will be zero. So, $t$ = 0, occurs, when there is no difference.</span>
<span id="cb61-134"><a href="#cb61-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-135"><a href="#cb61-135" aria-hidden="true" tabindex="-1"></a>Let's say you take another sample, do you think the mean will be 5 every time, probably not. Let's say the mean is 6. So, what can $t$ be here? It will be a positive number, because 6-5= +1. But, will $t$ be +1? That depends on the standard error of the sample. If the standard error of the sample is 1, then $t$ could be 1, because 1/1 = 1.</span>
<span id="cb61-136"><a href="#cb61-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-137"><a href="#cb61-137" aria-hidden="true" tabindex="-1"></a>If the sample standard error is smaller than 1, what happens to $t$? It get's bigger right? For example, 1 divided by 0.5 = 2. If the sample standard error was 0.5, $t$ would be 2. And, what could we do with this information? Well, it be like a measure of confidence. As $t$ get's bigger we could be more confident in the mean difference we are measuring.</span>
<span id="cb61-138"><a href="#cb61-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-139"><a href="#cb61-139" aria-hidden="true" tabindex="-1"></a>Can $t$ be smaller than 1? Sure, it can. If the sample standard error is big, say like 2, then $t$ will be smaller than one (in our case), e.g., 1/2 = .5. The direction of the difference between the sample mean and population mean, can also make the $t$ become negative. What if our sample mean was 4. Well, then $t$ will be negative, because the mean difference in the numerator will be negative, and the number in the bottom (denominator) will always be positive (remember why, it's the standard error, computed from the sample standard deviation, which is always positive because of the squaring that we did.).</span>
<span id="cb61-140"><a href="#cb61-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-141"><a href="#cb61-141" aria-hidden="true" tabindex="-1"></a>So, that is some intuitions about what the kinds of values t can take. $t$ can be positive or negative, and big or small.</span>
<span id="cb61-142"><a href="#cb61-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-143"><a href="#cb61-143" aria-hidden="true" tabindex="-1"></a>Let's do one more thing to build our intuitions about what $t$ can look like. How about we sample some numbers and then measure the sample mean **and** the standard error of the mean, and then plot those two things against each each. This will show us how a sample mean typically varies with respect to the standard error of the mean.</span>
<span id="cb61-144"><a href="#cb61-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-145"><a href="#cb61-145" aria-hidden="true" tabindex="-1"></a>In @fig-6sampleMSEM, I pulled 1,000 samples of $N = 10$ from a normal distribution (mean = 0, sd = 1). Each time I measured the mean and standard error of the sample. That gave two descriptive statistics for each sample, letting us plot each sample as dot in a scatter plot.</span>
<span id="cb61-146"><a href="#cb61-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-147"><a href="#cb61-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r setup}</span></span>
<span id="cb61-148"><a href="#cb61-148" aria-hidden="true" tabindex="-1"></a><span class="in">install.packages("ggplot2")</span></span>
<span id="cb61-149"><a href="#cb61-149" aria-hidden="true" tabindex="-1"></a><span class="in">library(ggplot2)</span></span>
<span id="cb61-150"><a href="#cb61-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-151"><a href="#cb61-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-154"><a href="#cb61-154" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-155"><a href="#cb61-155" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6sampleMSEM</span></span>
<span id="cb61-156"><a href="#cb61-156" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "A scatter plot with sample mean on the x-axis, and standard error of the mean on the y-axis"</span></span>
<span id="cb61-157"><a href="#cb61-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-158"><a href="#cb61-158" aria-hidden="true" tabindex="-1"></a>sample_mean <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb61-159"><a href="#cb61-159" aria-hidden="true" tabindex="-1"></a>sample_se <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb61-160"><a href="#cb61-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-161"><a href="#cb61-161" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb61-162"><a href="#cb61-162" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb61-163"><a href="#cb61-163" aria-hidden="true" tabindex="-1"></a>  sample_mean[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(s)</span>
<span id="cb61-164"><a href="#cb61-164" aria-hidden="true" tabindex="-1"></a>  sample_se[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(s) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(s))</span>
<span id="cb61-165"><a href="#cb61-165" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-166"><a href="#cb61-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-167"><a href="#cb61-167" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(sample_mean, sample_se)</span>
<span id="cb61-168"><a href="#cb61-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-169"><a href="#cb61-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-170"><a href="#cb61-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-171"><a href="#cb61-171" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr-r}</span></span>
<span id="cb61-172"><a href="#cb61-172" aria-hidden="true" tabindex="-1"></a><span class="in">sample_mean &lt;- length(1000)</span></span>
<span id="cb61-173"><a href="#cb61-173" aria-hidden="true" tabindex="-1"></a><span class="in">sample_se &lt;- length(1000)</span></span>
<span id="cb61-174"><a href="#cb61-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-175"><a href="#cb61-175" aria-hidden="true" tabindex="-1"></a><span class="in">for (i in 1:1000) {</span></span>
<span id="cb61-176"><a href="#cb61-176" aria-hidden="true" tabindex="-1"></a><span class="in">  s &lt;- rnorm(10, 0, 1)</span></span>
<span id="cb61-177"><a href="#cb61-177" aria-hidden="true" tabindex="-1"></a><span class="in">  sample_mean[i] &lt;- mean(s)</span></span>
<span id="cb61-178"><a href="#cb61-178" aria-hidden="true" tabindex="-1"></a><span class="in">  sample_se[i] &lt;- sd(s) / sqrt(length(s))</span></span>
<span id="cb61-179"><a href="#cb61-179" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb61-180"><a href="#cb61-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-181"><a href="#cb61-181" aria-hidden="true" tabindex="-1"></a><span class="in">plot(sample_mean, sample_se)</span></span>
<span id="cb61-182"><a href="#cb61-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-183"><a href="#cb61-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-184"><a href="#cb61-184" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr-r}</span></span>
<span id="cb61-185"><a href="#cb61-185" aria-hidden="true" tabindex="-1"></a><span class="in"># Initialize vectors to store the sample means and standard errors, each of length 1000</span></span>
<span id="cb61-186"><a href="#cb61-186" aria-hidden="true" tabindex="-1"></a><span class="in">sample_mean &lt;- numeric(1000)  # creates a numeric vector of length 1000 filled with zeros</span></span>
<span id="cb61-187"><a href="#cb61-187" aria-hidden="true" tabindex="-1"></a><span class="in">sample_se &lt;- numeric(1000)    # creates a numeric vector of length 1000 filled with zeros</span></span>
<span id="cb61-188"><a href="#cb61-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-189"><a href="#cb61-189" aria-hidden="true" tabindex="-1"></a><span class="in"># Run a loop 1000 times to generate samples, calculate their means, and standard errors</span></span>
<span id="cb61-190"><a href="#cb61-190" aria-hidden="true" tabindex="-1"></a><span class="in">for (i in 1:1000) { # &lt;1&gt;</span></span>
<span id="cb61-191"><a href="#cb61-191" aria-hidden="true" tabindex="-1"></a><span class="in">  # Generate a sample of 10 random numbers from a normal distribution with mean 0 and standard deviation 1</span></span>
<span id="cb61-192"><a href="#cb61-192" aria-hidden="true" tabindex="-1"></a><span class="in">  s &lt;- rnorm(10, 0, 1) # &lt;2&gt;</span></span>
<span id="cb61-193"><a href="#cb61-193" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb61-194"><a href="#cb61-194" aria-hidden="true" tabindex="-1"></a><span class="in">  # Calculate the mean of the sample and store it in the ith position of the sample_mean vector</span></span>
<span id="cb61-195"><a href="#cb61-195" aria-hidden="true" tabindex="-1"></a><span class="in">  sample_mean[i] &lt;- mean(s)</span></span>
<span id="cb61-196"><a href="#cb61-196" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb61-197"><a href="#cb61-197" aria-hidden="true" tabindex="-1"></a><span class="in">  # Calculate the standard error of the sample mean and store it in the ith position of the sample_se vector</span></span>
<span id="cb61-198"><a href="#cb61-198" aria-hidden="true" tabindex="-1"></a><span class="in">  sample_se[i] &lt;- sd(s) / sqrt(length(s))</span></span>
<span id="cb61-199"><a href="#cb61-199" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb61-200"><a href="#cb61-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-201"><a href="#cb61-201" aria-hidden="true" tabindex="-1"></a><span class="in"># Plot the sample means against their corresponding standard errors</span></span>
<span id="cb61-202"><a href="#cb61-202" aria-hidden="true" tabindex="-1"></a><span class="in">plot(sample_mean, sample_se)</span></span>
<span id="cb61-203"><a href="#cb61-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-204"><a href="#cb61-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-205"><a href="#cb61-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-206"><a href="#cb61-206" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Take <span class="in">`penguins`</span>, and then,</span>
<span id="cb61-207"><a href="#cb61-207" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>add new columns for the bill ratio and bill area.</span>
<span id="cb61-208"><a href="#cb61-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-211"><a href="#cb61-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-212"><a href="#cb61-212" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb61-213"><a href="#cb61-213" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb61-214"><a href="#cb61-214" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span>                                      <span class="co"># &lt;1&gt;</span></span>
<span id="cb61-215"><a href="#cb61-215" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(                                        <span class="co"># &lt;2&gt;</span></span>
<span id="cb61-216"><a href="#cb61-216" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_ratio =</span> bill_depth_mm <span class="sc">/</span> bill_length_mm, <span class="co"># &lt;2&gt;</span></span>
<span id="cb61-217"><a href="#cb61-217" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_area  =</span> bill_depth_mm <span class="sc">*</span> bill_length_mm  <span class="co"># &lt;2&gt;</span></span>
<span id="cb61-218"><a href="#cb61-218" aria-hidden="true" tabindex="-1"></a>  )                                              <span class="co"># &lt;2&gt;</span></span>
<span id="cb61-219"><a href="#cb61-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-220"><a href="#cb61-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-221"><a href="#cb61-221" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Take <span class="in">`penguins`</span>, and then,</span>
<span id="cb61-222"><a href="#cb61-222" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>add new columns for the bill ratio and bill area.</span>
<span id="cb61-223"><a href="#cb61-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-224"><a href="#cb61-224" aria-hidden="true" tabindex="-1"></a><span class="in">````{=html}</span></span>
<span id="cb61-225"><a href="#cb61-225" aria-hidden="true" tabindex="-1"></a><span class="in">&lt;!-- ```{r}</span></span>
<span id="cb61-226"><a href="#cb61-226" aria-hidden="true" tabindex="-1"></a><span class="in">library(countdown)</span></span>
<span id="cb61-227"><a href="#cb61-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-228"><a href="#cb61-228" aria-hidden="true" tabindex="-1"></a><span class="in">countdown(minutes = 0, seconds = 15)</span></span>
<span id="cb61-229"><a href="#cb61-229" aria-hidden="true" tabindex="-1"></a><span class="in">``` --&gt;</span></span>
<span id="cb61-230"><a href="#cb61-230" aria-hidden="true" tabindex="-1"></a><span class="in">````</span></span>
<span id="cb61-231"><a href="#cb61-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-232"><a href="#cb61-232" aria-hidden="true" tabindex="-1"></a>::: to-webr</span>
<span id="cb61-235"><a href="#cb61-235" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-236"><a href="#cb61-236" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb61-237"><a href="#cb61-237" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb61-238"><a href="#cb61-238" aria-hidden="true" tabindex="-1"></a>penguins <span class="sc">|&gt;</span>                                      <span class="co"># &lt;1&gt;</span></span>
<span id="cb61-239"><a href="#cb61-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(                                        <span class="co"># &lt;2&gt;</span></span>
<span id="cb61-240"><a href="#cb61-240" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_ratio =</span> bill_depth_mm <span class="sc">/</span> bill_length_mm, <span class="co"># &lt;2&gt;</span></span>
<span id="cb61-241"><a href="#cb61-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">bill_area  =</span> bill_depth_mm <span class="sc">*</span> bill_length_mm  <span class="co"># &lt;2&gt;</span></span>
<span id="cb61-242"><a href="#cb61-242" aria-hidden="true" tabindex="-1"></a>  )         </span>
<span id="cb61-243"><a href="#cb61-243" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-244"><a href="#cb61-244" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb61-245"><a href="#cb61-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-246"><a href="#cb61-246" aria-hidden="true" tabindex="-1"></a>What we get is a cloud of dots. You might notice the cloud has a circular quality. There's more dots in the middle, and fewer dots as they radiate out from the middle. The dot cloud shows us the general range of the sample mean, for example most of the dots are in between -1 and 1. Similarly, the range for the sample standard error is roughly between .2 and .5. Remember, each dot represents one sample.</span>
<span id="cb61-247"><a href="#cb61-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-248"><a href="#cb61-248" aria-hidden="true" tabindex="-1"></a>We can look at the same data a different way. For example, rather than using a scatter plot, we can divide the mean for each dot by the standard error for each dot. @fig-6thisexample shows the result in a histogram.</span>
<span id="cb61-249"><a href="#cb61-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-252"><a href="#cb61-252" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-253"><a href="#cb61-253" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6thisexample</span></span>
<span id="cb61-254"><a href="#cb61-254" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "A histogram of the sample means divided by the sample standard errors, this is a t-distribution."</span></span>
<span id="cb61-255"><a href="#cb61-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-256"><a href="#cb61-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-257"><a href="#cb61-257" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(sample_mean<span class="sc">/</span>sample_se, <span class="at">breaks=</span><span class="dv">30</span>)</span>
<span id="cb61-258"><a href="#cb61-258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-259"><a href="#cb61-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-260"><a href="#cb61-260" aria-hidden="true" tabindex="-1"></a>Interesting, we can see the histogram is shaped like a normal curve. It is centered on 0, which is the most common value. As values become more extreme, they become less common. If you remember, our formula for $t$, was the mean divided by the standard error of the mean. That's what we did here. This histogram is showing you a $t$-distribution.</span>
<span id="cb61-261"><a href="#cb61-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-262"><a href="#cb61-262" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculating t from data</span></span>
<span id="cb61-263"><a href="#cb61-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-264"><a href="#cb61-264" aria-hidden="true" tabindex="-1"></a>Let's briefly calculate a t-value from a small sample. Let's say we had 10 students do a true/false quiz with 5 questions on it. There's a 50% chance of getting each answer correct.</span>
<span id="cb61-265"><a href="#cb61-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-266"><a href="#cb61-266" aria-hidden="true" tabindex="-1"></a>Every student completes the 5 questions, we grade them, and then we find their performance (mean percent correct). What we want to know is whether the students were guessing. If they were all guessing, then the sample mean should be about 50%, it shouldn't be different from chance, which is 50%. Let's look at @tbl-tsmall.</span>
<span id="cb61-267"><a href="#cb61-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-268"><a href="#cb61-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb61-269"><a href="#cb61-269" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: tbl-tsmall</span></span>
<span id="cb61-270"><a href="#cb61-270" aria-hidden="true" tabindex="-1"></a><span class="in">#| tbl-cap: "Calculating the t-value for a one-sample test."</span></span>
<span id="cb61-271"><a href="#cb61-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-272"><a href="#cb61-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-273"><a href="#cb61-273" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb61-274"><a href="#cb61-274" aria-hidden="true" tabindex="-1"></a><span class="in">students &lt;- 1:10</span></span>
<span id="cb61-275"><a href="#cb61-275" aria-hidden="true" tabindex="-1"></a><span class="in">scores &lt;- c(50, 70, 60, 40, 80, 30, 90, 60, 70, 60)</span></span>
<span id="cb61-276"><a href="#cb61-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-277"><a href="#cb61-277" aria-hidden="true" tabindex="-1"></a><span class="in">mean_scores &lt;- mean(scores)</span></span>
<span id="cb61-278"><a href="#cb61-278" aria-hidden="true" tabindex="-1"></a><span class="in">Difference_from_Mean &lt;- scores - mean_scores</span></span>
<span id="cb61-279"><a href="#cb61-279" aria-hidden="true" tabindex="-1"></a><span class="in">Squared_Deviations &lt;- Difference_from_Mean ^ 2</span></span>
<span id="cb61-280"><a href="#cb61-280" aria-hidden="true" tabindex="-1"></a><span class="in">the_df &lt;- data.frame(students,</span></span>
<span id="cb61-281"><a href="#cb61-281" aria-hidden="true" tabindex="-1"></a><span class="in">                     scores,</span></span>
<span id="cb61-282"><a href="#cb61-282" aria-hidden="true" tabindex="-1"></a><span class="in">                     mean = rep(mean_scores, 10),</span></span>
<span id="cb61-283"><a href="#cb61-283" aria-hidden="true" tabindex="-1"></a><span class="in">                     Difference_from_Mean,</span></span>
<span id="cb61-284"><a href="#cb61-284" aria-hidden="true" tabindex="-1"></a><span class="in">                     Squared_Deviations)</span></span>
<span id="cb61-285"><a href="#cb61-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-286"><a href="#cb61-286" aria-hidden="true" tabindex="-1"></a><span class="in">the_df &lt;- the_df %&gt;%</span></span>
<span id="cb61-287"><a href="#cb61-287" aria-hidden="true" tabindex="-1"></a><span class="in">  rbind(c("Sums", colSums(the_df[1:10, 2:5]))) %&gt;%</span></span>
<span id="cb61-288"><a href="#cb61-288" aria-hidden="true" tabindex="-1"></a><span class="in">  rbind(c("Means", colMeans(the_df[1:10, 2:5]))) %&gt;%</span></span>
<span id="cb61-289"><a href="#cb61-289" aria-hidden="true" tabindex="-1"></a><span class="in">  rbind(c(" ", " ", " ", "sd ", round(sd(the_df[1:10, 2]), digits = 2))) %&gt;%</span></span>
<span id="cb61-290"><a href="#cb61-290" aria-hidden="true" tabindex="-1"></a><span class="in">  rbind(c(" ", " ", " ", "SEM ", round(sd(the_df[1:10, 2]) / sqrt(10), digits =</span></span>
<span id="cb61-291"><a href="#cb61-291" aria-hidden="true" tabindex="-1"></a><span class="in">                                         2))) %&gt;%</span></span>
<span id="cb61-292"><a href="#cb61-292" aria-hidden="true" tabindex="-1"></a><span class="in">  rbind(c(" ", " ", " ", "t", (61 - 50) / round(sd(the_df[1:10, 2]) / sqrt(10), digits =</span></span>
<span id="cb61-293"><a href="#cb61-293" aria-hidden="true" tabindex="-1"></a><span class="in">                                                  2)))</span></span>
<span id="cb61-294"><a href="#cb61-294" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(the_df)</span></span>
<span id="cb61-295"><a href="#cb61-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-296"><a href="#cb61-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-297"><a href="#cb61-297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-298"><a href="#cb61-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-299"><a href="#cb61-299" aria-hidden="true" tabindex="-1"></a>You can see the <span class="in">`scores`</span> column has all of the test scores for each of the 10 students. We did the things we need to do to compute the standard deviation.</span>
<span id="cb61-300"><a href="#cb61-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-301"><a href="#cb61-301" aria-hidden="true" tabindex="-1"></a>Remember the sample standard deviation is the square root of the sample variance, or:</span>
<span id="cb61-302"><a href="#cb61-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-303"><a href="#cb61-303" aria-hidden="true" tabindex="-1"></a>$\text{sample standard deviation} = \sqrt{\frac{\sum_{i}^{n}({x_{i}-\bar{x})^2}}{N-1}}$</span>
<span id="cb61-304"><a href="#cb61-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-305"><a href="#cb61-305" aria-hidden="true" tabindex="-1"></a>$\text{sd} = \sqrt{\frac{2890}{10-1}} = 17.92$</span>
<span id="cb61-306"><a href="#cb61-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-307"><a href="#cb61-307" aria-hidden="true" tabindex="-1"></a>The standard error of the mean, is the standard deviation divided by the square root of N</span>
<span id="cb61-308"><a href="#cb61-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-309"><a href="#cb61-309" aria-hidden="true" tabindex="-1"></a>$\text{SEM} = \frac{s}{\sqrt{N}} = \frac{17.92}{10} = 5.67$</span>
<span id="cb61-310"><a href="#cb61-310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-311"><a href="#cb61-311" aria-hidden="true" tabindex="-1"></a>$t$ is the difference between our sample mean (61), and our population mean (50, assuming chance), divided by the standard error of the mean.</span>
<span id="cb61-312"><a href="#cb61-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-313"><a href="#cb61-313" aria-hidden="true" tabindex="-1"></a>$\text{t} = \frac{\bar{X}-u}{S_{\bar{X}}} = \frac{\bar{X}-u}{SEM} = \frac{61-50}{5.67} = 1.94$</span>
<span id="cb61-314"><a href="#cb61-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-315"><a href="#cb61-315" aria-hidden="true" tabindex="-1"></a>And, that is you how calculate $t$, by hand. It's a pain. I was annoyed doing it this way. In the lab, you learn how to calculate $t$ using software, so it will just spit out $t$. For example in R, all you have to do is this:</span>
<span id="cb61-316"><a href="#cb61-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-317"><a href="#cb61-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb61-318"><a href="#cb61-318" aria-hidden="true" tabindex="-1"></a><span class="in">t.test(scores, mu=50)</span></span>
<span id="cb61-319"><a href="#cb61-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-320"><a href="#cb61-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-321"><a href="#cb61-321" aria-hidden="true" tabindex="-1"></a><span class="fu">### How does t behave?</span></span>
<span id="cb61-322"><a href="#cb61-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-323"><a href="#cb61-323" aria-hidden="true" tabindex="-1"></a>If $t$ is just a number that we can compute from our sample (it is), what can we do with it? How can we use $t$ for statistical inference?</span>
<span id="cb61-324"><a href="#cb61-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-325"><a href="#cb61-325" aria-hidden="true" tabindex="-1"></a>Remember back to the chapter on sampling and distributions, that's where we discussed the sampling distribution of the sample mean. Remember, we made a lot of samples, then computed the mean for each sample, then we plotted a histogram of the sample means. Later, in that same section, we mentioned that we could generate sampling distributions for any statistic. For each sample, we could compute the mean, the standard deviation, the standard error, and now even $t$, if we wanted to. We could generate 10,000 samples, and draw four histograms, one for each sampling distribution for each statistic.</span>
<span id="cb61-326"><a href="#cb61-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-327"><a href="#cb61-327" aria-hidden="true" tabindex="-1"></a>This is exactly what I did, and the results are shown in the four panels of @fig-6sampdists below. I used a sample size of 20, and drew random observations for each sample from a normal distribution, with mean = 0, and standard deviation = 1. Let's look at the sampling distributions for each of the statistics. $t$ was computed assuming with the population mean assumed to be 0.</span>
<span id="cb61-328"><a href="#cb61-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-331"><a href="#cb61-331" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-332"><a href="#cb61-332" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6sampdists</span></span>
<span id="cb61-333"><a href="#cb61-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Sampling distributions for the mean, standard deviation, standard error of the mean, and $t$."</span></span>
<span id="cb61-334"><a href="#cb61-334" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb61-335"><a href="#cb61-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-336"><a href="#cb61-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-337"><a href="#cb61-337" aria-hidden="true" tabindex="-1"></a>all_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb61-338"><a href="#cb61-338" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10000</span>) {</span>
<span id="cb61-339"><a href="#cb61-339" aria-hidden="true" tabindex="-1"></a>  sample <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb61-340"><a href="#cb61-340" aria-hidden="true" tabindex="-1"></a>  sample_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(sample)</span>
<span id="cb61-341"><a href="#cb61-341" aria-hidden="true" tabindex="-1"></a>  sample_sd <span class="ot">&lt;-</span> <span class="fu">sd</span>(sample)</span>
<span id="cb61-342"><a href="#cb61-342" aria-hidden="true" tabindex="-1"></a>  sample_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(sample) <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">length</span>(sample))</span>
<span id="cb61-343"><a href="#cb61-343" aria-hidden="true" tabindex="-1"></a>  sample_t <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">t.test</span>(sample, <span class="at">mu =</span> <span class="dv">0</span>)<span class="sc">$</span>statistic)</span>
<span id="cb61-344"><a href="#cb61-344" aria-hidden="true" tabindex="-1"></a>  t_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(i, sample_mean, sample_sd, sample_se, sample_t)</span>
<span id="cb61-345"><a href="#cb61-345" aria-hidden="true" tabindex="-1"></a>  all_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(all_df, t_df)</span>
<span id="cb61-346"><a href="#cb61-346" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-347"><a href="#cb61-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-348"><a href="#cb61-348" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb61-349"><a href="#cb61-349" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_df, <span class="fu">aes</span>(<span class="at">x =</span> sample_mean)) <span class="sc">+</span></span>
<span id="cb61-350"><a href="#cb61-350" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb61-351"><a href="#cb61-351" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">20</span>)</span>
<span id="cb61-352"><a href="#cb61-352" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_df, <span class="fu">aes</span>(<span class="at">x =</span> sample_sd)) <span class="sc">+</span></span>
<span id="cb61-353"><a href="#cb61-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb61-354"><a href="#cb61-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">20</span>)</span>
<span id="cb61-355"><a href="#cb61-355" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_df, <span class="fu">aes</span>(<span class="at">x =</span> sample_se)) <span class="sc">+</span></span>
<span id="cb61-356"><a href="#cb61-356" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb61-357"><a href="#cb61-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">20</span>)</span>
<span id="cb61-358"><a href="#cb61-358" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(all_df, <span class="fu">aes</span>(<span class="at">x =</span> sample_t)) <span class="sc">+</span></span>
<span id="cb61-359"><a href="#cb61-359" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb61-360"><a href="#cb61-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">20</span>)</span>
<span id="cb61-361"><a href="#cb61-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-362"><a href="#cb61-362" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(a, b, c, d,</span>
<span id="cb61-363"><a href="#cb61-363" aria-hidden="true" tabindex="-1"></a>          <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb61-364"><a href="#cb61-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-365"><a href="#cb61-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-366"><a href="#cb61-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-367"><a href="#cb61-367" aria-hidden="true" tabindex="-1"></a>We see four sampling distributions. This is how statistical summaries of these summaries behave. We have used the word chance windows before. These are four chance windows, measuring different aspects of the sample. In this case, all of the samples came from the same normal distribution. Because of sampling error, each sample is not identical. The means are not identical, the standard deviations are not identical, sample standard error of the means are not identical, and the $t$s of the samples are not identical. They all have some variation, as shown by the histograms. This is how samples of size 20 behave.</span>
<span id="cb61-368"><a href="#cb61-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-369"><a href="#cb61-369" aria-hidden="true" tabindex="-1"></a>We can see straight away, that in this case, we are unlikely to get a sample mean of 2. That's way outside the window. The range for the sampling distribution of the mean is around -.5 to +.5, and is centered on 0 (the population mean, would you believe!).</span>
<span id="cb61-370"><a href="#cb61-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-371"><a href="#cb61-371" aria-hidden="true" tabindex="-1"></a>We are unlikely to get sample standard deviations of between .6 and 1.5, that is a different range, specific to the sample standard deviation.</span>
<span id="cb61-372"><a href="#cb61-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-373"><a href="#cb61-373" aria-hidden="true" tabindex="-1"></a>Same thing with the sample standard error of the mean, the range here is even smaller, mostly between .1, and .3. You would rarely find a sample with a standard error of the mean greater than .3. Virtually never would you find one of say 1 (for this situation).</span>
<span id="cb61-374"><a href="#cb61-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-375"><a href="#cb61-375" aria-hidden="true" tabindex="-1"></a>Now, look at $t$. It's range is basically between -3 and +3 here. 3s barely happen at all. You pretty much never see a 5 or -5 in this situation.</span>
<span id="cb61-376"><a href="#cb61-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-377"><a href="#cb61-377" aria-hidden="true" tabindex="-1"></a>All of these sampling windows are chance windows, and they can all be used in the same way as we have used similar sampling distributions before (e.g., Crump Test, and Randomization Test) for statistical inference. For all of them we would follow the same process:</span>
<span id="cb61-378"><a href="#cb61-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-379"><a href="#cb61-379" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Generate these distributions</span>
<span id="cb61-380"><a href="#cb61-380" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Look at your sample statistics for the data you have (mean, SD, SEM, and $t$)</span>
<span id="cb61-381"><a href="#cb61-381" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Find the likelihood of obtaining that value or greater</span>
<span id="cb61-382"><a href="#cb61-382" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Obtain that probability</span>
<span id="cb61-383"><a href="#cb61-383" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>See if you think your sample statistics were probable or improbable.</span>
<span id="cb61-384"><a href="#cb61-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-385"><a href="#cb61-385" aria-hidden="true" tabindex="-1"></a>We'll formalize this in a second. I just want you to know that what you will be doing is something that you have already done before. For example, in the Crump test and the Randomization test we focused on the distribution of mean differences. We could do that again here, but instead, we will focus on the distribution of $t$ values. We then apply the same kinds of decision rules to the $t$ distribution, as we did for the other distributions. Below you will see a graph you have already seen, except this time it is a distribution of $t$s, not mean differences:</span>
<span id="cb61-386"><a href="#cb61-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-387"><a href="#cb61-387" aria-hidden="true" tabindex="-1"></a>Remember, if we obtained a single $t$ from one sample we collected, we could consult the chance window in @fig-6tdecision below to find out whether the $t$ we obtained from the sample was likely or unlikely to occur by chance.</span>
<span id="cb61-388"><a href="#cb61-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-391"><a href="#cb61-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-392"><a href="#cb61-392" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6tdecision</span></span>
<span id="cb61-393"><a href="#cb61-393" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Applying decision criteria to the $t$-distribution. Histogram of $t$s from samples (n=20) drawn from the same normal distribution (u=0, sd=1)"</span></span>
<span id="cb61-394"><a href="#cb61-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-395"><a href="#cb61-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-396"><a href="#cb61-396" aria-hidden="true" tabindex="-1"></a>sample_t <span class="ot">&lt;-</span> all_df<span class="sc">$</span>sample_t</span>
<span id="cb61-397"><a href="#cb61-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-398"><a href="#cb61-398" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(all_df, <span class="fu">aes</span>(<span class="at">x =</span> sample_t)) <span class="sc">+</span></span>
<span id="cb61-399"><a href="#cb61-399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb61-400"><a href="#cb61-400" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb61-401"><a href="#cb61-401" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">min</span>(sample_t),</span>
<span id="cb61-402"><a href="#cb61-402" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">max</span>(sample_t),</span>
<span id="cb61-403"><a href="#cb61-403" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb61-404"><a href="#cb61-404" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb61-405"><a href="#cb61-405" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb61-406"><a href="#cb61-406" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"red"</span></span>
<span id="cb61-407"><a href="#cb61-407" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-408"><a href="#cb61-408" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb61-409"><a href="#cb61-409" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb61-410"><a href="#cb61-410" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">min</span>(sample_t),</span>
<span id="cb61-411"><a href="#cb61-411" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="sc">-</span><span class="fl">1.94</span>,</span>
<span id="cb61-412"><a href="#cb61-412" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb61-413"><a href="#cb61-413" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb61-414"><a href="#cb61-414" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb61-415"><a href="#cb61-415" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"light grey"</span></span>
<span id="cb61-416"><a href="#cb61-416" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-417"><a href="#cb61-417" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb61-418"><a href="#cb61-418" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb61-419"><a href="#cb61-419" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fl">1.94</span>,</span>
<span id="cb61-420"><a href="#cb61-420" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">max</span>(sample_t),</span>
<span id="cb61-421"><a href="#cb61-421" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb61-422"><a href="#cb61-422" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb61-423"><a href="#cb61-423" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.7</span>,</span>
<span id="cb61-424"><a href="#cb61-424" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"light grey"</span></span>
<span id="cb61-425"><a href="#cb61-425" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-426"><a href="#cb61-426" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(</span>
<span id="cb61-427"><a href="#cb61-427" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span><span class="cn">Inf</span>,</span>
<span id="cb61-428"><a href="#cb61-428" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">min</span>(sample_t),</span>
<span id="cb61-429"><a href="#cb61-429" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb61-430"><a href="#cb61-430" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span></span>
<span id="cb61-431"><a href="#cb61-431" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb61-432"><a href="#cb61-432" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb61-433"><a href="#cb61-433" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">"lightgreen"</span>) <span class="sc">+</span></span>
<span id="cb61-434"><a href="#cb61-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_rect</span>(<span class="fu">aes</span>(</span>
<span id="cb61-435"><a href="#cb61-435" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">max</span>(sample_t),</span>
<span id="cb61-436"><a href="#cb61-436" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="cn">Inf</span>,</span>
<span id="cb61-437"><a href="#cb61-437" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb61-438"><a href="#cb61-438" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span></span>
<span id="cb61-439"><a href="#cb61-439" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb61-440"><a href="#cb61-440" aria-hidden="true" tabindex="-1"></a>  <span class="at">alpha =</span> .<span class="dv">5</span>,</span>
<span id="cb61-441"><a href="#cb61-441" aria-hidden="true" tabindex="-1"></a>  <span class="at">fill =</span> <span class="st">"lightgreen"</span>) <span class="sc">+</span></span>
<span id="cb61-442"><a href="#cb61-442" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">50</span>, <span class="at">color =</span> <span class="st">"white"</span>) <span class="sc">+</span></span>
<span id="cb61-443"><a href="#cb61-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb61-444"><a href="#cb61-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">min</span>(sample_t)) <span class="sc">+</span></span>
<span id="cb61-445"><a href="#cb61-445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">max</span>(sample_t)) <span class="sc">+</span></span>
<span id="cb61-446"><a href="#cb61-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="sc">-</span><span class="fl">1.94</span>) <span class="sc">+</span></span>
<span id="cb61-447"><a href="#cb61-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fl">1.94</span>) <span class="sc">+</span></span>
<span id="cb61-448"><a href="#cb61-448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">8</span>, <span class="dv">8</span>) <span class="sc">+</span></span>
<span id="cb61-449"><a href="#cb61-449" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">250</span>, <span class="at">label =</span> <span class="st">"CHANCE"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-450"><a href="#cb61-450" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">7</span>, <span class="at">y =</span> <span class="dv">250</span>, <span class="at">label =</span> <span class="st">"NOT </span><span class="sc">\n</span><span class="st"> CHANCE"</span>),</span>
<span id="cb61-451"><a href="#cb61-451" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-452"><a href="#cb61-452" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">7</span>, <span class="at">y =</span> <span class="dv">250</span>, <span class="at">label =</span> <span class="st">"NOT </span><span class="sc">\n</span><span class="st"> CHANCE"</span>),</span>
<span id="cb61-453"><a href="#cb61-453" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-454"><a href="#cb61-454" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  geom_label(data = data.frame(x = min(sample_t), y = 600,</span></span>
<span id="cb61-455"><a href="#cb61-455" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                              label = paste0("min \n",round(min(sample_t)))),</span></span>
<span id="cb61-456"><a href="#cb61-456" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                             aes(x = x, y = y, label = label))+</span></span>
<span id="cb61-457"><a href="#cb61-457" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_label(data = data.frame(x = max(sample_t), y = 600,</span></span>
<span id="cb61-458"><a href="#cb61-458" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                            label = paste0("max \n",round(max(sample_t)))),</span></span>
<span id="cb61-459"><a href="#cb61-459" aria-hidden="true" tabindex="-1"></a>  <span class="co">#                           aes(x = x, y = y, label = label))+</span></span>
<span id="cb61-460"><a href="#cb61-460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">y =</span> <span class="dv">250</span>,</span>
<span id="cb61-461"><a href="#cb61-461" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> <span class="st">"?"</span>),</span>
<span id="cb61-462"><a href="#cb61-462" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-463"><a href="#cb61-463" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">4</span>, <span class="at">y =</span> <span class="dv">250</span>,</span>
<span id="cb61-464"><a href="#cb61-464" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> <span class="st">"?"</span>),</span>
<span id="cb61-465"><a href="#cb61-465" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-466"><a href="#cb61-466" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"mean sample_t"</span>)</span>
<span id="cb61-467"><a href="#cb61-467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-468"><a href="#cb61-468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-469"><a href="#cb61-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-470"><a href="#cb61-470" aria-hidden="true" tabindex="-1"></a><span class="fu">### Making a decision</span></span>
<span id="cb61-471"><a href="#cb61-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-472"><a href="#cb61-472" aria-hidden="true" tabindex="-1"></a>From our early example involving the TRUE/FALSE quizzes, we are now ready to make some kind of decision about what happened there. We found a mean difference of <span class="in">`r mean(scores)-50`</span>. We found a $t$ = <span class="in">`r t.test(scores, mu=50)$statistic`</span>. The probability of this $t$ or larger occurring is $p$ = <span class="in">`r t.test(scores, mu=50)$p.value`</span>. We were testing the idea that our sample mean of <span class="in">`r mean(scores)`</span> could have come from a normal distribution with mean = 50. The $t$ test tells us that the $t$ for our sample, or a larger one, would happen with p = <span class="in">`r t.test(scores, mu=50)$p.value`</span>. In other words, chance can do it a kind of small amount of time, but not often. In English, this means that all of the students could have been guessing, but it wasn't that likely that were just guessing.</span>
<span id="cb61-473"><a href="#cb61-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-474"><a href="#cb61-474" aria-hidden="true" tabindex="-1"></a>The next $t$-test is called a **paired samples t-test**. And, spoiler alert, we will find out that a paired samples t-test is actually a one-sample t-test in disguise (WHAT!), yes it is. If the one-sample $t$-test didn't make sense to you, read the next section.</span>
<span id="cb61-475"><a href="#cb61-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-476"><a href="#cb61-476" aria-hidden="true" tabindex="-1"></a><span class="fu">## Paired-samples t-test</span></span>
<span id="cb61-477"><a href="#cb61-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-478"><a href="#cb61-478" aria-hidden="true" tabindex="-1"></a>For me (Crump), many analyses often boil down to a paired samples t-test. It just happens that many things I do reduce down to a test like this.</span>
<span id="cb61-479"><a href="#cb61-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-480"><a href="#cb61-480" aria-hidden="true" tabindex="-1"></a>I am a cognitive psychologist, I conduct research about how people do things like remember, pay attention, and learn skills. There are lots of Psychologists like me, who do very similar things.</span>
<span id="cb61-481"><a href="#cb61-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-482"><a href="#cb61-482" aria-hidden="true" tabindex="-1"></a>We all often conduct the same kinds of experiments. They go like this, and they are called **repeated measures** designs. They are called **repeated measures** designs, because we measure how one person does something more than once, we **repeat** the measure.</span>
<span id="cb61-483"><a href="#cb61-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-484"><a href="#cb61-484" aria-hidden="true" tabindex="-1"></a>So, I might measure somebody doing something in condition A, and measure the same person doing something in Condition B, and then I see that same person does different things in the two conditions. I **repeatedly measure** the same person in both conditions. I am interested in whether the experimental manipulation changes something about how people perform the task in question.</span>
<span id="cb61-485"><a href="#cb61-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-486"><a href="#cb61-486" aria-hidden="true" tabindex="-1"></a><span class="fu">### Mehr, Song, and Spelke (2016)</span></span>
<span id="cb61-487"><a href="#cb61-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-488"><a href="#cb61-488" aria-hidden="true" tabindex="-1"></a>We will introduce the paired-samples t-test with an example using real data, from a real study. @mehr20165 were interested in whether singing songs to infants helps infants become more sensitive to social cues. For example, infants might need to learn to direct their attention toward people as a part of learning how to interact socially with people. Perhaps singing songs to infants aids this process of directing attention. When an infant hears a familiar song, they might start to pay more attention to the person singing that song, even after they are done singing the song. The person who sang the song might become more socially important to the infant. You will learn more about this study in the lab for this week. This example, prepares you for the lab activities. Here is a brief summary of what they did.</span>
<span id="cb61-489"><a href="#cb61-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-490"><a href="#cb61-490" aria-hidden="true" tabindex="-1"></a>First, parents were trained to sing a song to their infants. After many days of singing this song to the infants, a parent came into the lab with their infant. In the first session, parents sat with their infants on their knees, so the infant could watch two video presentations. There were two videos. Each video involved two unfamiliar new people the infant had never seen before. Each new person in the video (the singers) sang one song to the infant. One singer sang the "familiar" song the infant had learned from their parents. The other singer sang an "unfamiliar" song the infant had not hear before.</span>
<span id="cb61-491"><a href="#cb61-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-492"><a href="#cb61-492" aria-hidden="true" tabindex="-1"></a>There were two really important measurement phases: the baseline phase, and the test phase.</span>
<span id="cb61-493"><a href="#cb61-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-494"><a href="#cb61-494" aria-hidden="true" tabindex="-1"></a>The baseline phase occurred before the infants saw and heard each singer sing a song. During the baseline phase, the infants watched a video of both singers at the same time. The researchers recorded the proportion of time that the infant looked at each singer. The baseline phase was conducted to determine whether infants had a preference to look at either person (who would later sing them a song).</span>
<span id="cb61-495"><a href="#cb61-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-496"><a href="#cb61-496" aria-hidden="true" tabindex="-1"></a>The test phase occurred **after** infants saw and heard each song, sung by each singer. During the test phase, each infant had an opportunity to watch silent videos of both singers. The researchers measured the proportion of time the infants spent looking at each person. The question of interest, was whether the infants would spend a greater proportion of time looking at the singer who sang the familiar song, compared to the singer who sang the unfamiliar song.</span>
<span id="cb61-497"><a href="#cb61-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-498"><a href="#cb61-498" aria-hidden="true" tabindex="-1"></a>There is more than one way to describe the design of this study. We will describe it like this. It was a repeated measures design, with one independent (manipulation) variable called Viewing phase: Baseline versus Test. There was one dependent variable (the measurement), which was proportion looking time (to singer who sung familiar song). This was a repeated measures design because the researchers measured proportion looking time twice (they repeated the measure), once during baseline (before infants heard each singer sing a song), and again during test (after infants head each singer sing a song).</span>
<span id="cb61-499"><a href="#cb61-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-500"><a href="#cb61-500" aria-hidden="true" tabindex="-1"></a>The important question was whether infants would change their looking time, and look more at the singer who sang the familiar song during the test phase, than they did during the baseline phase. This is a question about a change within individual infants. In general, the possible outcomes for the study are:</span>
<span id="cb61-501"><a href="#cb61-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-502"><a href="#cb61-502" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>No change: The difference between looking time toward the singer of the familiar song during baseline and test is zero, no difference.</span>
<span id="cb61-503"><a href="#cb61-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-504"><a href="#cb61-504" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Positive change: Infants will look longer toward the singer of the familiar song during the test phase (after they saw and heard the singers), compared to the baseline phase (before they saw and heard the singers). This is a positive difference if we use the formula: Test Phase Looking time - Baseline phase looking time (to familiar song singer).</span>
<span id="cb61-505"><a href="#cb61-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-506"><a href="#cb61-506" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Negative change: Infants will look longer toward the singer of the unfamiliar song during the test phase (after they saw and heard the singers), compared to the baseline phase (before they saw and heard the singers). This is a negative difference if we use the same formula: Test Phase Looking time - Baseline phase looking time (to familiar song singer).</span>
<span id="cb61-507"><a href="#cb61-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-508"><a href="#cb61-508" aria-hidden="true" tabindex="-1"></a><span class="fu">### The data</span></span>
<span id="cb61-509"><a href="#cb61-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-510"><a href="#cb61-510" aria-hidden="true" tabindex="-1"></a>Let's take a look at the data for the first 5 infants in the study. This will help us better understand some properties of the data before we analyze it. We will see that the data is structured in a particular way that we can take advantage of with a paired samples t-test. Note, we look at the first 5 infants to show how the computations work. The results of the paired-samples t-test change when we use all of the data from the study.</span>
<span id="cb61-511"><a href="#cb61-511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-512"><a href="#cb61-512" aria-hidden="true" tabindex="-1"></a>Here is a table of the data:</span>
<span id="cb61-513"><a href="#cb61-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-514"><a href="#cb61-514" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb61-515"><a href="#cb61-515" aria-hidden="true" tabindex="-1"></a><span class="in">library(data.table)</span></span>
<span id="cb61-516"><a href="#cb61-516" aria-hidden="true" tabindex="-1"></a><span class="in">all_data &lt;- fread("data/MehrSongSpelke2016.csv")</span></span>
<span id="cb61-517"><a href="#cb61-517" aria-hidden="true" tabindex="-1"></a><span class="in">library(dplyr)</span></span>
<span id="cb61-518"><a href="#cb61-518" aria-hidden="true" tabindex="-1"></a><span class="in">experiment_one &lt;- all_data %&gt;% filter(exp1==1)</span></span>
<span id="cb61-519"><a href="#cb61-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-520"><a href="#cb61-520" aria-hidden="true" tabindex="-1"></a><span class="in">paired_sample_df &lt;-  data.frame(infant=1:5, </span></span>
<span id="cb61-521"><a href="#cb61-521" aria-hidden="true" tabindex="-1"></a><span class="in">                               Baseline = round(experiment_one$Baseline_Proportion_Gaze_to_Singer[1:5],digits=2), </span></span>
<span id="cb61-522"><a href="#cb61-522" aria-hidden="true" tabindex="-1"></a><span class="in">                               Test = round(experiment_one$Test_Proportion_Gaze_to_Singer[1:5], digits=2))</span></span>
<span id="cb61-523"><a href="#cb61-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-524"><a href="#cb61-524" aria-hidden="true" tabindex="-1"></a><span class="in"># mean_scores &lt;- mean(scores)</span></span>
<span id="cb61-525"><a href="#cb61-525" aria-hidden="true" tabindex="-1"></a><span class="in"># Difference_from_Mean &lt;- scores-mean_scores</span></span>
<span id="cb61-526"><a href="#cb61-526" aria-hidden="true" tabindex="-1"></a><span class="in"># Squared_Deviations &lt;- Difference_from_Mean^2</span></span>
<span id="cb61-527"><a href="#cb61-527" aria-hidden="true" tabindex="-1"></a><span class="in"># the_df&lt;-data.frame(students,</span></span>
<span id="cb61-528"><a href="#cb61-528" aria-hidden="true" tabindex="-1"></a><span class="in">#                    scores,</span></span>
<span id="cb61-529"><a href="#cb61-529" aria-hidden="true" tabindex="-1"></a><span class="in">#                    mean=rep(mean_scores,10),</span></span>
<span id="cb61-530"><a href="#cb61-530" aria-hidden="true" tabindex="-1"></a><span class="in">#                    Difference_from_Mean,</span></span>
<span id="cb61-531"><a href="#cb61-531" aria-hidden="true" tabindex="-1"></a><span class="in">#                    Squared_Deviations)</span></span>
<span id="cb61-532"><a href="#cb61-532" aria-hidden="true" tabindex="-1"></a><span class="in"># </span></span>
<span id="cb61-533"><a href="#cb61-533" aria-hidden="true" tabindex="-1"></a><span class="in"># the_df &lt;- the_df %&gt;%</span></span>
<span id="cb61-534"><a href="#cb61-534" aria-hidden="true" tabindex="-1"></a><span class="in">#   rbind(c("Sums",colSums(the_df[1:10,2:5]))) %&gt;%</span></span>
<span id="cb61-535"><a href="#cb61-535" aria-hidden="true" tabindex="-1"></a><span class="in">#   rbind(c("Means",colMeans(the_df[1:10,2:5]))) %&gt;%</span></span>
<span id="cb61-536"><a href="#cb61-536" aria-hidden="true" tabindex="-1"></a><span class="in">#   rbind(c(" "," "," ","sd ",round(sd(the_df[1:10,2]),digits=2))) %&gt;%</span></span>
<span id="cb61-537"><a href="#cb61-537" aria-hidden="true" tabindex="-1"></a><span class="in">#   rbind(c(" "," "," ","SEM ",round(sd(the_df[1:10,2])/sqrt(10), digits=2))) %&gt;%</span></span>
<span id="cb61-538"><a href="#cb61-538" aria-hidden="true" tabindex="-1"></a><span class="in">#   rbind(c(" "," "," ","t",(61-50)/round(sd(the_df[1:10,2])/sqrt(10), digits=2)))</span></span>
<span id="cb61-539"><a href="#cb61-539" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(paired_sample_df)</span></span>
<span id="cb61-540"><a href="#cb61-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-541"><a href="#cb61-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-542"><a href="#cb61-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-543"><a href="#cb61-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-544"><a href="#cb61-544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-545"><a href="#cb61-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-546"><a href="#cb61-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-547"><a href="#cb61-547" aria-hidden="true" tabindex="-1"></a>The table shows proportion looking times toward the singer of the familiar song during the Baseline and Test phases. Notice there are five different infants, (1 to 5). Each infant is measured twice, once during the Baseline phase, and once during the Test phase. To repeat from before, this is a repeated-measures design, because the infants are measured repeatedly (twice in this case). Or, this kind of design is also called a **paired-samples** design. Why? because each participant comes with a pair of samples (two samples), one for each level of the design.</span>
<span id="cb61-548"><a href="#cb61-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-549"><a href="#cb61-549" aria-hidden="true" tabindex="-1"></a>Great, so what are we really interested in here? We want to know if the mean looking time toward the singer of the familiar song for the Test phase is higher than the Baseline phase. We are comparing the two sample means against each other and looking for a difference. We already know that differences could be obtained by chance alone, simply because we took two sets of samples, and we know that samples can be different. So, we are interested in knowing whether chance was likely or unlikely to have produced any difference we might observe.</span>
<span id="cb61-550"><a href="#cb61-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-551"><a href="#cb61-551" aria-hidden="true" tabindex="-1"></a>In other words, we are interested in looking at the difference scores between the baseline and test phase for each infant. The question here is, for each infant, did their proportion looking time to the singer of the familiar song, increase during the test phase as compared to the baseline phase.</span>
<span id="cb61-552"><a href="#cb61-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-553"><a href="#cb61-553" aria-hidden="true" tabindex="-1"></a><span class="fu">### The difference scores</span></span>
<span id="cb61-554"><a href="#cb61-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-555"><a href="#cb61-555" aria-hidden="true" tabindex="-1"></a>Let's add the difference scores to the table of data so it is easier to see what we are talking about. The first step in creating difference scores is to decide how you will take the difference, there are two options:</span>
<span id="cb61-556"><a href="#cb61-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-557"><a href="#cb61-557" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Test phase score - Baseline Phase Score</span>
<span id="cb61-558"><a href="#cb61-558" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Baseline phase score - Test Phase score</span>
<span id="cb61-559"><a href="#cb61-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-560"><a href="#cb61-560" aria-hidden="true" tabindex="-1"></a>Let's use the first formula. Why? Because it will give us positive differences when the test phase score is higher than the baseline phase score. This makes a positive score meaningful with respect to the study design, we know (because we defined it to be this way), that positive scores will refer to longer proportion looking times (to singer of familiar song) during the test phase compared to the baseline phase.</span>
<span id="cb61-561"><a href="#cb61-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-564"><a href="#cb61-564" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-565"><a href="#cb61-565" aria-hidden="true" tabindex="-1"></a>paired_sample_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(paired_sample_df, </span>
<span id="cb61-566"><a href="#cb61-566" aria-hidden="true" tabindex="-1"></a>                          <span class="at">differences =</span> (paired_sample_df<span class="sc">$</span>Test<span class="sc">-</span></span>
<span id="cb61-567"><a href="#cb61-567" aria-hidden="true" tabindex="-1"></a>                                           paired_sample_df<span class="sc">$</span>Baseline))</span>
<span id="cb61-568"><a href="#cb61-568" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(paired_sample_df)</span>
<span id="cb61-569"><a href="#cb61-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-570"><a href="#cb61-570" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-571"><a href="#cb61-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-572"><a href="#cb61-572" aria-hidden="true" tabindex="-1"></a>There we have it, the difference scores. The first thing we can do here is look at the difference scores, and ask how many infants showed the effect of interest. Specifically, how many infants showed a positive difference score. We can see that three of five infants showed a positive difference (they looked more at the singer of the familiar song during the test than baseline phase), and two the infants showed the opposite effect (negative difference, they looked more at the singer of the familiar song during baseline than test).</span>
<span id="cb61-573"><a href="#cb61-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-574"><a href="#cb61-574" aria-hidden="true" tabindex="-1"></a><span class="fu">### The mean difference</span></span>
<span id="cb61-575"><a href="#cb61-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-576"><a href="#cb61-576" aria-hidden="true" tabindex="-1"></a>As we have been discussing, the effect of interest in this study is the mean difference between the baseline and test phase proportion looking times. We can calculate the **mean difference**, by finding the **mean of the difference scores**. Let's do that, in fact, for fun let's calculate the mean of the baseline scores, the test scores, and the difference scores.</span>
<span id="cb61-577"><a href="#cb61-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-580"><a href="#cb61-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-581"><a href="#cb61-581" aria-hidden="true" tabindex="-1"></a>paired_sample_df <span class="ot">&lt;-</span> paired_sample_df <span class="sc">%&gt;%</span></span>
<span id="cb61-582"><a href="#cb61-582" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">"Sums"</span>,<span class="fu">colSums</span>(paired_sample_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>]))) <span class="sc">%&gt;%</span></span>
<span id="cb61-583"><a href="#cb61-583" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="st">"Means"</span>,<span class="fu">colMeans</span>(paired_sample_df[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>])))</span>
<span id="cb61-584"><a href="#cb61-584" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb61-585"><a href="#cb61-585" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(paired_sample_df)</span>
<span id="cb61-586"><a href="#cb61-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-587"><a href="#cb61-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-588"><a href="#cb61-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-589"><a href="#cb61-589" aria-hidden="true" tabindex="-1"></a>We can see there was a positive mean difference of 0.054, between the test and baseline phases.</span>
<span id="cb61-590"><a href="#cb61-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-591"><a href="#cb61-591" aria-hidden="true" tabindex="-1"></a>Can we rush to judgment and conclude that infants are more socially attracted to individuals who have sung them a familiar song? I would hope not based on this very small sample. First, the difference in proportion looking isn't very large, and of course we recognize that this difference could have been produced by chance.</span>
<span id="cb61-592"><a href="#cb61-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-593"><a href="#cb61-593" aria-hidden="true" tabindex="-1"></a>We will more formally evaluate whether this difference could have been caused by chance with the paired-samples t-test. But, before we do that, let's again calculate $t$ and discuss what $t$ tells us over and above what our measure of the mean of the difference scores tells us.</span>
<span id="cb61-594"><a href="#cb61-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-595"><a href="#cb61-595" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calculate t</span></span>
<span id="cb61-596"><a href="#cb61-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-597"><a href="#cb61-597" aria-hidden="true" tabindex="-1"></a>OK, so how do we calculate $t$ for a paired-samples $t$-test? Surprise, we use the one-sample t-test formula that you already learned about! Specifically, we use the one-sample $t$-test formula on the difference scores. We have one sample of difference scores (you can see they are in one column), so we can use the one-sample $t$-test on the difference scores. Specifically, we are interested in comparing whether the mean of our difference scores came from a distribution with mean difference = 0. This is a special distribution we refer to as the **null distribution**. It is the distribution no differences. Of course, this **null distribution** can produce differences due to to sampling error, but those differences are not caused by any experimental manipulation, they caused by the random sampling process.</span>
<span id="cb61-598"><a href="#cb61-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-599"><a href="#cb61-599" aria-hidden="true" tabindex="-1"></a>We calculate $t$ in a moment. Let's now consider again why we want to calculate $t$? Why don't we just stick with the mean difference we already have?</span>
<span id="cb61-600"><a href="#cb61-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-601"><a href="#cb61-601" aria-hidden="true" tabindex="-1"></a>Remember, the whole concept behind $t$, is that it gives an indication of how confident we should be in our mean. Remember, $t$ involves a measure of the mean in the numerator, divided by a measure of variation (standard error of the sample mean) in the denominator. The resulting $t$ value is small when the mean difference is small, or when the variation is large. So small $t$-values tell us that we shouldn't be that confident in the estimate of our mean difference. Large $t$-values occur when the mean difference is large and/or when the measure of variation is small. So, large $t$-values tell us that we can be more confident in the estimate of our mean difference. Let's find $t$ for the mean difference scores. We use the same formulas as we did last time:</span>
<span id="cb61-602"><a href="#cb61-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-603"><a href="#cb61-603" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb61-604"><a href="#cb61-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-605"><a href="#cb61-605" aria-hidden="true" tabindex="-1"></a><span class="in">paired_sample_df &lt;-  data.frame(infant=1:5, </span></span>
<span id="cb61-606"><a href="#cb61-606" aria-hidden="true" tabindex="-1"></a><span class="in">                               Baseline = round(experiment_one$Baseline_Proportion_Gaze_to_Singer[1:5],digits=2), </span></span>
<span id="cb61-607"><a href="#cb61-607" aria-hidden="true" tabindex="-1"></a><span class="in">                               Test = round(experiment_one$Test_Proportion_Gaze_to_Singer[1:5], digits=2))</span></span>
<span id="cb61-608"><a href="#cb61-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-609"><a href="#cb61-609" aria-hidden="true" tabindex="-1"></a><span class="in">differences &lt;-  paired_sample_df$Test-paired_sample_df$Baseline</span></span>
<span id="cb61-610"><a href="#cb61-610" aria-hidden="true" tabindex="-1"></a><span class="in">diff_from_mean &lt;- differences-mean(differences)</span></span>
<span id="cb61-611"><a href="#cb61-611" aria-hidden="true" tabindex="-1"></a><span class="in">Squared_differences &lt;- diff_from_mean^2</span></span>
<span id="cb61-612"><a href="#cb61-612" aria-hidden="true" tabindex="-1"></a><span class="in">paired_sample_df &lt;- cbind(paired_sample_df, </span></span>
<span id="cb61-613"><a href="#cb61-613" aria-hidden="true" tabindex="-1"></a><span class="in">                          differences,</span></span>
<span id="cb61-614"><a href="#cb61-614" aria-hidden="true" tabindex="-1"></a><span class="in">                          diff_from_mean,</span></span>
<span id="cb61-615"><a href="#cb61-615" aria-hidden="true" tabindex="-1"></a><span class="in">                          Squared_differences)</span></span>
<span id="cb61-616"><a href="#cb61-616" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb61-617"><a href="#cb61-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-618"><a href="#cb61-618" aria-hidden="true" tabindex="-1"></a><span class="in"> paired_sample_df &lt;- paired_sample_df %&gt;%</span></span>
<span id="cb61-619"><a href="#cb61-619" aria-hidden="true" tabindex="-1"></a><span class="in">   rbind(c("Sums",colSums(paired_sample_df[1:5,2:6]))) %&gt;%</span></span>
<span id="cb61-620"><a href="#cb61-620" aria-hidden="true" tabindex="-1"></a><span class="in">   rbind(c("Means",colMeans(paired_sample_df[1:5,2:6]))) %&gt;%</span></span>
<span id="cb61-621"><a href="#cb61-621" aria-hidden="true" tabindex="-1"></a><span class="in">   rbind(c(" "," "," "," ","sd ",round(sd(paired_sample_df[1:5,4]),digits=3))) %&gt;%</span></span>
<span id="cb61-622"><a href="#cb61-622" aria-hidden="true" tabindex="-1"></a><span class="in">   rbind(c(" "," "," "," ","SEM ",round(sd(paired_sample_df[1:5,4])/sqrt(5), digits=3))) %&gt;%</span></span>
<span id="cb61-623"><a href="#cb61-623" aria-hidden="true" tabindex="-1"></a><span class="in">   rbind(c(" "," "," "," ","t",mean(differences)/round(sd(paired_sample_df[1:5,4])/sqrt(5), digits=3)))</span></span>
<span id="cb61-624"><a href="#cb61-624" aria-hidden="true" tabindex="-1"></a><span class="in"> paired_sample_df[6,5]&lt;-0</span></span>
<span id="cb61-625"><a href="#cb61-625" aria-hidden="true" tabindex="-1"></a><span class="in">  paired_sample_df[7,5]&lt;-0</span></span>
<span id="cb61-626"><a href="#cb61-626" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(paired_sample_df)</span></span>
<span id="cb61-627"><a href="#cb61-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-628"><a href="#cb61-628" aria-hidden="true" tabindex="-1"></a><span class="in">#t.test(round(differences, digits=2), mu=0)$statistic</span></span>
<span id="cb61-629"><a href="#cb61-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-630"><a href="#cb61-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-631"><a href="#cb61-631" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-632"><a href="#cb61-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-633"><a href="#cb61-633" aria-hidden="true" tabindex="-1"></a>If we did this test using R, we would obtain almost the same numbers (there is a little bit of rounding in the table).</span>
<span id="cb61-634"><a href="#cb61-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-637"><a href="#cb61-637" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-638"><a href="#cb61-638" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(differences,<span class="at">mu=</span><span class="dv">0</span>)</span>
<span id="cb61-639"><a href="#cb61-639" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-640"><a href="#cb61-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-641"><a href="#cb61-641" aria-hidden="true" tabindex="-1"></a>Here is a quick write up of our t-test results, t(4) = .72, p = .509.</span>
<span id="cb61-642"><a href="#cb61-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-643"><a href="#cb61-643" aria-hidden="true" tabindex="-1"></a>What does all of that tell us? There's a few things we haven't gotten into much yet. For example, the 4 represents degrees of freedom, which we discuss later. The important part, the $t$ value should start to be a little bit more meaningful. We got a kind of small t-value didn't we. It's .72. What can we tell from this value? First, it is positive, so we know the mean difference is positive. The sign of the $t$-value is always the same as the sign of the mean difference (ours was +0.054). We can also see that the p-value was .509. We've seen p-values before. This tells us that our $t$ value or larger, occurs about 50.9% of the time... Actually it means more than this. And, to understand it, we need to talk about the concept of two-tailed and one-tailed tests.</span>
<span id="cb61-644"><a href="#cb61-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-645"><a href="#cb61-645" aria-hidden="true" tabindex="-1"></a><span class="fu">### Interpreting $t$s</span></span>
<span id="cb61-646"><a href="#cb61-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-647"><a href="#cb61-647" aria-hidden="true" tabindex="-1"></a>Remember what it is we are doing here. We are evaluating whether our sample data could have come from a particular kind of distribution. The null distribution of no differences. This is the distribution of $t$-values that would occur for samples of size 5, with a mean difference of 0, and a standard error of the sample mean of .075 (this is the SEM that we calculated from our sample). We can see what this particular null-distribution looks like in @fig-6tnull.</span>
<span id="cb61-648"><a href="#cb61-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-651"><a href="#cb61-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-652"><a href="#cb61-652" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6tnull</span></span>
<span id="cb61-653"><a href="#cb61-653" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "A distribution of $t$-values that can occur by chance alone, when there is no difference between the sample and a population"</span></span>
<span id="cb61-654"><a href="#cb61-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-655"><a href="#cb61-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-656"><a href="#cb61-656" aria-hidden="true" tabindex="-1"></a>range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, .<span class="dv">1</span>)</span>
<span id="cb61-657"><a href="#cb61-657" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> <span class="fu">dt</span>(range, <span class="dv">4</span>, <span class="at">log =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-658"><a href="#cb61-658" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(range, null_distribution)</span>
<span id="cb61-659"><a href="#cb61-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-660"><a href="#cb61-660" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> range, <span class="at">y =</span> null_distribution)) <span class="sc">+</span></span>
<span id="cb61-661"><a href="#cb61-661" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb61-662"><a href="#cb61-662" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t-values"</span>) <span class="sc">+</span></span>
<span id="cb61-663"><a href="#cb61-663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb61-664"><a href="#cb61-664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb61-665"><a href="#cb61-665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> (<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, .<span class="dv">5</span>))) <span class="sc">+</span></span>
<span id="cb61-666"><a href="#cb61-666" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="sc">-</span>.<span class="dv">7</span>, <span class="at">y =</span> .<span class="dv">1</span>, <span class="at">label =</span> <span class="st">"50% </span><span class="sc">\n</span><span class="st"> (-)"</span>),</span>
<span id="cb61-667"><a href="#cb61-667" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-668"><a href="#cb61-668" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> .<span class="dv">7</span>, <span class="at">y =</span> .<span class="dv">1</span>, <span class="at">label =</span> <span class="st">"50% </span><span class="sc">\n</span><span class="st"> (+)"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-669"><a href="#cb61-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>)<span class="sc">+</span></span>
<span id="cb61-670"><a href="#cb61-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">20</span>)</span>
<span id="cb61-671"><a href="#cb61-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-672"><a href="#cb61-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-673"><a href="#cb61-673" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-674"><a href="#cb61-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-675"><a href="#cb61-675" aria-hidden="true" tabindex="-1"></a>The $t$-distribution above shows us the kinds of values $t$ will will take by chance alone, when we measure the mean differences for pairs of 5 samples (like our current). $t$ is most likely to be zero, which is good, because we are looking at the distribution of no-differences, which should most often be 0! But, sometimes, due to sampling error, we can get $t$s that are bigger than 0, either in the positive or negative direction. Notice the distribution is symmetrical, a $t$ from the null-distribution will be positive half of the time, and negative half of the time, that is what we would expect by chance.</span>
<span id="cb61-676"><a href="#cb61-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-677"><a href="#cb61-677" aria-hidden="true" tabindex="-1"></a>So, what kind of information do we want know when we find a particular $t$ value from our sample? We want to know how likely the $t$ value like the one we found occurs just by chance. This is actually a subtly nuanced kind of question. For example, any particular $t$ value doesn't have a specific probability of occurring. When we talk about probabilities, we are talking about ranges of probabilities. Let's consider some probabilities. We will use the letter $p$, to talk about the probabilities of particular $t$ values.</span>
<span id="cb61-678"><a href="#cb61-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-679"><a href="#cb61-679" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>What is the probability that $t$ is zero or positive or negative? The answer is p=1, or 100%. We will always have a $t$ value that is zero or non-zero...Actually, if we can't compute the t-value, for example when the standard deviation is undefined, I guess then we would have a non-number. But, assuming we can calculate $t$, then it will always be 0 or positive or negative.</span>
<span id="cb61-680"><a href="#cb61-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-681"><a href="#cb61-681" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>What is the probability of $t$ = 0 or greater than 0? The answer is p=.5, or 50%. 50% of $t$-values are 0 or greater.</span>
<span id="cb61-682"><a href="#cb61-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-683"><a href="#cb61-683" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>What is the of $t$ = 0 or smaller than 0? The answer is p=.5, or 50%. 50% of $t$-values are 0 or smaller.</span>
<span id="cb61-684"><a href="#cb61-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-685"><a href="#cb61-685" aria-hidden="true" tabindex="-1"></a>We can answer all of those questions just by looking at our t-distribution, and dividing it into two equal regions, the left side (containing 50% of the $t$ values), and the right side containing 50% of the $t$-values).</span>
<span id="cb61-686"><a href="#cb61-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-687"><a href="#cb61-687" aria-hidden="true" tabindex="-1"></a>What if we wanted to take a more fine-grained approach, let's say we were interested in regions of 10%. What kinds of $t$s occur 10% of the time. We would apply lines like the following. Notice, the likelihood of bigger numbers (positive or negative) gets smaller, so we have to increase the width of the bars for each of the intervals between the bars to contain 10% of the $t$-values, it looks like @fig-6percentregions.</span>
<span id="cb61-688"><a href="#cb61-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-691"><a href="#cb61-691" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-692"><a href="#cb61-692" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6percentregions</span></span>
<span id="cb61-693"><a href="#cb61-693" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Splitting the t distribution up into regions each containing 10% of the $t$-values. The width between the bars narrows as they approach the center of the distribution, where there are more $t$-values."</span></span>
<span id="cb61-694"><a href="#cb61-694" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb61-695"><a href="#cb61-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-696"><a href="#cb61-696" aria-hidden="true" tabindex="-1"></a>range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, .<span class="dv">1</span>)</span>
<span id="cb61-697"><a href="#cb61-697" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> <span class="fu">dt</span>(range, <span class="dv">4</span>, <span class="at">log =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-698"><a href="#cb61-698" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(range, null_distribution)</span>
<span id="cb61-699"><a href="#cb61-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-700"><a href="#cb61-700" aria-hidden="true" tabindex="-1"></a>t_ps <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), <span class="dv">4</span>)</span>
<span id="cb61-701"><a href="#cb61-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-702"><a href="#cb61-702" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> range, <span class="at">y =</span> null_distribution)) <span class="sc">+</span></span>
<span id="cb61-703"><a href="#cb61-703" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb61-704"><a href="#cb61-704" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t-values"</span>) <span class="sc">+</span></span>
<span id="cb61-705"><a href="#cb61-705" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb61-706"><a href="#cb61-706" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> t_ps) <span class="sc">+</span></span>
<span id="cb61-707"><a href="#cb61-707" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb61-708"><a href="#cb61-708" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb61-709"><a href="#cb61-709" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">round</span>(t_ps, <span class="at">digits =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb61-710"><a href="#cb61-710" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">2.5</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"10%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-711"><a href="#cb61-711" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">1.3</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"10%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-712"><a href="#cb61-712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"10%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-713"><a href="#cb61-713" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fl">1.3</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"10%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label))</span>
<span id="cb61-714"><a href="#cb61-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-715"><a href="#cb61-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-716"><a href="#cb61-716" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-717"><a href="#cb61-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-718"><a href="#cb61-718" aria-hidden="true" tabindex="-1"></a>Consider the probabilities ($p$) of $t$ for the different ranges.</span>
<span id="cb61-719"><a href="#cb61-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-720"><a href="#cb61-720" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>$t$ <span class="sc">\&lt;</span>= -1.5 ($t$ is less than or equal to -1.5), $p$ = 10%</span>
<span id="cb61-721"><a href="#cb61-721" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>-1.5 <span class="sc">\&gt;</span>= $t$ <span class="sc">\&lt;</span>= -0.9 ($t$ is equal to or between -1.5 and -.9), $p$ = 10%</span>
<span id="cb61-722"><a href="#cb61-722" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>-.9 <span class="sc">\&gt;</span>= $t$ <span class="sc">\&lt;</span>= -0.6 ($t$ is equal to or between -.9 and -.6), $p$ = 10%</span>
<span id="cb61-723"><a href="#cb61-723" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>$t$ <span class="sc">\&gt;</span>= 1.5 ($t$ is greater than or equal to 1.5), $p$ = 10%</span>
<span id="cb61-724"><a href="#cb61-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-725"><a href="#cb61-725" aria-hidden="true" tabindex="-1"></a>Notice, that the $p$s are always 10%. $t$s occur in these ranges with 10% probability.</span>
<span id="cb61-726"><a href="#cb61-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-727"><a href="#cb61-727" aria-hidden="true" tabindex="-1"></a><span class="fu">### Getting the p-values for $t$-values</span></span>
<span id="cb61-728"><a href="#cb61-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-729"><a href="#cb61-729" aria-hidden="true" tabindex="-1"></a>You might be wondering where I am getting some of these values from. For example, how do I know that 10% of $t$ values (for this null distribution) have a value of approximately 1.5 or greater than 1.5? The answer is I used R to tell me.</span>
<span id="cb61-730"><a href="#cb61-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-731"><a href="#cb61-731" aria-hidden="true" tabindex="-1"></a>In most statistics textbooks the answer would be: there is a table at the back of the book where you can look these things up...This textbook has no such table. We could make one for you. And, we might do that. But, we didn't do that yet...</span>
<span id="cb61-732"><a href="#cb61-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-733"><a href="#cb61-733" aria-hidden="true" tabindex="-1"></a>So, where do these values come from, how can you figure out what they are? The complicated answer is that we are not going to explain the math behind finding these values because, 1) the authors (some of us) admittedly don't know the math well enough to explain it, and 2) it would sidetrack us to much, 3) you will learn how to get these numbers in the lab with software, 4) you will learn how to get these numbers in lab without the math, just by doing a simulation, and 5) you can do it in R, or excel, or you can use an <span class="co">[</span><span class="ot">online calculator</span><span class="co">](http://www.socscistatistics.com/pvalues/tdistribution.aspx)</span>.</span>
<span id="cb61-734"><a href="#cb61-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-735"><a href="#cb61-735" aria-hidden="true" tabindex="-1"></a>This is all to say that you can find the $t$s and their associated $p$s using software. But, the software won't tell you what these values mean. That's we are doing here. You will also see that software wants to know a few more things from you, such as the degrees of freedom for the test, and whether the test is one-tailed or two tailed. We haven't explained any of these things yet. That's what we are going to do now. Note, we explain degrees of freedom last. First, we start with a one-tailed test.</span>
<span id="cb61-736"><a href="#cb61-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-737"><a href="#cb61-737" aria-hidden="true" tabindex="-1"></a><span class="fu">### One-tailed tests</span></span>
<span id="cb61-738"><a href="#cb61-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-739"><a href="#cb61-739" aria-hidden="true" tabindex="-1"></a>A **one-tailed test** is sometimes also called a directional test. It is called a directional test, because a researcher might have a hypothesis in mind suggesting that the difference they observe in their means is going to have a particular direction, either a positive difference, or a negative difference.</span>
<span id="cb61-740"><a href="#cb61-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-741"><a href="#cb61-741" aria-hidden="true" tabindex="-1"></a>Typically, a researcher would set an **alpha criterion**. The alpha criterion describes a line in the sand for the researcher. Often, the alpha criterion is set at $p = .05$. What does this mean? @fig-6critT shows the $t$-distribution and the alpha criterion.</span>
<span id="cb61-742"><a href="#cb61-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-745"><a href="#cb61-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-746"><a href="#cb61-746" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6critT</span></span>
<span id="cb61-747"><a href="#cb61-747" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "The critical value of t for an alpha criterion of 0.05. 5% of all ts are at this value or larger"</span></span>
<span id="cb61-748"><a href="#cb61-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-749"><a href="#cb61-749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-750"><a href="#cb61-750" aria-hidden="true" tabindex="-1"></a>range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, .<span class="dv">1</span>)</span>
<span id="cb61-751"><a href="#cb61-751" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> <span class="fu">dt</span>(range, <span class="dv">4</span>, <span class="at">log =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-752"><a href="#cb61-752" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(range, null_distribution)</span>
<span id="cb61-753"><a href="#cb61-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-754"><a href="#cb61-754" aria-hidden="true" tabindex="-1"></a>t_ps <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), <span class="dv">4</span>)</span>
<span id="cb61-755"><a href="#cb61-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-756"><a href="#cb61-756" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> range, <span class="at">y =</span> null_distribution)) <span class="sc">+</span></span>
<span id="cb61-757"><a href="#cb61-757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb61-758"><a href="#cb61-758" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t-values"</span>) <span class="sc">+</span></span>
<span id="cb61-759"><a href="#cb61-759" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb61-760"><a href="#cb61-760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb61-761"><a href="#cb61-761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Critical t for one-tailed test"</span>) <span class="sc">+</span></span>
<span id="cb61-762"><a href="#cb61-762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb61-763"><a href="#cb61-763" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb61-764"><a href="#cb61-764" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb61-765"><a href="#cb61-765" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb61-766"><a href="#cb61-766" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-767"><a href="#cb61-767" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="dv">3</span>,</span>
<span id="cb61-768"><a href="#cb61-768" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb61-769"><a href="#cb61-769" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb61-770"><a href="#cb61-770" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb61-771"><a href="#cb61-771" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"green"</span></span>
<span id="cb61-772"><a href="#cb61-772" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-773"><a href="#cb61-773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"5%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-774"><a href="#cb61-774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb61-775"><a href="#cb61-775" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-776"><a href="#cb61-776" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">3</span>,</span>
<span id="cb61-777"><a href="#cb61-777" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Critical t"</span></span>
<span id="cb61-778"><a href="#cb61-778" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb61-779"><a href="#cb61-779" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-780"><a href="#cb61-780" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb61-781"><a href="#cb61-781" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-782"><a href="#cb61-782" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb61-783"><a href="#cb61-783" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span></span>
<span id="cb61-784"><a href="#cb61-784" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span>)</span>
<span id="cb61-785"><a href="#cb61-785" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb61-786"><a href="#cb61-786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label))</span>
<span id="cb61-787"><a href="#cb61-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-788"><a href="#cb61-788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-789"><a href="#cb61-789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-790"><a href="#cb61-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-791"><a href="#cb61-791" aria-hidden="true" tabindex="-1"></a>The figure shows that $t$ values of +2.13 or greater occur 5% of the time. Because the t-distribution is symmetrical, we also know that $t$ values of -2.13 or smaller also occur 5% of the time. Both of these properties are true under the null distribution of no differences. This means, that when there really are no differences, a researcher can expect to find $t$ values of 2.13 or larger 5% of the time.</span>
<span id="cb61-792"><a href="#cb61-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-793"><a href="#cb61-793" aria-hidden="true" tabindex="-1"></a>Let's review and connect some of the terms:</span>
<span id="cb61-794"><a href="#cb61-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-795"><a href="#cb61-795" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**alpha criterion**: the criterion set by the researcher to make decisions about whether they believe chance did or did not cause the difference. The alpha criterion here is set to $p = .05$.</span>
<span id="cb61-796"><a href="#cb61-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-797"><a href="#cb61-797" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Critical** $t$. The critical $t$ is the $t$-value associated with the alpha-criterion. In this case for a one-tailed test, it is the $t$ value where 5% of all $t$s are this number or greater. In our example, the critical $t$ is 2.13. 5% of all $t$ values (with degrees of freedom = 4) are +2.13, or greater than +2.13.</span>
<span id="cb61-798"><a href="#cb61-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-799"><a href="#cb61-799" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Observed** $t$. The observed $t$ is the one that you calculated from your sample. In our example about the infants, the observed $t$ was $t$ (4) = 0.72.</span>
<span id="cb61-800"><a href="#cb61-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-801"><a href="#cb61-801" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**p-value**. The $p$-value is the probability of obtaining the observed $t$ value or larger. Now, you could look back at our previous example, and find that the $p$-value for $t$ (4) = .72, was $p = .509$ . HOWEVER, this p-value was not calculated for a one-directional test...(we talk about what .509 means in the next section).</span>
<span id="cb61-802"><a href="#cb61-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-803"><a href="#cb61-803" aria-hidden="true" tabindex="-1"></a>@fig-6tonedirection shows what the $p$-value for $t$ (4) = .72 using a one-directional test would would look like:</span>
<span id="cb61-804"><a href="#cb61-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-807"><a href="#cb61-807" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-808"><a href="#cb61-808" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6tonedirection</span></span>
<span id="cb61-809"><a href="#cb61-809" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "A case where the observed value of t is much less than the critical value for a one-directional t-test."</span></span>
<span id="cb61-810"><a href="#cb61-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-811"><a href="#cb61-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-812"><a href="#cb61-812" aria-hidden="true" tabindex="-1"></a>range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, .<span class="dv">1</span>)</span>
<span id="cb61-813"><a href="#cb61-813" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> <span class="fu">dt</span>(range, <span class="dv">4</span>, <span class="at">log =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-814"><a href="#cb61-814" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(range, null_distribution)</span>
<span id="cb61-815"><a href="#cb61-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-816"><a href="#cb61-816" aria-hidden="true" tabindex="-1"></a>t_ps <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), <span class="dv">4</span>)</span>
<span id="cb61-817"><a href="#cb61-817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-818"><a href="#cb61-818" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> range, <span class="at">y =</span> null_distribution)) <span class="sc">+</span></span>
<span id="cb61-819"><a href="#cb61-819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb61-820"><a href="#cb61-820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t-values"</span>) <span class="sc">+</span></span>
<span id="cb61-821"><a href="#cb61-821" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb61-822"><a href="#cb61-822" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> .<span class="dv">72</span>) <span class="sc">+</span></span>
<span id="cb61-823"><a href="#cb61-823" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb61-824"><a href="#cb61-824" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"t value and p-range for one-directional test"</span>) <span class="sc">+</span></span>
<span id="cb61-825"><a href="#cb61-825" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb61-826"><a href="#cb61-826" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb61-827"><a href="#cb61-827" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb61-828"><a href="#cb61-828" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb61-829"><a href="#cb61-829" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> .<span class="dv">72</span>,</span>
<span id="cb61-830"><a href="#cb61-830" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="dv">3</span>,</span>
<span id="cb61-831"><a href="#cb61-831" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb61-832"><a href="#cb61-832" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb61-833"><a href="#cb61-833" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb61-834"><a href="#cb61-834" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"grey"</span></span>
<span id="cb61-835"><a href="#cb61-835" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-836"><a href="#cb61-836" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb61-837"><a href="#cb61-837" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb61-838"><a href="#cb61-838" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-839"><a href="#cb61-839" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="dv">3</span>,</span>
<span id="cb61-840"><a href="#cb61-840" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb61-841"><a href="#cb61-841" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> .<span class="dv">25</span>,</span>
<span id="cb61-842"><a href="#cb61-842" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb61-843"><a href="#cb61-843" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"green"</span></span>
<span id="cb61-844"><a href="#cb61-844" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-845"><a href="#cb61-845" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fl">2.5</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"5%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-846"><a href="#cb61-846" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb61-847"><a href="#cb61-847" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-848"><a href="#cb61-848" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">3</span>,</span>
<span id="cb61-849"><a href="#cb61-849" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Critical t"</span></span>
<span id="cb61-850"><a href="#cb61-850" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb61-851"><a href="#cb61-851" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-852"><a href="#cb61-852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb61-853"><a href="#cb61-853" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-854"><a href="#cb61-854" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb61-855"><a href="#cb61-855" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">qt</span>(.<span class="dv">95</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span></span>
<span id="cb61-856"><a href="#cb61-856" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span>)</span>
<span id="cb61-857"><a href="#cb61-857" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb61-858"><a href="#cb61-858" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-859"><a href="#cb61-859" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> .<span class="dv">72</span>, <span class="at">y =</span> .<span class="dv">1</span>,</span>
<span id="cb61-860"><a href="#cb61-860" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> <span class="st">"Observed t"</span>),</span>
<span id="cb61-861"><a href="#cb61-861" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-862"><a href="#cb61-862" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> .<span class="dv">72</span>, <span class="at">y =</span> .<span class="dv">05</span>,</span>
<span id="cb61-863"><a href="#cb61-863" aria-hidden="true" tabindex="-1"></a>                               <span class="at">label =</span> <span class="st">".72, p="</span>),</span>
<span id="cb61-864"><a href="#cb61-864" aria-hidden="true" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-865"><a href="#cb61-865" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb61-866"><a href="#cb61-866" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fl">1.5</span>,</span>
<span id="cb61-867"><a href="#cb61-867" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">05</span>,</span>
<span id="cb61-868"><a href="#cb61-868" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">pt</span>(.<span class="dv">72</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>), <span class="at">digits =</span></span>
<span id="cb61-869"><a href="#cb61-869" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">3</span>)</span>
<span id="cb61-870"><a href="#cb61-870" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb61-871"><a href="#cb61-871" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label))</span>
<span id="cb61-872"><a href="#cb61-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-873"><a href="#cb61-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-874"><a href="#cb61-874" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-875"><a href="#cb61-875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-876"><a href="#cb61-876" aria-hidden="true" tabindex="-1"></a>Let's take this one step at a time. We have located the observed $t$ of .72 on the graph. We shaded the right region all grey. What we see is that the grey region represents .256 or 25.6% of all $t$ values. In other words, 25.6% of $t$ values are .72 or larger than .72. You could expect, by chance alone, to a find a $t$ value of .72 or larger, 25.6% of the time. That's fairly often. We did find a $t$ value of .72. Now that you know this kind of $t$ value or larger occurs 25.6% of the time, would you be confident that the mean difference was not due to chance? Probably not, given that chance can produce this difference fairly often.</span>
<span id="cb61-877"><a href="#cb61-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-878"><a href="#cb61-878" aria-hidden="true" tabindex="-1"></a>Following the "standard" decision making procedure, we would claim that our $t$ value was **not statistically significant**, because it was not large enough. If our observed value was larger than the critical $t$ (larger than 2.13), defined by our alpha criterion, then we would claim that our $t$ value was **statistically significant**. This would be equivalent to saying that we believe it is unlikely that the difference we observed was due to chance. In general, for any observed $t$ value, the associated $p$-value tells you how likely a $t$ of the observed size or larger would be observed. The $p$-value **always** refers to a **range** of $t$-values, never to a single $t$-value. Researchers use the alpha criterion of .05, as a matter of convenience and convention. There are other ways to interpret these values that do not rely on a strict (significant versus not) dichotomy.</span>
<span id="cb61-879"><a href="#cb61-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-880"><a href="#cb61-880" aria-hidden="true" tabindex="-1"></a><span class="fu">### Two-tailed tests</span></span>
<span id="cb61-881"><a href="#cb61-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-882"><a href="#cb61-882" aria-hidden="true" tabindex="-1"></a>OK, so that was one-tailed tests... What are two tailed tests? The $p$-value that we originally calculated from our paired-samples $t$-test was for a 2-tailed test. Often, the default is that the $p$-value is for a two-tailed test.</span>
<span id="cb61-883"><a href="#cb61-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-884"><a href="#cb61-884" aria-hidden="true" tabindex="-1"></a>The two-tailed test, is asking a more general question about whether a difference is likely to have been produced by chance. The question is: what is probability of any difference. It is also called a **non-directional** test, because here we don't care about the direction or sign of the difference (positive or negative), we just care if there is any kind of difference.</span>
<span id="cb61-885"><a href="#cb61-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-886"><a href="#cb61-886" aria-hidden="true" tabindex="-1"></a>The same basic things as before are involved. We define an alpha criterion ($\alpha = 0.05$). And, we say that any observed $t$ value that has a probability of $p$ <span class="sc">\&lt;</span>.05 ($p$ is less than .05) will be called **statistically significant**, and ones that are more likely ($p$ <span class="sc">\&gt;</span>.05, $p$ is greater than .05) will be called null-results, or not statistically significant. The only difference is how we draw the alpha range. Before it was on the right side of the $t$ distribution (we were conducting a one-sided test remember, so we were only interested in one side).</span>
<span id="cb61-887"><a href="#cb61-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-888"><a href="#cb61-888" aria-hidden="true" tabindex="-1"></a>@fig-6twotailedt shows what the most extreme 5% of the $t$-values are when we ignore their sign (whether they are positive or negative).</span>
<span id="cb61-889"><a href="#cb61-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-892"><a href="#cb61-892" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-893"><a href="#cb61-893" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6twotailedt</span></span>
<span id="cb61-894"><a href="#cb61-894" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig.cap: "Critical values for a two-tailed test. Each line represents the location where 2.5% of all $t$s are larger or smaller than critical value. The total for both tails is 5%"</span></span>
<span id="cb61-895"><a href="#cb61-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-896"><a href="#cb61-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-897"><a href="#cb61-897" aria-hidden="true" tabindex="-1"></a>range <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, .<span class="dv">1</span>)</span>
<span id="cb61-898"><a href="#cb61-898" aria-hidden="true" tabindex="-1"></a>null_distribution <span class="ot">&lt;-</span> <span class="fu">dt</span>(range, <span class="dv">4</span>, <span class="at">log =</span> <span class="cn">FALSE</span>)</span>
<span id="cb61-899"><a href="#cb61-899" aria-hidden="true" tabindex="-1"></a>plot_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(range, null_distribution)</span>
<span id="cb61-900"><a href="#cb61-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-901"><a href="#cb61-901" aria-hidden="true" tabindex="-1"></a>t_ps <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">seq</span>(.<span class="dv">1</span>, .<span class="dv">9</span>, .<span class="dv">1</span>), <span class="dv">4</span>)</span>
<span id="cb61-902"><a href="#cb61-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-903"><a href="#cb61-903" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plot_df, <span class="fu">aes</span>(<span class="at">x =</span> range, <span class="at">y =</span> null_distribution)) <span class="sc">+</span></span>
<span id="cb61-904"><a href="#cb61-904" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb61-905"><a href="#cb61-905" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"t-values"</span>) <span class="sc">+</span></span>
<span id="cb61-906"><a href="#cb61-906" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Probability"</span>) <span class="sc">+</span></span>
<span id="cb61-907"><a href="#cb61-907" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb61-908"><a href="#cb61-908" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="fu">qt</span>(.<span class="dv">025</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span></span>
<span id="cb61-909"><a href="#cb61-909" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Critical ts for two-tailed test"</span>) <span class="sc">+</span></span>
<span id="cb61-910"><a href="#cb61-910" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb61-911"><a href="#cb61-911" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(), <span class="at">axis.ticks =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb61-912"><a href="#cb61-912" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb61-913"><a href="#cb61-913" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb61-914"><a href="#cb61-914" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-915"><a href="#cb61-915" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="dv">4</span>,</span>
<span id="cb61-916"><a href="#cb61-916" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb61-917"><a href="#cb61-917" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb61-918"><a href="#cb61-918" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb61-919"><a href="#cb61-919" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"green"</span></span>
<span id="cb61-920"><a href="#cb61-920" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-921"><a href="#cb61-921" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fl">3.5</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"2.5%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-922"><a href="#cb61-922" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb61-923"><a href="#cb61-923" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-924"><a href="#cb61-924" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">3</span>,</span>
<span id="cb61-925"><a href="#cb61-925" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Critical t"</span></span>
<span id="cb61-926"><a href="#cb61-926" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb61-927"><a href="#cb61-927" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-928"><a href="#cb61-928" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb61-929"><a href="#cb61-929" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">975</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-930"><a href="#cb61-930" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb61-931"><a href="#cb61-931" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">qt</span>(.<span class="dv">975</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span></span>
<span id="cb61-932"><a href="#cb61-932" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span>)</span>
<span id="cb61-933"><a href="#cb61-933" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb61-934"><a href="#cb61-934" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-935"><a href="#cb61-935" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(</span>
<span id="cb61-936"><a href="#cb61-936" aria-hidden="true" tabindex="-1"></a>    <span class="st">"rect"</span>,</span>
<span id="cb61-937"><a href="#cb61-937" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmin =</span> <span class="sc">-</span><span class="dv">4</span>,</span>
<span id="cb61-938"><a href="#cb61-938" aria-hidden="true" tabindex="-1"></a>    <span class="at">xmax =</span> <span class="fu">qt</span>(.<span class="dv">025</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-939"><a href="#cb61-939" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymin =</span> <span class="dv">0</span>,</span>
<span id="cb61-940"><a href="#cb61-940" aria-hidden="true" tabindex="-1"></a>    <span class="at">ymax =</span> <span class="cn">Inf</span>,</span>
<span id="cb61-941"><a href="#cb61-941" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha =</span> <span class="fl">0.5</span>,</span>
<span id="cb61-942"><a href="#cb61-942" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"green"</span></span>
<span id="cb61-943"><a href="#cb61-943" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb61-944"><a href="#cb61-944" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="sc">-</span><span class="fl">3.5</span>, <span class="at">y =</span> .<span class="dv">2</span>, <span class="at">label =</span> <span class="st">"2.5%"</span>), <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-945"><a href="#cb61-945" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb61-946"><a href="#cb61-946" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">025</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-947"><a href="#cb61-947" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">3</span>,</span>
<span id="cb61-948"><a href="#cb61-948" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="st">"Critical t"</span></span>
<span id="cb61-949"><a href="#cb61-949" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb61-950"><a href="#cb61-950" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label)) <span class="sc">+</span></span>
<span id="cb61-951"><a href="#cb61-951" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_label</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(</span>
<span id="cb61-952"><a href="#cb61-952" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="fu">qt</span>(.<span class="dv">025</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>),</span>
<span id="cb61-953"><a href="#cb61-953" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> .<span class="dv">25</span>,</span>
<span id="cb61-954"><a href="#cb61-954" aria-hidden="true" tabindex="-1"></a>    <span class="at">label =</span> <span class="fu">round</span>(<span class="fu">qt</span>(.<span class="dv">025</span>, <span class="dv">4</span>, <span class="at">lower.tail =</span> <span class="cn">TRUE</span>), <span class="at">digits =</span></span>
<span id="cb61-955"><a href="#cb61-955" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span>)</span>
<span id="cb61-956"><a href="#cb61-956" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb61-957"><a href="#cb61-957" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">label =</span> label))</span>
<span id="cb61-958"><a href="#cb61-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-959"><a href="#cb61-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-960"><a href="#cb61-960" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-961"><a href="#cb61-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-962"><a href="#cb61-962" aria-hidden="true" tabindex="-1"></a>Here is what we are seeing. A distribution of no differences (the null, which is what we are looking at), will produce $t$s that are 2.78 or greater 2.5% of the time, and $t$s that are -2.78 or smaller 2.5% of the time. 2.5% + 2.5% is a total of 5% of the time. We could also say that $t$s larger than +/- 2.78 occur 5% of the time.</span>
<span id="cb61-963"><a href="#cb61-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-964"><a href="#cb61-964" aria-hidden="true" tabindex="-1"></a>As a result, the critical $t$ value is (+/-) 2.78 for a two-tailed test. As you can see, the two-tailed test is blind to the direction or sign of the difference. Because of this, the critical $t$ value is also higher for a two-tailed test, than for the one-tailed test that we did earlier. Hopefully, now you can see why it is called a two-tailed test. There are two tails of the distribution, one on the left and right, both shaded in green.</span>
<span id="cb61-965"><a href="#cb61-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-966"><a href="#cb61-966" aria-hidden="true" tabindex="-1"></a><span class="fu">### One or two tailed, which one?</span></span>
<span id="cb61-967"><a href="#cb61-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-968"><a href="#cb61-968" aria-hidden="true" tabindex="-1"></a>Now that you know there are two kinds of tests, one-tailed, and two-tailed, which one should you use? There is some conventional wisdom on this, but also some debate. In the end, it is up to you to be able to justify your choice and why it is appropriate for you data. That is the real answer.</span>
<span id="cb61-969"><a href="#cb61-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-970"><a href="#cb61-970" aria-hidden="true" tabindex="-1"></a>The conventional answer is that you use a one-tailed test when you have a theory or hypothesis that is making a directional prediction (the theory predicts that the difference will be positive, or negative). Similarly, use a two-tailed test when you are looking for any difference, and you don't have a theory that makes a directional prediction (it just makes the prediction that there will be a difference, either positive or negative).</span>
<span id="cb61-971"><a href="#cb61-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-972"><a href="#cb61-972" aria-hidden="true" tabindex="-1"></a>Also, people appear to choose one or two-tailed tests based on how risky they are as researchers. If you always ran one-tailed tests, your critical $t$ values for your set alpha criterion would always be smaller than the critical $t$s for a two-tailed test. Over the long run, you would make more type I errors, because the criterion to detect an effect is a lower bar for one than two tailed tests.</span>
<span id="cb61-973"><a href="#cb61-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-974"><a href="#cb61-974" aria-hidden="true" tabindex="-1"></a><span class="at">&gt; Remember type 1 errors occur when you reject the idea that chance could have caused your difference. You often never know when you make this error. It happens anytime that sampling error was the actual cause of the difference, but a researcher dismisses that possibility and concludes that their manipulation caused the difference.</span></span>
<span id="cb61-975"><a href="#cb61-975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-976"><a href="#cb61-976" aria-hidden="true" tabindex="-1"></a>Similarly, if you always ran two-tailed tests, even when you had a directional prediction, you would make fewer type I errors over the long run, because the $t$ for a two-tailed test is higher than the $t$ for a one-tailed test. It seems quite common for researchers to use a more conservative two-tailed test, even when they are making a directional prediction based on theory. In practice, researchers tend to adopt a standard for reporting that is common in their field. Whether or not the practice is justifiable can sometimes be an open question. The important task for any researcher, or student learning statistics, is to be able to justify their choice of test.</span>
<span id="cb61-977"><a href="#cb61-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-978"><a href="#cb61-978" aria-hidden="true" tabindex="-1"></a><span class="fu">### Degrees of freedom</span></span>
<span id="cb61-979"><a href="#cb61-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-980"><a href="#cb61-980" aria-hidden="true" tabindex="-1"></a>Before we finish up with paired-samples $t$-tests, we should talk about degrees of freedom. Our sense is that students don't really understand degrees of freedom very well. If you are reading this textbook, you are probably still wondering what is degrees of freedom, seeing as we haven't really talked about it all.</span>
<span id="cb61-981"><a href="#cb61-981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-982"><a href="#cb61-982" aria-hidden="true" tabindex="-1"></a>For the $t$-test, there is a formula for degrees of freedom. For the one-sample and paired sample $t$-tests, the formula is:</span>
<span id="cb61-983"><a href="#cb61-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-984"><a href="#cb61-984" aria-hidden="true" tabindex="-1"></a>$\text{Degrees of Freedom} = \text{df} = n-1$. Where n is the number of samples in the test.</span>
<span id="cb61-985"><a href="#cb61-985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-986"><a href="#cb61-986" aria-hidden="true" tabindex="-1"></a>In our paired $t$-test example, there were 5 infants. Therefore, degrees of freedom = 5-1 = 4.</span>
<span id="cb61-987"><a href="#cb61-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-988"><a href="#cb61-988" aria-hidden="true" tabindex="-1"></a>OK, that's a formula. Who cares about degrees of freedom, what does the number mean? And why do we report it when we report a $t$-test... you've probably noticed the number in parentheses e.g., $t$(4)=.72, the 4 is the $df$, or degrees of freedom.</span>
<span id="cb61-989"><a href="#cb61-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-990"><a href="#cb61-990" aria-hidden="true" tabindex="-1"></a>Degrees of freedom is both a concept, and a correction. The concept is that if you estimate a property of the numbers, and you use this estimate, you will be forcing some constraints on your numbers.</span>
<span id="cb61-991"><a href="#cb61-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-992"><a href="#cb61-992" aria-hidden="true" tabindex="-1"></a>Consider the numbers: 1, 2, 3. The mean of these numbers is 2. Now, let's say I told you that the mean of three numbers is 2. Then, how many of these three numbers have freedom? Funny question right. What we mean is, how many of the three numbers could be any number, or have the freedom to be any number.</span>
<span id="cb61-993"><a href="#cb61-993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-994"><a href="#cb61-994" aria-hidden="true" tabindex="-1"></a>The first two numbers could be any number. But, once those two numbers are set, the final number (the third number), MUST be a particular number that makes the mean 2. The first two numbers have freedom. The third number has no freedom.</span>
<span id="cb61-995"><a href="#cb61-995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-996"><a href="#cb61-996" aria-hidden="true" tabindex="-1"></a>To illustrate. Let's freely pick two numbers: 51 and -3. I used my personal freedom to pick those two numbers. Now, if our three numbers are 51, -3, and x, and the mean of these three numbers is 2. There is only one solution, x has to be -42, otherwise the mean won't be 2. This is one way to think about degrees of freedom. The degrees of freedom for these three numbers is n-1 = 3-1= 2, because 2 of the numbers can be free, but the last number has no freedom, it becomes fixed after the first two are decided.</span>
<span id="cb61-997"><a href="#cb61-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-998"><a href="#cb61-998" aria-hidden="true" tabindex="-1"></a>Now, statisticians often apply degrees of freedom to their calculations, especially when a second calculation relies on an estimated value. For example, when we calculate the standard deviation of a sample, we first calculate the mean of the sample right! By estimating the mean, we are fixing an aspect of our sample, and so, our sample now has n-1 degrees of freedom when we calculate the standard deviation (remember for the sample standard deviation, we divide by n-1...there's that n-1 again.)</span>
<span id="cb61-999"><a href="#cb61-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1000"><a href="#cb61-1000" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Simulating how degrees of freedom affects the $t$ distribution</span></span>
<span id="cb61-1001"><a href="#cb61-1001" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1002"><a href="#cb61-1002" aria-hidden="true" tabindex="-1"></a>There are at least two ways to think the degrees of freedom for a $t$-test. For example, if you want to use math to compute aspects of the $t$ distribution, then you need the degrees of freedom to plug in to the formula... If you want to see the formulas I'm talking about, scroll down on the <span class="co">[</span><span class="ot">$t$-test wikipedia page</span><span class="co">](https://en.wikipedia.org/wiki/Student%27s_t-distribution)</span> and look for the probability density or cumulative distribution functions...We think that is quite scary for most people, and one reason why degrees of freedom are not well-understood.</span>
<span id="cb61-1003"><a href="#cb61-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1004"><a href="#cb61-1004" aria-hidden="true" tabindex="-1"></a>If we wanted to simulate the $t$ distribution we could more easily see what influence degrees of freedom has on the shape of the distribution. Remember, $t$ is a sample statistic, it is something we measure from the sample. So, we could simulate the process of measuring $t$ from many different samples, then plot the histogram of $t$ to show us the simulated $t$ distribution.</span>
<span id="cb61-1005"><a href="#cb61-1005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1008"><a href="#cb61-1008" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1009"><a href="#cb61-1009" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6dft</span></span>
<span id="cb61-1010"><a href="#cb61-1010" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The width of the t distribution shrinks as sample size and degrees of freedom (from 4 to 100) increases."</span></span>
<span id="cb61-1011"><a href="#cb61-1011" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-asp: 0.5</span></span>
<span id="cb61-1012"><a href="#cb61-1012" aria-hidden="true" tabindex="-1"></a><span class="co">#| out-width: "100%"</span></span>
<span id="cb61-1013"><a href="#cb61-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1014"><a href="#cb61-1014" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rt</span>(<span class="dv">10000</span>, <span class="dv">4</span>), <span class="fu">rt</span>(<span class="dv">10000</span>, <span class="dv">100</span>))</span>
<span id="cb61-1015"><a href="#cb61-1015" aria-hidden="true" tabindex="-1"></a>dfs <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">100</span>), <span class="at">each =</span> <span class="dv">10000</span>))</span>
<span id="cb61-1016"><a href="#cb61-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1017"><a href="#cb61-1017" aria-hidden="true" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(dfs, ts)</span>
<span id="cb61-1018"><a href="#cb61-1018" aria-hidden="true" tabindex="-1"></a>t_df <span class="ot">&lt;-</span> t_df[<span class="fu">abs</span>(t_df<span class="sc">$</span>ts) <span class="sc">&lt;</span> <span class="dv">5</span>, ]</span>
<span id="cb61-1019"><a href="#cb61-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1020"><a href="#cb61-1020" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(t_df, <span class="fu">aes</span>(<span class="at">x =</span> ts, <span class="at">group =</span> dfs, <span class="at">color =</span> dfs)) <span class="sc">+</span></span>
<span id="cb61-1021"><a href="#cb61-1021" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb61-1022"><a href="#cb61-1022" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb61-1023"><a href="#cb61-1023" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>( <span class="sc">~</span> dfs) <span class="sc">+</span></span>
<span id="cb61-1024"><a href="#cb61-1024" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size=</span><span class="dv">15</span>)</span>
<span id="cb61-1025"><a href="#cb61-1025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1026"><a href="#cb61-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1027"><a href="#cb61-1027" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1028"><a href="#cb61-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1029"><a href="#cb61-1029" aria-hidden="true" tabindex="-1"></a>In @fig-6dft notice that the red distribution for $df = 4$, is a little bit shorter, and a little bit wider than the bluey-green distribution for $df = 100$. As degrees of freedom increase the $t$ distribution gets taller (in the middle), and narrower in the range. It get's more peaky. Can you guess the reason for this? Remember, we are estimating a sample statistic, and degrees of freedom is really just a number that refers to the number of subjects (well minus one). And, we already know that as we increase $n$, our sample statistics become better estimates (less variance) of the distributional parameters they are estimating. So, $t$ becomes a better estimate of it's "true" value as sample size increase, resulting in a more narrow distribution of $t$s.</span>
<span id="cb61-1030"><a href="#cb61-1030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1031"><a href="#cb61-1031" aria-hidden="true" tabindex="-1"></a>There is a slightly different $t$ distribution for every degrees of freedom, and the critical regions associated with 5% of the extreme values are thus slightly different every time. This is why we report the degrees of freedom for each t-test, they define the distribution of $t$ values for the sample-size in question. Why do we use n-1 and not n? Well, we calculate $t$ using the sample standard deviation to estimate the standard error or the mean, that estimate uses n-1 in the denominator, so our $t$ distribution is built assuming n-1. That's enough for degrees of freedom...</span>
<span id="cb61-1032"><a href="#cb61-1032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1033"><a href="#cb61-1033" aria-hidden="true" tabindex="-1"></a><span class="fu">## The paired samples t-test strikes back</span></span>
<span id="cb61-1034"><a href="#cb61-1034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1035"><a href="#cb61-1035" aria-hidden="true" tabindex="-1"></a>You must be wondering if we will ever be finished talking about paired samples t-tests... why are we doing round 2, oh no! Don't worry, we're just going to 1) remind you about what we were doing with the infant study, and 2) do a paired samples t-test on the entire data set and discuss.</span>
<span id="cb61-1036"><a href="#cb61-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1037"><a href="#cb61-1037" aria-hidden="true" tabindex="-1"></a>Remember, we were wondering if the infants would look longer toward the singer who sang the familiar song during the test phase compared to the baseline phase. We showed you data from 5 infants, and walked through the computations for the $t$-test. As a reminder, it looked like this:</span>
<span id="cb61-1038"><a href="#cb61-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1039"><a href="#cb61-1039" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb61-1040"><a href="#cb61-1040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1041"><a href="#cb61-1041" aria-hidden="true" tabindex="-1"></a><span class="in">paired_sample_df &lt;-  data.frame(infant=1:5, </span></span>
<span id="cb61-1042"><a href="#cb61-1042" aria-hidden="true" tabindex="-1"></a><span class="in">                               Baseline = round(experiment_one$Baseline_Proportion_Gaze_to_Singer[1:5],digits=2), </span></span>
<span id="cb61-1043"><a href="#cb61-1043" aria-hidden="true" tabindex="-1"></a><span class="in">                               Test = round(experiment_one$Test_Proportion_Gaze_to_Singer[1:5], digits=2))</span></span>
<span id="cb61-1044"><a href="#cb61-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1045"><a href="#cb61-1045" aria-hidden="true" tabindex="-1"></a><span class="in">differences &lt;-  paired_sample_df$Test-paired_sample_df$Baseline</span></span>
<span id="cb61-1046"><a href="#cb61-1046" aria-hidden="true" tabindex="-1"></a><span class="in">diff_from_mean &lt;- differences-mean(differences)</span></span>
<span id="cb61-1047"><a href="#cb61-1047" aria-hidden="true" tabindex="-1"></a><span class="in">Squared_differences &lt;- diff_from_mean^2</span></span>
<span id="cb61-1048"><a href="#cb61-1048" aria-hidden="true" tabindex="-1"></a><span class="in">paired_sample_df &lt;- cbind(paired_sample_df, </span></span>
<span id="cb61-1049"><a href="#cb61-1049" aria-hidden="true" tabindex="-1"></a><span class="in">                          differences,</span></span>
<span id="cb61-1050"><a href="#cb61-1050" aria-hidden="true" tabindex="-1"></a><span class="in">                          diff_from_mean,</span></span>
<span id="cb61-1051"><a href="#cb61-1051" aria-hidden="true" tabindex="-1"></a><span class="in">                          Squared_differences)</span></span>
<span id="cb61-1052"><a href="#cb61-1052" aria-hidden="true" tabindex="-1"></a><span class="in"> </span></span>
<span id="cb61-1053"><a href="#cb61-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1054"><a href="#cb61-1054" aria-hidden="true" tabindex="-1"></a><span class="in"> paired_sample_df &lt;- paired_sample_df %&gt;%</span></span>
<span id="cb61-1055"><a href="#cb61-1055" aria-hidden="true" tabindex="-1"></a><span class="in">   rbind(c("Sums",colSums(paired_sample_df[1:5,2:6]))) %&gt;%</span></span>
<span id="cb61-1056"><a href="#cb61-1056" aria-hidden="true" tabindex="-1"></a><span class="in">   rbind(c("Means",colMeans(paired_sample_df[1:5,2:6]))) %&gt;%</span></span>
<span id="cb61-1057"><a href="#cb61-1057" aria-hidden="true" tabindex="-1"></a><span class="in">   rbind(c(" "," "," "," ","sd ",round(sd(paired_sample_df[1:5,4]),digits=3))) %&gt;%</span></span>
<span id="cb61-1058"><a href="#cb61-1058" aria-hidden="true" tabindex="-1"></a><span class="in">   rbind(c(" "," "," "," ","SEM ",round(sd(paired_sample_df[1:5,4])/sqrt(5), digits=3))) %&gt;%</span></span>
<span id="cb61-1059"><a href="#cb61-1059" aria-hidden="true" tabindex="-1"></a><span class="in">   rbind(c(" "," "," "," ","t",mean(differences)/round(sd(paired_sample_df[1:5,4])/sqrt(5), digits=3)))</span></span>
<span id="cb61-1060"><a href="#cb61-1060" aria-hidden="true" tabindex="-1"></a><span class="in"> paired_sample_df[6,5]&lt;-0</span></span>
<span id="cb61-1061"><a href="#cb61-1061" aria-hidden="true" tabindex="-1"></a><span class="in">  paired_sample_df[7,5]&lt;-0</span></span>
<span id="cb61-1062"><a href="#cb61-1062" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(paired_sample_df)</span></span>
<span id="cb61-1063"><a href="#cb61-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1064"><a href="#cb61-1064" aria-hidden="true" tabindex="-1"></a><span class="in">t.test(round(differences, digits=2), mu=0)</span></span>
<span id="cb61-1065"><a href="#cb61-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1066"><a href="#cb61-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1067"><a href="#cb61-1067" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1068"><a href="#cb61-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1069"><a href="#cb61-1069" aria-hidden="true" tabindex="-1"></a>Let's write down the finding one more time: The mean difference was 0.054, $t$(4) = .72, $p$ =.509. We can also now confirm, that the $p$-value was from a two-tailed test. So, what does this all really mean.</span>
<span id="cb61-1070"><a href="#cb61-1070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1071"><a href="#cb61-1071" aria-hidden="true" tabindex="-1"></a>We can say that a $t$ value with an absolute of .72 or larger occurs 50.9% of the time. More precisely, the distribution of no differences (the null), will produce a $t$ value this large or larger 50.9% of the time. In other words, chance alone good have easily produced the $t$ value from our sample, and the mean difference we observed or .054, could easily have been a result of chance.</span>
<span id="cb61-1072"><a href="#cb61-1072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1073"><a href="#cb61-1073" aria-hidden="true" tabindex="-1"></a>Let's quickly put all of the data in the $t$-test, and re-run the test using all of the infant subjects.</span>
<span id="cb61-1074"><a href="#cb61-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1077"><a href="#cb61-1077" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1078"><a href="#cb61-1078" aria-hidden="true" tabindex="-1"></a>paired_sample_df <span class="ot">&lt;-</span>  <span class="fu">data.frame</span>(<span class="at">infant=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>, </span>
<span id="cb61-1079"><a href="#cb61-1079" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Baseline =</span> <span class="fu">round</span>(experiment_one<span class="sc">$</span>Baseline_Proportion_Gaze_to_Singer[<span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>],<span class="at">digits=</span><span class="dv">2</span>), </span>
<span id="cb61-1080"><a href="#cb61-1080" aria-hidden="true" tabindex="-1"></a>                               <span class="at">Test =</span> <span class="fu">round</span>(experiment_one<span class="sc">$</span>Test_Proportion_Gaze_to_Singer[<span class="dv">1</span><span class="sc">:</span><span class="dv">32</span>], <span class="at">digits=</span><span class="dv">2</span>))</span>
<span id="cb61-1081"><a href="#cb61-1081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1082"><a href="#cb61-1082" aria-hidden="true" tabindex="-1"></a>differences <span class="ot">&lt;-</span>  paired_sample_df<span class="sc">$</span>Test<span class="sc">-</span>paired_sample_df<span class="sc">$</span>Baseline</span>
<span id="cb61-1083"><a href="#cb61-1083" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(differences,<span class="at">mu=</span><span class="dv">0</span>)</span>
<span id="cb61-1084"><a href="#cb61-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1085"><a href="#cb61-1085" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1086"><a href="#cb61-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1087"><a href="#cb61-1087" aria-hidden="true" tabindex="-1"></a>Now we get a very different answer. We would summarize the results saying the mean difference was .073, t(31) = 2.44, p = 0.020. How many total infants were their? Well the degrees of freedom was 31, so there must have been 32 infants in the study. Now we see a much smaller $p$-value. This was also a two-tailed test, so we that observing a $t$ value of 2.4 or greater (absolute value) only occurs 2% of the time. In other words, the distribution of no differences will produce the observed t-value very rarely. So, it is unlikely that the observed mean difference of .073 was due to chance (it could have been due to chance, but that is very unlikely). As a result, we can be somewhat confident in concluding that something about seeing and hearing a unfamiliar person sing a familiar song, causes an infant to draw their attention toward the singer, and this potentially benefits social learning on the part of the infant.</span>
<span id="cb61-1088"><a href="#cb61-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1089"><a href="#cb61-1089" aria-hidden="true" tabindex="-1"></a><span class="fu">## Independent samples t-test: The return of the t-test?</span></span>
<span id="cb61-1090"><a href="#cb61-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1091"><a href="#cb61-1091" aria-hidden="true" tabindex="-1"></a>If you've been following the Star Wars references, we are on last movie (of the original trilogy)... the independent t-test. This is were basically the same story plays out as before, only slightly different.</span>
<span id="cb61-1092"><a href="#cb61-1092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1093"><a href="#cb61-1093" aria-hidden="true" tabindex="-1"></a>Remember there are different $t$-tests for different kinds of research designs. When your design is a **between-subjects** design, you use an **independent samples t-test**. Between-subjects design involve different people or subjects in each experimental condition. If there are two conditions, and 10 people in each, then there are 20 total people. And, there are no paired scores, because every single person is measured once, not twice, no repeated measures. Because there are no repeated measures we can't look at the difference scores between conditions one and two. The scores are not paired in any meaningful way, to it doesn't make sense to subtract them. So what do we do?</span>
<span id="cb61-1094"><a href="#cb61-1094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1095"><a href="#cb61-1095" aria-hidden="true" tabindex="-1"></a>The logic of the independent samples t-test is the very same as the other $t$-tests. We calculated the means for each group, then we find the difference. That goes into the numerator of the t formula. Then we get an estimate of the variation for the denominator. We divide the mean difference by the estimate of the variation, and we get $t$. It's the same as before.</span>
<span id="cb61-1096"><a href="#cb61-1096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1097"><a href="#cb61-1097" aria-hidden="true" tabindex="-1"></a>The only wrinkle here is what goes into the denominator? How should we calculate the estimate of the variance? It would be nice if we could do something very straightforward like this, say for an experiment with two groups A and B:</span>
<span id="cb61-1098"><a href="#cb61-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1099"><a href="#cb61-1099" aria-hidden="true" tabindex="-1"></a>$t = \frac{\bar{A}-\bar{B}}{(\frac{SEM_A+SEM_B}{2})}$</span>
<span id="cb61-1100"><a href="#cb61-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1101"><a href="#cb61-1101" aria-hidden="true" tabindex="-1"></a>In plain language, this is just:</span>
<span id="cb61-1102"><a href="#cb61-1102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1103"><a href="#cb61-1103" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Find the mean difference for the top part</span>
<span id="cb61-1104"><a href="#cb61-1104" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Compute the SEM (standard error of the mean) for each group, and average them together to make a single estimate, pooling over both samples.</span>
<span id="cb61-1105"><a href="#cb61-1105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1106"><a href="#cb61-1106" aria-hidden="true" tabindex="-1"></a>This would be nice, but unfortunately, it turns out that finding the average of two standard errors of the mean is not the best way to do it. This would create a biased estimator of the variation for the hypothesized distribution of no differences. We won't go into the math here, but instead of the above formula, we an use a different one that gives as an **unbiased estimate of the pooled standard error of the sample mean**. Our new and improved $t$ formula would look like this:</span>
<span id="cb61-1107"><a href="#cb61-1107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1108"><a href="#cb61-1108" aria-hidden="true" tabindex="-1"></a>$t = \frac{\bar{X_A}-\bar{X_B}}{s_p * \sqrt{\frac{1}{n_A} + \frac{1}{n_B}}}$</span>
<span id="cb61-1109"><a href="#cb61-1109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1110"><a href="#cb61-1110" aria-hidden="true" tabindex="-1"></a>and, $s_p$, which is the pooled sample standard deviation is defined as, note the \$s\$es in the formula are variances:</span>
<span id="cb61-1111"><a href="#cb61-1111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1112"><a href="#cb61-1112" aria-hidden="true" tabindex="-1"></a>$s_p = \sqrt{\frac{(n_A-1)s_A^2 + (n_B-1)s^2_B}{n_A +n_B -2}}$</span>
<span id="cb61-1113"><a href="#cb61-1113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1114"><a href="#cb61-1114" aria-hidden="true" tabindex="-1"></a>Believe you me, that is so much more formula than I wanted to type out. Shall we do one independent $t$-test example by hand, just to see the computations? Let's do it...but in a slightly different way than you expect. I show the steps using R. I made some fake scores for groups A and B. Then, I followed all of the steps from the formula, but made R do each of the calculations. This shows you the needed steps by following the code. At the end, I print the $t$-test values I computed "by hand", and then the $t$-test value that the R software outputs using the $t$-test function. You should be able to get the same values for $t$, if you were brave enough to compute $t$ by hand.</span>
<span id="cb61-1115"><a href="#cb61-1115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1116"><a href="#cb61-1116" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE }</span></span>
<span id="cb61-1117"><a href="#cb61-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1118"><a href="#cb61-1118" aria-hidden="true" tabindex="-1"></a><span class="in">## By "hand" using R r code</span></span>
<span id="cb61-1119"><a href="#cb61-1119" aria-hidden="true" tabindex="-1"></a><span class="in">a &lt;- c(1,2,3,4,5)</span></span>
<span id="cb61-1120"><a href="#cb61-1120" aria-hidden="true" tabindex="-1"></a><span class="in">b &lt;- c(3,5,4,7,9)</span></span>
<span id="cb61-1121"><a href="#cb61-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1122"><a href="#cb61-1122" aria-hidden="true" tabindex="-1"></a><span class="in">mean_difference &lt;- mean(a)-mean(b) # compute mean difference</span></span>
<span id="cb61-1123"><a href="#cb61-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1124"><a href="#cb61-1124" aria-hidden="true" tabindex="-1"></a><span class="in">variance_a &lt;- var(a) # compute variance for A</span></span>
<span id="cb61-1125"><a href="#cb61-1125" aria-hidden="true" tabindex="-1"></a><span class="in">variance_b &lt;- var(b) # compute variance for B</span></span>
<span id="cb61-1126"><a href="#cb61-1126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1127"><a href="#cb61-1127" aria-hidden="true" tabindex="-1"></a><span class="in"># Compute top part and bottom part of sp formula</span></span>
<span id="cb61-1128"><a href="#cb61-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1129"><a href="#cb61-1129" aria-hidden="true" tabindex="-1"></a><span class="in">sp_numerator &lt;- (4*variance_a + 4* variance_b) </span></span>
<span id="cb61-1130"><a href="#cb61-1130" aria-hidden="true" tabindex="-1"></a><span class="in">sp_denominator &lt;- 5+5-2</span></span>
<span id="cb61-1131"><a href="#cb61-1131" aria-hidden="true" tabindex="-1"></a><span class="in">sp &lt;- sqrt(sp_numerator/sp_denominator) # compute sp</span></span>
<span id="cb61-1132"><a href="#cb61-1132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1133"><a href="#cb61-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1134"><a href="#cb61-1134" aria-hidden="true" tabindex="-1"></a><span class="in"># compute t following formulat</span></span>
<span id="cb61-1135"><a href="#cb61-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1136"><a href="#cb61-1136" aria-hidden="true" tabindex="-1"></a><span class="in">t &lt;- mean_difference / ( sp * sqrt( (1/5) +(1/5) ) )</span></span>
<span id="cb61-1137"><a href="#cb61-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1138"><a href="#cb61-1138" aria-hidden="true" tabindex="-1"></a><span class="in">t # print results</span></span>
<span id="cb61-1139"><a href="#cb61-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1140"><a href="#cb61-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1141"><a href="#cb61-1141" aria-hidden="true" tabindex="-1"></a><span class="in"># using the R function t.test</span></span>
<span id="cb61-1142"><a href="#cb61-1142" aria-hidden="true" tabindex="-1"></a><span class="in">t.test(a,b, paired=FALSE, var.equal = TRUE)</span></span>
<span id="cb61-1143"><a href="#cb61-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1144"><a href="#cb61-1144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1145"><a href="#cb61-1145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1146"><a href="#cb61-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1147"><a href="#cb61-1147" aria-hidden="true" tabindex="-1"></a><span class="fu">## Simulating data for t-tests</span></span>
<span id="cb61-1148"><a href="#cb61-1148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1149"><a href="#cb61-1149" aria-hidden="true" tabindex="-1"></a>An "advanced" topic for $t$-tests is the idea of using R to conduct simulations for $t$-tests.</span>
<span id="cb61-1150"><a href="#cb61-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1151"><a href="#cb61-1151" aria-hidden="true" tabindex="-1"></a>If you recall, $t$ is a property of a sample. We calculate $t$ from our sample. The $t$ distribution is the hypothetical behavior of our sample. That is, if we had taken thousands upon thousands of samples, and calculated $t$ for each one, and then looked at the distribution of those $t$'s, we would have the sampling distribution of $t$!</span>
<span id="cb61-1152"><a href="#cb61-1152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1153"><a href="#cb61-1153" aria-hidden="true" tabindex="-1"></a>It can be very useful to get in the habit of using R to simulate data under certain conditions, to see how your sample data, and things like $t$ behave. Why is this useful? It mainly prepares you with some intuitions about how sampling error (random chance) can influence your results, given specific parameters of your design, such as sample-size, the size of the mean difference you expect to find in your data, and the amount of variation you might find. These methods can be used formally to conduct power-analyses. Or more informally for data sense.</span>
<span id="cb61-1154"><a href="#cb61-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1155"><a href="#cb61-1155" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simulating a one-sample t-test</span></span>
<span id="cb61-1156"><a href="#cb61-1156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1157"><a href="#cb61-1157" aria-hidden="true" tabindex="-1"></a>Here are the steps you might follow to simulate data for a one sample $t$-test.</span>
<span id="cb61-1158"><a href="#cb61-1158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1159"><a href="#cb61-1159" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Make some assumptions about what your sample (that you might be planning to collect) might look like. For example, you might be planning to collect 30 subjects worth of data. The scores of those data points might come from a normal distribution (mean = 50, sd = 10).</span>
<span id="cb61-1160"><a href="#cb61-1160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1161"><a href="#cb61-1161" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>sample simulated numbers from the distribution, then conduct a $t$-test on the simulated numbers. Save the statistics you want (such as $t$s and $p$s), and then see how things behave.</span>
<span id="cb61-1162"><a href="#cb61-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1163"><a href="#cb61-1163" aria-hidden="true" tabindex="-1"></a>Let's do this a couple different times. First, let's simulate samples with N = 30, taken from a normal (mean= 50, sd = 25). We'll do a simulation with 1000 simulations. For each simulation, we will compare the sample mean with a population mean of 50. There should be no difference on average here. @fig-6nullt is the null distribution that we are simulating.</span>
<span id="cb61-1164"><a href="#cb61-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1167"><a href="#cb61-1167" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1168"><a href="#cb61-1168" aria-hidden="true" tabindex="-1"></a><span class="co"># steps to create fake data from a distribution</span></span>
<span id="cb61-1169"><a href="#cb61-1169" aria-hidden="true" tabindex="-1"></a><span class="co"># and conduct t-tests on the simulated data</span></span>
<span id="cb61-1170"><a href="#cb61-1170" aria-hidden="true" tabindex="-1"></a>save_ps <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb61-1171"><a href="#cb61-1171" aria-hidden="true" tabindex="-1"></a>save_ts <span class="ot">&lt;-</span> <span class="fu">length</span>(<span class="dv">1000</span>)</span>
<span id="cb61-1172"><a href="#cb61-1172" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1000</span>) {</span>
<span id="cb61-1173"><a href="#cb61-1173" aria-hidden="true" tabindex="-1"></a>  my_sample <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">30</span>, <span class="at">mean =</span> <span class="dv">50</span>, <span class="at">sd =</span> <span class="dv">25</span>)</span>
<span id="cb61-1174"><a href="#cb61-1174" aria-hidden="true" tabindex="-1"></a>  t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span> (my_sample, <span class="at">mu =</span> <span class="dv">50</span>)</span>
<span id="cb61-1175"><a href="#cb61-1175" aria-hidden="true" tabindex="-1"></a>  save_ps[i] <span class="ot">&lt;-</span> t_test<span class="sc">$</span>p.value</span>
<span id="cb61-1176"><a href="#cb61-1176" aria-hidden="true" tabindex="-1"></a>  save_ts[i] <span class="ot">&lt;-</span> t_test<span class="sc">$</span>statistic</span>
<span id="cb61-1177"><a href="#cb61-1177" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-1178"><a href="#cb61-1178" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1179"><a href="#cb61-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1182"><a href="#cb61-1182" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1183"><a href="#cb61-1183" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6nullt</span></span>
<span id="cb61-1184"><a href="#cb61-1184" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The distribution of $t$-values under the null. These are the $t$ values that are produced by chance alone."</span></span>
<span id="cb61-1185"><a href="#cb61-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1186"><a href="#cb61-1186" aria-hidden="true" tabindex="-1"></a><span class="co">#plot histograms of t and p values for 1000 simulations</span></span>
<span id="cb61-1187"><a href="#cb61-1187" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ts)</span>
<span id="cb61-1188"><a href="#cb61-1188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1189"><a href="#cb61-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1192"><a href="#cb61-1192" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1193"><a href="#cb61-1193" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6flatp</span></span>
<span id="cb61-1194"><a href="#cb61-1194" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "The distribution of $p$-values that are observed is flat under the null."</span></span>
<span id="cb61-1195"><a href="#cb61-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1196"><a href="#cb61-1196" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ps)</span>
<span id="cb61-1197"><a href="#cb61-1197" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1198"><a href="#cb61-1198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1199"><a href="#cb61-1199" aria-hidden="true" tabindex="-1"></a>Neat. We see both a $t$ distribution, that looks like $t$ distribution as it should. And we see the $p$ distribution. This shows us how often we get $t$ values of particular sizes. You may find it interesting that the $p$-distribution is flat under the null, which we are simulating here. This means that you have the same chances of a getting a $t$ with a p-value between 0 and 0.05, as you would for getting a $t$ with a p-value between .90 and .95. Those ranges are both ranges of 5%, so there are an equal amount of $t$ values in them by definition.</span>
<span id="cb61-1200"><a href="#cb61-1200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1201"><a href="#cb61-1201" aria-hidden="true" tabindex="-1"></a>Here's another way to do the same simulation in R, using the replicate function, instead a for loop:</span>
<span id="cb61-1202"><a href="#cb61-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1205"><a href="#cb61-1205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1206"><a href="#cb61-1206" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6simtsRep</span></span>
<span id="cb61-1207"><a href="#cb61-1207" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Simulating $t$s in R."</span></span>
<span id="cb61-1208"><a href="#cb61-1208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1209"><a href="#cb61-1209" aria-hidden="true" tabindex="-1"></a>simulated_ts <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb61-1210"><a href="#cb61-1210" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">t.test</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">25</span>), <span class="at">mu =</span> <span class="dv">50</span>)<span class="sc">$</span>statistic)</span>
<span id="cb61-1211"><a href="#cb61-1211" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(simulated_ts)</span>
<span id="cb61-1212"><a href="#cb61-1212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1213"><a href="#cb61-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1216"><a href="#cb61-1216" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1217"><a href="#cb61-1217" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6simpsRep</span></span>
<span id="cb61-1218"><a href="#cb61-1218" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "Simulating $p$s in R."</span></span>
<span id="cb61-1219"><a href="#cb61-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1220"><a href="#cb61-1220" aria-hidden="true" tabindex="-1"></a>simulated_ps <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>,</span>
<span id="cb61-1221"><a href="#cb61-1221" aria-hidden="true" tabindex="-1"></a>                          <span class="fu">t.test</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="dv">50</span>, <span class="dv">25</span>), <span class="at">mu =</span> <span class="dv">50</span>)<span class="sc">$</span>p.value)</span>
<span id="cb61-1222"><a href="#cb61-1222" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(simulated_ps)</span>
<span id="cb61-1223"><a href="#cb61-1223" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1224"><a href="#cb61-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1225"><a href="#cb61-1225" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simulating a paired samples t-test</span></span>
<span id="cb61-1226"><a href="#cb61-1226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1227"><a href="#cb61-1227" aria-hidden="true" tabindex="-1"></a>The code below is set up to sample 10 scores for condition A and B from the same normal distribution. The simulation is conducted 1000 times, and the $t$s and $p$s are saved and plotted for each.</span>
<span id="cb61-1228"><a href="#cb61-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1229"><a href="#cb61-1229" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb61-1230"><a href="#cb61-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1231"><a href="#cb61-1231" aria-hidden="true" tabindex="-1"></a><span class="in">save_ps &lt;- length(1000)</span></span>
<span id="cb61-1232"><a href="#cb61-1232" aria-hidden="true" tabindex="-1"></a><span class="in">save_ts &lt;- length(1000)</span></span>
<span id="cb61-1233"><a href="#cb61-1233" aria-hidden="true" tabindex="-1"></a><span class="in">for ( i in 1:1000 ){</span></span>
<span id="cb61-1234"><a href="#cb61-1234" aria-hidden="true" tabindex="-1"></a><span class="in">  condition_A &lt;- rnorm(10,10,5)</span></span>
<span id="cb61-1235"><a href="#cb61-1235" aria-hidden="true" tabindex="-1"></a><span class="in">  condition_B &lt;- rnorm(10,10,5)</span></span>
<span id="cb61-1236"><a href="#cb61-1236" aria-hidden="true" tabindex="-1"></a><span class="in">  differences &lt;- condition_A - condition_B</span></span>
<span id="cb61-1237"><a href="#cb61-1237" aria-hidden="true" tabindex="-1"></a><span class="in">  t_test &lt;- t.test(differences, mu=0)</span></span>
<span id="cb61-1238"><a href="#cb61-1238" aria-hidden="true" tabindex="-1"></a><span class="in">  save_ps[i] &lt;- t_test$p.value</span></span>
<span id="cb61-1239"><a href="#cb61-1239" aria-hidden="true" tabindex="-1"></a><span class="in">  save_ts[i] &lt;- t_test$statistic</span></span>
<span id="cb61-1240"><a href="#cb61-1240" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb61-1241"><a href="#cb61-1241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1242"><a href="#cb61-1242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1243"><a href="#cb61-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1246"><a href="#cb61-1246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1247"><a href="#cb61-1247" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6simps1000</span></span>
<span id="cb61-1248"><a href="#cb61-1248" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "1000 simulated ts from the null distribution"</span></span>
<span id="cb61-1249"><a href="#cb61-1249" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ts)</span>
<span id="cb61-1250"><a href="#cb61-1250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1251"><a href="#cb61-1251" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1252"><a href="#cb61-1252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1255"><a href="#cb61-1255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1256"><a href="#cb61-1256" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6simts1000</span></span>
<span id="cb61-1257"><a href="#cb61-1257" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "1000 simulated ps from the null distribution"</span></span>
<span id="cb61-1258"><a href="#cb61-1258" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ps)</span>
<span id="cb61-1259"><a href="#cb61-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1260"><a href="#cb61-1260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1261"><a href="#cb61-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1262"><a href="#cb61-1262" aria-hidden="true" tabindex="-1"></a>According to the simulation. When there are no differences between the conditions, and the samples are being pulled from the very same distribution, you get these two distributions for $t$ and $p$. These again show how the null distribution of no differences behaves.</span>
<span id="cb61-1263"><a href="#cb61-1263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1264"><a href="#cb61-1264" aria-hidden="true" tabindex="-1"></a>For any of these simulations, if you rejected the null-hypothesis (that your difference was only due to chance), you would be making a type I error. If you set your alpha criteria to $\alpha = .05$, we can ask how many type I errors were made in these 1000 simulations. The answer is:</span>
<span id="cb61-1265"><a href="#cb61-1265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1266"><a href="#cb61-1266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb61-1267"><a href="#cb61-1267" aria-hidden="true" tabindex="-1"></a><span class="in">length(save_ps[save_ps&lt;.05])</span></span>
<span id="cb61-1268"><a href="#cb61-1268" aria-hidden="true" tabindex="-1"></a><span class="in">length(save_ps[save_ps&lt;.05])/1000</span></span>
<span id="cb61-1269"><a href="#cb61-1269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1270"><a href="#cb61-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1271"><a href="#cb61-1271" aria-hidden="true" tabindex="-1"></a>We happened to make <span class="in">`r length(save_ps[save_ps&lt;.05])`</span>. The expectation over the long run is 5% type I error rates (if your alpha is .05).</span>
<span id="cb61-1272"><a href="#cb61-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1273"><a href="#cb61-1273" aria-hidden="true" tabindex="-1"></a>What happens if there actually is a difference in the simulated data, let's set one condition to have a larger mean than the other:</span>
<span id="cb61-1274"><a href="#cb61-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1275"><a href="#cb61-1275" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb61-1276"><a href="#cb61-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1277"><a href="#cb61-1277" aria-hidden="true" tabindex="-1"></a><span class="in">save_ps &lt;- length(1000)</span></span>
<span id="cb61-1278"><a href="#cb61-1278" aria-hidden="true" tabindex="-1"></a><span class="in">save_ts &lt;- length(1000)</span></span>
<span id="cb61-1279"><a href="#cb61-1279" aria-hidden="true" tabindex="-1"></a><span class="in">for ( i in 1:1000 ){</span></span>
<span id="cb61-1280"><a href="#cb61-1280" aria-hidden="true" tabindex="-1"></a><span class="in">  condition_A &lt;- rnorm(10,10,5)</span></span>
<span id="cb61-1281"><a href="#cb61-1281" aria-hidden="true" tabindex="-1"></a><span class="in">  condition_B &lt;- rnorm(10,13,5)</span></span>
<span id="cb61-1282"><a href="#cb61-1282" aria-hidden="true" tabindex="-1"></a><span class="in">  differences &lt;- condition_A - condition_B</span></span>
<span id="cb61-1283"><a href="#cb61-1283" aria-hidden="true" tabindex="-1"></a><span class="in">  t_test &lt;- t.test(differences, mu=0)</span></span>
<span id="cb61-1284"><a href="#cb61-1284" aria-hidden="true" tabindex="-1"></a><span class="in">  save_ps[i] &lt;- t_test$p.value</span></span>
<span id="cb61-1285"><a href="#cb61-1285" aria-hidden="true" tabindex="-1"></a><span class="in">  save_ts[i] &lt;- t_test$statistic</span></span>
<span id="cb61-1286"><a href="#cb61-1286" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb61-1287"><a href="#cb61-1287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1288"><a href="#cb61-1288" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1289"><a href="#cb61-1289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1292"><a href="#cb61-1292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1293"><a href="#cb61-1293" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6simtruets</span></span>
<span id="cb61-1294"><a href="#cb61-1294" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "1000 ts when there is a true difference"</span></span>
<span id="cb61-1295"><a href="#cb61-1295" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ts)</span>
<span id="cb61-1296"><a href="#cb61-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1297"><a href="#cb61-1297" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1298"><a href="#cb61-1298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1301"><a href="#cb61-1301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1302"><a href="#cb61-1302" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6simtrueps</span></span>
<span id="cb61-1303"><a href="#cb61-1303" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "1000 ps when there is a true difference"</span></span>
<span id="cb61-1304"><a href="#cb61-1304" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ps)</span>
<span id="cb61-1305"><a href="#cb61-1305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1306"><a href="#cb61-1306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1307"><a href="#cb61-1307" aria-hidden="true" tabindex="-1"></a>Now you can see that the $p$-value distribution is skewed to the left. This is because when there is a true effect, you will get p-values that are less than .05 more often. Or, rather, you get larger $t$ values than you normally would if there were no differences.</span>
<span id="cb61-1308"><a href="#cb61-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1309"><a href="#cb61-1309" aria-hidden="true" tabindex="-1"></a>In this case, we wouldn't be making a type I error if we rejected the null when p was smaller than .05. How many times would we do that out of our 1000 experiments?</span>
<span id="cb61-1310"><a href="#cb61-1310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1311"><a href="#cb61-1311" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb61-1312"><a href="#cb61-1312" aria-hidden="true" tabindex="-1"></a><span class="in">length(save_ps[save_ps&lt;.05])</span></span>
<span id="cb61-1313"><a href="#cb61-1313" aria-hidden="true" tabindex="-1"></a><span class="in">length(save_ps[save_ps&lt;.05])/1000</span></span>
<span id="cb61-1314"><a href="#cb61-1314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1315"><a href="#cb61-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1316"><a href="#cb61-1316" aria-hidden="true" tabindex="-1"></a>We happened to get <span class="in">`r length(save_ps[save_ps&lt;.05])`</span> simulations where p was less than .05, that's only <span class="in">`r length(save_ps[save_ps&lt;.05])/1000`</span> experiments. If you were the researcher, would you want to run an experiment that would be successful only <span class="in">`r length(save_ps[save_ps&lt;.05])/1000`</span> of the time? I wouldn't. I would run a better experiment.</span>
<span id="cb61-1317"><a href="#cb61-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1318"><a href="#cb61-1318" aria-hidden="true" tabindex="-1"></a>How would you run a better simulated experiment? Well, you could increase $n$, the number of subjects in the experiment. Let's increase $n$ from 10 to 100, and see what happens to the number of "significant" simulated experiments.</span>
<span id="cb61-1319"><a href="#cb61-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1320"><a href="#cb61-1320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb61-1321"><a href="#cb61-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1322"><a href="#cb61-1322" aria-hidden="true" tabindex="-1"></a><span class="in">save_ps &lt;- length(1000)</span></span>
<span id="cb61-1323"><a href="#cb61-1323" aria-hidden="true" tabindex="-1"></a><span class="in">save_ts &lt;- length(1000)</span></span>
<span id="cb61-1324"><a href="#cb61-1324" aria-hidden="true" tabindex="-1"></a><span class="in">for ( i in 1:1000 ){</span></span>
<span id="cb61-1325"><a href="#cb61-1325" aria-hidden="true" tabindex="-1"></a><span class="in">  condition_A &lt;- rnorm(100,10,5)</span></span>
<span id="cb61-1326"><a href="#cb61-1326" aria-hidden="true" tabindex="-1"></a><span class="in">  condition_B &lt;- rnorm(100,13,5)</span></span>
<span id="cb61-1327"><a href="#cb61-1327" aria-hidden="true" tabindex="-1"></a><span class="in">  differences &lt;- condition_A - condition_B</span></span>
<span id="cb61-1328"><a href="#cb61-1328" aria-hidden="true" tabindex="-1"></a><span class="in">  t_test &lt;- t.test(differences, mu=0)</span></span>
<span id="cb61-1329"><a href="#cb61-1329" aria-hidden="true" tabindex="-1"></a><span class="in">  save_ps[i] &lt;- t_test$p.value</span></span>
<span id="cb61-1330"><a href="#cb61-1330" aria-hidden="true" tabindex="-1"></a><span class="in">  save_ts[i] &lt;- t_test$statistic</span></span>
<span id="cb61-1331"><a href="#cb61-1331" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb61-1332"><a href="#cb61-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1333"><a href="#cb61-1333" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1334"><a href="#cb61-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1337"><a href="#cb61-1337" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1338"><a href="#cb61-1338" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6simtsB</span></span>
<span id="cb61-1339"><a href="#cb61-1339" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "1000 ts for n =100, when there is a true effect"</span></span>
<span id="cb61-1340"><a href="#cb61-1340" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ts)</span>
<span id="cb61-1341"><a href="#cb61-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1342"><a href="#cb61-1342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1343"><a href="#cb61-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1346"><a href="#cb61-1346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1347"><a href="#cb61-1347" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6simpsB</span></span>
<span id="cb61-1348"><a href="#cb61-1348" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "1000 ps for n =100, when there is a true effect"</span></span>
<span id="cb61-1349"><a href="#cb61-1349" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ps)</span>
<span id="cb61-1350"><a href="#cb61-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1351"><a href="#cb61-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1352"><a href="#cb61-1352" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(save_ps[save_ps<span class="sc">&lt;</span>.<span class="dv">05</span>])</span>
<span id="cb61-1353"><a href="#cb61-1353" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(save_ps[save_ps<span class="sc">&lt;</span>.<span class="dv">05</span>])<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb61-1354"><a href="#cb61-1354" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1355"><a href="#cb61-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1356"><a href="#cb61-1356" aria-hidden="true" tabindex="-1"></a>Cool, now almost all of the experiments show a $p$-value of less than .05 (using a two-tailed test, that's the default in R). See, you could use this simulation process to determine how many subjects you need to reliably find your effect.</span>
<span id="cb61-1357"><a href="#cb61-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1358"><a href="#cb61-1358" aria-hidden="true" tabindex="-1"></a><span class="fu">### Simulating an independent samples t.test</span></span>
<span id="cb61-1359"><a href="#cb61-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1360"><a href="#cb61-1360" aria-hidden="true" tabindex="-1"></a>Just change the t.test function like so... this is for the null, assuming no difference between groups.</span>
<span id="cb61-1361"><a href="#cb61-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1362"><a href="#cb61-1362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=TRUE}</span></span>
<span id="cb61-1363"><a href="#cb61-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1364"><a href="#cb61-1364" aria-hidden="true" tabindex="-1"></a><span class="in">save_ps &lt;- length(1000)</span></span>
<span id="cb61-1365"><a href="#cb61-1365" aria-hidden="true" tabindex="-1"></a><span class="in">save_ts &lt;- length(1000)</span></span>
<span id="cb61-1366"><a href="#cb61-1366" aria-hidden="true" tabindex="-1"></a><span class="in">for ( i in 1:1000 ){</span></span>
<span id="cb61-1367"><a href="#cb61-1367" aria-hidden="true" tabindex="-1"></a><span class="in">  group_A &lt;- rnorm(10,10,5)</span></span>
<span id="cb61-1368"><a href="#cb61-1368" aria-hidden="true" tabindex="-1"></a><span class="in">  group_B &lt;- rnorm(10,10,5)</span></span>
<span id="cb61-1369"><a href="#cb61-1369" aria-hidden="true" tabindex="-1"></a><span class="in">  t_test &lt;- t.test(group_A, group_B, paired=FALSE, var.equal=TRUE)</span></span>
<span id="cb61-1370"><a href="#cb61-1370" aria-hidden="true" tabindex="-1"></a><span class="in">  save_ps[i] &lt;- t_test$p.value</span></span>
<span id="cb61-1371"><a href="#cb61-1371" aria-hidden="true" tabindex="-1"></a><span class="in">  save_ts[i] &lt;- t_test$statistic</span></span>
<span id="cb61-1372"><a href="#cb61-1372" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb61-1373"><a href="#cb61-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1374"><a href="#cb61-1374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1375"><a href="#cb61-1375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1378"><a href="#cb61-1378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1379"><a href="#cb61-1379" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6simtsC</span></span>
<span id="cb61-1380"><a href="#cb61-1380" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "1000 ts for n =100, when there is a true effect"</span></span>
<span id="cb61-1381"><a href="#cb61-1381" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ts)</span>
<span id="cb61-1382"><a href="#cb61-1382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1383"><a href="#cb61-1383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1384"><a href="#cb61-1384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1387"><a href="#cb61-1387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb61-1388"><a href="#cb61-1388" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: fig-6simpsC</span></span>
<span id="cb61-1389"><a href="#cb61-1389" aria-hidden="true" tabindex="-1"></a><span class="co">#| fig-cap: "1000 ps for n =100, when there is a true effect"</span></span>
<span id="cb61-1390"><a href="#cb61-1390" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(save_ps)</span>
<span id="cb61-1391"><a href="#cb61-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1392"><a href="#cb61-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1393"><a href="#cb61-1393" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(save_ps[save_ps<span class="sc">&lt;</span>.<span class="dv">05</span>])</span>
<span id="cb61-1394"><a href="#cb61-1394" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(save_ps[save_ps<span class="sc">&lt;</span>.<span class="dv">05</span>])<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb61-1395"><a href="#cb61-1395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1396"><a href="#cb61-1396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1397"><a href="#cb61-1397" aria-hidden="true" tabindex="-1"></a><span class="fu">## Videos</span></span>
<span id="cb61-1398"><a href="#cb61-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1399"><a href="#cb61-1399" aria-hidden="true" tabindex="-1"></a><span class="fu">### One or Two tailed tests</span></span>
<span id="cb61-1400"><a href="#cb61-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1401"><a href="#cb61-1401" aria-hidden="true" tabindex="-1"></a>&lt;iframe width="560" height="315" src="https://www.youtube.com/embed/PuoGsguuY30" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen&gt;</span>
<span id="cb61-1402"><a href="#cb61-1402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1403"><a href="#cb61-1403" aria-hidden="true" tabindex="-1"></a>&lt;/iframe&gt;</span>
<span id="cb61-1404"><a href="#cb61-1404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1405"><a href="#cb61-1405" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb61-1406"><a href="#cb61-1406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1407"><a href="#cb61-1407" aria-hidden="true" tabindex="-1"></a>Gordon Original <span class="sc">\#</span># 1. Introduction</span>
<span id="cb61-1408"><a href="#cb61-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1409"><a href="#cb61-1409" aria-hidden="true" tabindex="-1"></a>The t-test is a fundamental statistical method used in psychology to compare the means of two groups. This chapter will explore the theory behind t-tests, demonstrate practical applications using R, and provide a structured write-up in APA style. Whether you're examining the effectiveness of a new therapy or comparing cognitive performance between groups, the t-test is an essential tool for psychological research.</span>
<span id="cb61-1410"><a href="#cb61-1410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1411"><a href="#cb61-1411" aria-hidden="true" tabindex="-1"></a><span class="fu">## 2. Main Content</span></span>
<span id="cb61-1412"><a href="#cb61-1412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1413"><a href="#cb61-1413" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.1 Theory of T-Tests</span></span>
<span id="cb61-1414"><a href="#cb61-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1415"><a href="#cb61-1415" aria-hidden="true" tabindex="-1"></a>A t-test evaluates whether the means of two groups are statistically different from each other. The most common types are the independent samples t-test, paired samples t-test, and one-sample t-test. Each type tests different hypotheses and has unique assumptions.</span>
<span id="cb61-1416"><a href="#cb61-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1417"><a href="#cb61-1417" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2.1.1 Independent Samples T-Test</span></span>
<span id="cb61-1418"><a href="#cb61-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1419"><a href="#cb61-1419" aria-hidden="true" tabindex="-1"></a>This test compares the means of two independent groups to ascertain if there is statistical evidence that the associated population means are significantly different.</span>
<span id="cb61-1420"><a href="#cb61-1420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1421"><a href="#cb61-1421" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2.1.2 Paired Samples T-Test</span></span>
<span id="cb61-1422"><a href="#cb61-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1423"><a href="#cb61-1423" aria-hidden="true" tabindex="-1"></a>This test compares means from the same group at different times (e.g., before and after a treatment) or matched pairs.</span>
<span id="cb61-1424"><a href="#cb61-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1425"><a href="#cb61-1425" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 2.1.3 One-Sample T-Test</span></span>
<span id="cb61-1426"><a href="#cb61-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1427"><a href="#cb61-1427" aria-hidden="true" tabindex="-1"></a>This test determines whether the mean of a single group is different from a known mean.</span>
<span id="cb61-1428"><a href="#cb61-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1429"><a href="#cb61-1429" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2 Assumptions of T-Tests</span></span>
<span id="cb61-1430"><a href="#cb61-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1431"><a href="#cb61-1431" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Independence**: Observations within each group must be independent.</span>
<span id="cb61-1432"><a href="#cb61-1432" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Normality**: Data in each group should be approximately normally distributed.</span>
<span id="cb61-1433"><a href="#cb61-1433" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Homogeneity of Variance**: Variances in the two groups should be roughly equal (for independent samples t-test).</span>
<span id="cb61-1434"><a href="#cb61-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1435"><a href="#cb61-1435" aria-hidden="true" tabindex="-1"></a><span class="fu">## 3. Methods and Measures</span></span>
<span id="cb61-1436"><a href="#cb61-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1437"><a href="#cb61-1437" aria-hidden="true" tabindex="-1"></a>To conduct a t-test, you need to: 1. Formulate the null (H0) and alternative (H1) hypotheses. 2. Collect and organize data. 3. Check assumptions. 4. Calculate the t-statistic and degrees of freedom. 5. Determine the p-value. 6. Make a decision to reject or fail to reject H0 based on the p-value.</span>
<span id="cb61-1438"><a href="#cb61-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1439"><a href="#cb61-1439" aria-hidden="true" tabindex="-1"></a><span class="fu">### Example Study</span></span>
<span id="cb61-1440"><a href="#cb61-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1441"><a href="#cb61-1441" aria-hidden="true" tabindex="-1"></a>**Research Question**: Does a new cognitive-behavioral therapy (CBT) improve anxiety levels more than a placebo?</span>
<span id="cb61-1442"><a href="#cb61-1442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1443"><a href="#cb61-1443" aria-hidden="true" tabindex="-1"></a>**Hypotheses**: - H0: There is no difference in anxiety levels between the CBT and placebo groups. - H1: The CBT group has lower anxiety levels than the placebo group.</span>
<span id="cb61-1444"><a href="#cb61-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1445"><a href="#cb61-1445" aria-hidden="true" tabindex="-1"></a>**Measures**: Anxiety levels are measured using a standardized anxiety inventory.</span>
<span id="cb61-1446"><a href="#cb61-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1447"><a href="#cb61-1447" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4. Analysis with R Code</span></span>
<span id="cb61-1448"><a href="#cb61-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1449"><a href="#cb61-1449" aria-hidden="true" tabindex="-1"></a>Let's use R for an independent samples t-test.</span>
<span id="cb61-1450"><a href="#cb61-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1451"><a href="#cb61-1451" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Setup</span></span>
<span id="cb61-1452"><a href="#cb61-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1453"><a href="#cb61-1453" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr-r}</span></span>
<span id="cb61-1454"><a href="#cb61-1454" aria-hidden="true" tabindex="-1"></a><span class="in"># Simulated data</span></span>
<span id="cb61-1455"><a href="#cb61-1455" aria-hidden="true" tabindex="-1"></a><span class="in">CBT &lt;- c(23, 19, 21, 22, 20, 24, 25, 18, 22, 23)</span></span>
<span id="cb61-1456"><a href="#cb61-1456" aria-hidden="true" tabindex="-1"></a><span class="in">Placebo &lt;- c(30, 28, 27, 29, 31, 32, 33, 30, 29, 28)</span></span>
<span id="cb61-1457"><a href="#cb61-1457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1458"><a href="#cb61-1458" aria-hidden="true" tabindex="-1"></a><span class="in"># Combine into a data frame</span></span>
<span id="cb61-1459"><a href="#cb61-1459" aria-hidden="true" tabindex="-1"></a><span class="in">data &lt;- data.frame(</span></span>
<span id="cb61-1460"><a href="#cb61-1460" aria-hidden="true" tabindex="-1"></a><span class="in">  group = factor(rep(c("CBT", "Placebo"), each = 10)),</span></span>
<span id="cb61-1461"><a href="#cb61-1461" aria-hidden="true" tabindex="-1"></a><span class="in">  anxiety = c(CBT, Placebo)</span></span>
<span id="cb61-1462"><a href="#cb61-1462" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb61-1463"><a href="#cb61-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1464"><a href="#cb61-1464" aria-hidden="true" tabindex="-1"></a><span class="in"># View the data</span></span>
<span id="cb61-1465"><a href="#cb61-1465" aria-hidden="true" tabindex="-1"></a><span class="in">print(data)</span></span>
<span id="cb61-1466"><a href="#cb61-1466" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1467"><a href="#cb61-1467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1468"><a href="#cb61-1468" aria-hidden="true" tabindex="-1"></a><span class="fu">### Conducting the T-Test</span></span>
<span id="cb61-1469"><a href="#cb61-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1470"><a href="#cb61-1470" aria-hidden="true" tabindex="-1"></a><span class="in">```{webr-r}</span></span>
<span id="cb61-1471"><a href="#cb61-1471" aria-hidden="true" tabindex="-1"></a><span class="in"># Independent samples t-test</span></span>
<span id="cb61-1472"><a href="#cb61-1472" aria-hidden="true" tabindex="-1"></a><span class="in">t_test_results &lt;- t.test(anxiety ~ group, data = data)</span></span>
<span id="cb61-1473"><a href="#cb61-1473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1474"><a href="#cb61-1474" aria-hidden="true" tabindex="-1"></a><span class="in"># Display the results</span></span>
<span id="cb61-1475"><a href="#cb61-1475" aria-hidden="true" tabindex="-1"></a><span class="in">print(t_test_results)</span></span>
<span id="cb61-1476"><a href="#cb61-1476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1477"><a href="#cb61-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1478"><a href="#cb61-1478" aria-hidden="true" tabindex="-1"></a><span class="fu">### R Output Interpretation</span></span>
<span id="cb61-1479"><a href="#cb61-1479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1480"><a href="#cb61-1480" aria-hidden="true" tabindex="-1"></a>The <span class="in">`t.test`</span> function provides the t-statistic, degrees of freedom, and p-value. If the p-value is less than the significance level (e.g., 0.05), we reject H0.</span>
<span id="cb61-1481"><a href="#cb61-1481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1482"><a href="#cb61-1482" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb61-1483"><a href="#cb61-1483" aria-hidden="true" tabindex="-1"></a><span class="in">    Welch Two Sample t-test</span></span>
<span id="cb61-1484"><a href="#cb61-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1485"><a href="#cb61-1485" aria-hidden="true" tabindex="-1"></a><span class="in">data:  anxiety by group</span></span>
<span id="cb61-1486"><a href="#cb61-1486" aria-hidden="true" tabindex="-1"></a><span class="in">t = -8.6943, df = 17.564, p-value = 8.922e-08</span></span>
<span id="cb61-1487"><a href="#cb61-1487" aria-hidden="true" tabindex="-1"></a><span class="in">alternative hypothesis: true difference in means between group CBT and group Placebo is not equal to 0</span></span>
<span id="cb61-1488"><a href="#cb61-1488" aria-hidden="true" tabindex="-1"></a><span class="in">95 percent confidence interval:</span></span>
<span id="cb61-1489"><a href="#cb61-1489" aria-hidden="true" tabindex="-1"></a><span class="in"> -9.936595 -6.063405</span></span>
<span id="cb61-1490"><a href="#cb61-1490" aria-hidden="true" tabindex="-1"></a><span class="in">sample estimates:</span></span>
<span id="cb61-1491"><a href="#cb61-1491" aria-hidden="true" tabindex="-1"></a><span class="in">    mean in group CBT mean in group Placebo </span></span>
<span id="cb61-1492"><a href="#cb61-1492" aria-hidden="true" tabindex="-1"></a><span class="in">                 21.7                  29.7</span></span>
<span id="cb61-1493"><a href="#cb61-1493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb61-1494"><a href="#cb61-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1495"><a href="#cb61-1495" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5. Debates and Controversies</span></span>
<span id="cb61-1496"><a href="#cb61-1496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1497"><a href="#cb61-1497" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5.1 Assumption Violations</span></span>
<span id="cb61-1498"><a href="#cb61-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1499"><a href="#cb61-1499" aria-hidden="true" tabindex="-1"></a>Violating assumptions (e.g., normality, homogeneity of variance) can lead to incorrect conclusions. Robust alternatives or data transformations may be necessary (Wilcox, 2012).</span>
<span id="cb61-1500"><a href="#cb61-1500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1501"><a href="#cb61-1501" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5.2 P-Value Misinterpretation</span></span>
<span id="cb61-1502"><a href="#cb61-1502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1503"><a href="#cb61-1503" aria-hidden="true" tabindex="-1"></a>Overreliance on p-values can lead to misinterpretation of results. It’s crucial to report effect sizes and confidence intervals (Cumming, 2014).</span>
<span id="cb61-1504"><a href="#cb61-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1505"><a href="#cb61-1505" aria-hidden="true" tabindex="-1"></a><span class="fu">### 5.3 Multiple Comparisons</span></span>
<span id="cb61-1506"><a href="#cb61-1506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1507"><a href="#cb61-1507" aria-hidden="true" tabindex="-1"></a>Conducting multiple t-tests increases the risk of Type I errors. Methods like Bonferroni correction adjust for this but can be overly conservative (Perneger, 1998).</span>
<span id="cb61-1508"><a href="#cb61-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1509"><a href="#cb61-1509" aria-hidden="true" tabindex="-1"></a><span class="fu">## 6. Conclusion</span></span>
<span id="cb61-1510"><a href="#cb61-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1511"><a href="#cb61-1511" aria-hidden="true" tabindex="-1"></a>T-tests are a vital statistical method in psychological research for comparing means between groups. Understanding their theory, assumptions, and correct application in R can significantly enhance the rigor of your analyses. Always ensure to check assumptions, consider effect sizes, and be mindful of the limitations and debates surrounding t-tests.</span>
<span id="cb61-1512"><a href="#cb61-1512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1513"><a href="#cb61-1513" aria-hidden="true" tabindex="-1"></a><span class="fu">### References</span></span>
<span id="cb61-1514"><a href="#cb61-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1515"><a href="#cb61-1515" aria-hidden="true" tabindex="-1"></a>Cumming, G. (2014). The new statistics: Why and how. *Psychological Science*, 25(1), 7-29.</span>
<span id="cb61-1516"><a href="#cb61-1516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1517"><a href="#cb61-1517" aria-hidden="true" tabindex="-1"></a>Perneger, T. V. (1998). What's wrong with Bonferroni adjustments. *BMJ*, 316(7139), 1236-1238.</span>
<span id="cb61-1518"><a href="#cb61-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1519"><a href="#cb61-1519" aria-hidden="true" tabindex="-1"></a>Wilcox, R. R. (2012). Modern statistics for the social and behavioral sciences: A practical introduction. *CRC Press*.</span>
<span id="cb61-1520"><a href="#cb61-1520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1521"><a href="#cb61-1521" aria-hidden="true" tabindex="-1"></a>This chapter provides a comprehensive overview of conducting t-tests in R, essential for first-year psychology students. Future chapters will delve into more advanced statistical methods to further enhance your analytical skills.</span>
<span id="cb61-1522"><a href="#cb61-1522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1523"><a href="#cb61-1523" aria-hidden="true" tabindex="-1"></a><span class="fu"># Glossary</span></span>
<span id="cb61-1524"><a href="#cb61-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1525"><a href="#cb61-1525" aria-hidden="true" tabindex="-1"></a>Certainly! Here's a glossary of key terms related to 'T-Tests in R with theory, practicals, and write-up in Psychology APA-style':</span>
<span id="cb61-1526"><a href="#cb61-1526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1527"><a href="#cb61-1527" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**T-Test**</span>
<span id="cb61-1528"><a href="#cb61-1528" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: A statistical test used to determine if there is a significant difference between the means of two groups. It is commonly used in hypothesis testing.</span>
<span id="cb61-1529"><a href="#cb61-1529" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Independent Samples T-Test**</span>
<span id="cb61-1530"><a href="#cb61-1530" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: A type of t-test used when comparing the means of two independent groups to see if there is a significant difference between them.</span>
<span id="cb61-1531"><a href="#cb61-1531" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Paired Samples T-Test**</span>
<span id="cb61-1532"><a href="#cb61-1532" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: A t-test used when comparing the means of two related groups, such as measurements taken from the same subjects at two different times.</span>
<span id="cb61-1533"><a href="#cb61-1533" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Null Hypothesis (H0)**</span>
<span id="cb61-1534"><a href="#cb61-1534" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: A hypothesis that there is no significant difference between specified populations, any observed difference being due to sampling or experimental error.</span>
<span id="cb61-1535"><a href="#cb61-1535" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Alternative Hypothesis (H1)**</span>
<span id="cb61-1536"><a href="#cb61-1536" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: A hypothesis that states there is a significant difference between specified populations, contrary to the null hypothesis.</span>
<span id="cb61-1537"><a href="#cb61-1537" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>**P-Value**</span>
<span id="cb61-1538"><a href="#cb61-1538" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: The probability that the observed results occurred by chance. A p-value less than 0.05 is typically considered statistically significant.</span>
<span id="cb61-1539"><a href="#cb61-1539" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>**Degrees of Freedom (df)**</span>
<span id="cb61-1540"><a href="#cb61-1540" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: The number of values in a calculation that are free to vary. In t-tests, degrees of freedom are used to determine the critical value from the t-distribution.</span>
<span id="cb61-1541"><a href="#cb61-1541" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>**Effect Size**</span>
<span id="cb61-1542"><a href="#cb61-1542" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: A measure of the magnitude of the difference between groups. Common effect size metrics include Cohen's d.</span>
<span id="cb61-1543"><a href="#cb61-1543" aria-hidden="true" tabindex="-1"></a><span class="ss">9.  </span>**R Programming Language**</span>
<span id="cb61-1544"><a href="#cb61-1544" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: A programming language and environment commonly used for statistical computing and graphics, including performing t-tests.</span>
<span id="cb61-1545"><a href="#cb61-1545" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>**Psychology APA-Style**</span>
<span id="cb61-1546"><a href="#cb61-1546" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: The writing and citation style prescribed by the American Psychological Association, commonly used in psychology for structuring research papers and reports.</span>
<span id="cb61-1547"><a href="#cb61-1547" aria-hidden="true" tabindex="-1"></a><span class="ss">11. </span>**Mean (M or μ)**</span>
<span id="cb61-1548"><a href="#cb61-1548" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: The average of a set of numbers, calculated by summing them up and dividing by the count of numbers.</span>
<span id="cb61-1549"><a href="#cb61-1549" aria-hidden="true" tabindex="-1"></a><span class="ss">12. </span>**Standard Deviation (SD or σ)**</span>
<span id="cb61-1550"><a href="#cb61-1550" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: A measure of the amount of variation or dispersion in a set of values.</span>
<span id="cb61-1551"><a href="#cb61-1551" aria-hidden="true" tabindex="-1"></a><span class="ss">13. </span>**Confidence Interval (CI)**</span>
<span id="cb61-1552"><a href="#cb61-1552" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: A range of values derived from the sample data that is likely to contain the population parameter with a specified level of confidence, usually 95%.</span>
<span id="cb61-1553"><a href="#cb61-1553" aria-hidden="true" tabindex="-1"></a><span class="ss">14. </span>**T-Distribution**</span>
<span id="cb61-1554"><a href="#cb61-1554" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: A type of probability distribution that is symmetric and bell-shaped but has heavier tails than the normal distribution. It is used in t-tests, especially when sample sizes are small.</span>
<span id="cb61-1555"><a href="#cb61-1555" aria-hidden="true" tabindex="-1"></a><span class="ss">15. </span>**Data Frame**</span>
<span id="cb61-1556"><a href="#cb61-1556" aria-hidden="true" tabindex="-1"></a><span class="ss">    -   </span>**Definition**: A table or two-dimensional array-like structure in R, where each column contains values of one variable and each row contains one set of values from each column.</span>
<span id="cb61-1557"><a href="#cb61-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1558"><a href="#cb61-1558" aria-hidden="true" tabindex="-1"></a>These terms will help students grasp the fundamental concepts and techniques involved in performing and reporting t-tests in R, especially within the context of psychological research adhering to APA style.</span>
<span id="cb61-1559"><a href="#cb61-1559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1560"><a href="#cb61-1560" aria-hidden="true" tabindex="-1"></a><span class="fu"># Self-Assessment Quiz</span></span>
<span id="cb61-1561"><a href="#cb61-1561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1562"><a href="#cb61-1562" aria-hidden="true" tabindex="-1"></a><span class="fu">### Self-Assessment Quiz: T-Tests in R with Theory, Practicals, and Write-up in Psychology APA-style</span></span>
<span id="cb61-1563"><a href="#cb61-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1564"><a href="#cb61-1564" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Multiple-Choice Questions</span></span>
<span id="cb61-1565"><a href="#cb61-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1566"><a href="#cb61-1566" aria-hidden="true" tabindex="-1"></a>**1. What is the primary purpose of a t-test in statistics?** a) To compare three or more means\</span>
<span id="cb61-1567"><a href="#cb61-1567" aria-hidden="true" tabindex="-1"></a>b) To determine the relationship between two categorical variables\</span>
<span id="cb61-1568"><a href="#cb61-1568" aria-hidden="true" tabindex="-1"></a>c) To compare the means of two groups\</span>
<span id="cb61-1569"><a href="#cb61-1569" aria-hidden="true" tabindex="-1"></a>d) To analyze the variance within a single group</span>
<span id="cb61-1570"><a href="#cb61-1570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1571"><a href="#cb61-1571" aria-hidden="true" tabindex="-1"></a>**Answer: c) To compare the means of two groups**</span>
<span id="cb61-1572"><a href="#cb61-1572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1573"><a href="#cb61-1573" aria-hidden="true" tabindex="-1"></a>**2. In R, which function is commonly used to perform an independent t-test?** a) t_test()\</span>
<span id="cb61-1574"><a href="#cb61-1574" aria-hidden="true" tabindex="-1"></a>b) ttest()\</span>
<span id="cb61-1575"><a href="#cb61-1575" aria-hidden="true" tabindex="-1"></a>c) t.test()\</span>
<span id="cb61-1576"><a href="#cb61-1576" aria-hidden="true" tabindex="-1"></a>d) TTest()</span>
<span id="cb61-1577"><a href="#cb61-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1578"><a href="#cb61-1578" aria-hidden="true" tabindex="-1"></a>**Answer: c) t.test()**</span>
<span id="cb61-1579"><a href="#cb61-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1580"><a href="#cb61-1580" aria-hidden="true" tabindex="-1"></a>**3. What is the null hypothesis in an independent samples t-test?** a) The means of the two groups are equal\</span>
<span id="cb61-1581"><a href="#cb61-1581" aria-hidden="true" tabindex="-1"></a>b) The means of the two groups are not equal\</span>
<span id="cb61-1582"><a href="#cb61-1582" aria-hidden="true" tabindex="-1"></a>c) The variances of the two groups are equal\</span>
<span id="cb61-1583"><a href="#cb61-1583" aria-hidden="true" tabindex="-1"></a>d) The variances of the two groups are not equal</span>
<span id="cb61-1584"><a href="#cb61-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1585"><a href="#cb61-1585" aria-hidden="true" tabindex="-1"></a>**Answer: a) The means of the two groups are equal**</span>
<span id="cb61-1586"><a href="#cb61-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1587"><a href="#cb61-1587" aria-hidden="true" tabindex="-1"></a>**4. Which of the following is NOT a requirement for conducting a t-test?** a) The data should be approximately normally distributed\</span>
<span id="cb61-1588"><a href="#cb61-1588" aria-hidden="true" tabindex="-1"></a>b) The samples should be independent\</span>
<span id="cb61-1589"><a href="#cb61-1589" aria-hidden="true" tabindex="-1"></a>c) The sample sizes must be equal\</span>
<span id="cb61-1590"><a href="#cb61-1590" aria-hidden="true" tabindex="-1"></a>d) The variances should be roughly equal (for independent t-tests)</span>
<span id="cb61-1591"><a href="#cb61-1591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1592"><a href="#cb61-1592" aria-hidden="true" tabindex="-1"></a>**Answer: c) The sample sizes must be equal**</span>
<span id="cb61-1593"><a href="#cb61-1593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1594"><a href="#cb61-1594" aria-hidden="true" tabindex="-1"></a><span class="fu">#### True/False Questions</span></span>
<span id="cb61-1595"><a href="#cb61-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1596"><a href="#cb61-1596" aria-hidden="true" tabindex="-1"></a>**5. A paired t-test is appropriate when comparing the means of two related groups.** **True**</span>
<span id="cb61-1597"><a href="#cb61-1597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1598"><a href="#cb61-1598" aria-hidden="true" tabindex="-1"></a>**6. In R, the `t.test()` function can only be used for independent t-tests.** **False**</span>
<span id="cb61-1599"><a href="#cb61-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1600"><a href="#cb61-1600" aria-hidden="true" tabindex="-1"></a>**7. The p-value in a t-test indicates the probability that the observed differences in sample means occurred by chance.** **True**</span>
<span id="cb61-1601"><a href="#cb61-1601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1602"><a href="#cb61-1602" aria-hidden="true" tabindex="-1"></a>**8. The degrees of freedom for an independent t-test with two samples of 15 participants each would be 28.** **False** (It's 28; df = n1 + n2 - 2, so 15 + 15 - 2 = 28)</span>
<span id="cb61-1603"><a href="#cb61-1603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1604"><a href="#cb61-1604" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Short Answer Questions</span></span>
<span id="cb61-1605"><a href="#cb61-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1606"><a href="#cb61-1606" aria-hidden="true" tabindex="-1"></a>**9. Describe in a few sentences the steps to perform an independent t-test in R, including any necessary data preparation.**</span>
<span id="cb61-1607"><a href="#cb61-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1608"><a href="#cb61-1608" aria-hidden="true" tabindex="-1"></a>**Answer: To perform an independent t-test in R, follow these steps:** - Load your data into R, typically using <span class="in">`read.csv()`</span> or similar functions. - Inspect and clean your data to ensure it meets the assumptions of the t-test (e.g., checking for normality and independence). - Use the <span class="in">`t.test()`</span> function, specifying the two groups you wish to compare. - Interpret the output, which includes the t-value, degrees of freedom, and p-value, to determine whether to reject the null hypothesis.</span>
<span id="cb61-1609"><a href="#cb61-1609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1610"><a href="#cb61-1610" aria-hidden="true" tabindex="-1"></a>**10. Write an example of how to report the results of an independent t-test in APA style.**</span>
<span id="cb61-1611"><a href="#cb61-1611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1612"><a href="#cb61-1612" aria-hidden="true" tabindex="-1"></a>**Answer: An example APA-style write-up might look like this:** - "An independent samples t-test was conducted to compare the test scores for Group A and Group B. There was a significant difference in scores between Group A (M = 85.3, SD = 5.2) and Group B (M = 78.4, SD = 6.1); t(28) = 3.45, p <span class="sc">\&lt;</span> .01. These results suggest that the intervention had a significant effect on test scores."</span>
<span id="cb61-1613"><a href="#cb61-1613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1614"><a href="#cb61-1614" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Answer Key</span></span>
<span id="cb61-1615"><a href="#cb61-1615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1616"><a href="#cb61-1616" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span></span>
<span id="cb61-1617"><a href="#cb61-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1618"><a href="#cb61-1618" aria-hidden="true" tabindex="-1"></a>    c)  To compare the means of two groups</span>
<span id="cb61-1619"><a href="#cb61-1619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1620"><a href="#cb61-1620" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span></span>
<span id="cb61-1621"><a href="#cb61-1621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1622"><a href="#cb61-1622" aria-hidden="true" tabindex="-1"></a>    c)  t.test()</span>
<span id="cb61-1623"><a href="#cb61-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1624"><a href="#cb61-1624" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span></span>
<span id="cb61-1625"><a href="#cb61-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1626"><a href="#cb61-1626" aria-hidden="true" tabindex="-1"></a>    a)  The means of the two groups are equal</span>
<span id="cb61-1627"><a href="#cb61-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1628"><a href="#cb61-1628" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span></span>
<span id="cb61-1629"><a href="#cb61-1629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1630"><a href="#cb61-1630" aria-hidden="true" tabindex="-1"></a>    c)  The sample sizes must be equal</span>
<span id="cb61-1631"><a href="#cb61-1631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1632"><a href="#cb61-1632" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>True</span>
<span id="cb61-1633"><a href="#cb61-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1634"><a href="#cb61-1634" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>False</span>
<span id="cb61-1635"><a href="#cb61-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1636"><a href="#cb61-1636" aria-hidden="true" tabindex="-1"></a><span class="ss">7.  </span>True</span>
<span id="cb61-1637"><a href="#cb61-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1638"><a href="#cb61-1638" aria-hidden="true" tabindex="-1"></a><span class="ss">8.  </span>False</span>
<span id="cb61-1639"><a href="#cb61-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1640"><a href="#cb61-1640" aria-hidden="true" tabindex="-1"></a><span class="ss">9.  </span>Answer provided above.</span>
<span id="cb61-1641"><a href="#cb61-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1642"><a href="#cb61-1642" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Answer provided above.</span>
<span id="cb61-1643"><a href="#cb61-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-1644"><a href="#cb61-1644" aria-hidden="true" tabindex="-1"></a>This quiz should help students test their understanding of the key concepts related to t-tests in R, including theoretical understanding, practical application, and APA-style reporting.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>Copyright 2024, Dr.&nbsp;Gordon Wright</p>
<div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/LittleMonkeyLab/introrm/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script type="module">
// Handle cell initialization initialization
qwebrCellDetails.map(
  (entry) => {
    // Handle the creation of the element
    qwebrCreateHTMLElement(entry);
    // In the event of interactive, initialize the monaco editor
    if (entry.options.context == EvalTypes.Interactive) {
      qwebrCreateMonacoEditorInstance(entry);
    }
  }
);

// Identify non-interactive cells (in order)
const filteredEntries = qwebrCellDetails.filter(entry => {
  const contextOption = entry.options && entry.options.context;
  return ['output', 'setup'].includes(contextOption) || (contextOption == "interactive" && entry.options && entry.options.autorun === 'true');
});

// Condition non-interactive cells to only be run after webR finishes its initialization.
qwebrInstance.then(
  async () => {
    const nHiddenCells = filteredEntries.length;
    var currentHiddenCell = 0;


    // Modify button state
    qwebrSetInteractiveButtonState(`🟡 Running hidden code cells ...`, false);

    // Begin processing non-interactive sections
    // Due to the iteration policy, we must use a for() loop.
    // Otherwise, we would need to switch to using reduce with an empty
    // starting promise
    for (const entry of filteredEntries) {

      // Determine cell being examined
      currentHiddenCell = currentHiddenCell + 1;
      const formattedMessage = `Evaluating hidden cell ${currentHiddenCell} out of ${nHiddenCells}`;

      // Update the document status header
      if (qwebrShowStartupMessage) {
        qwebrUpdateStatusHeader(formattedMessage);
      }

      // Display the update in non-active areas
      qwebrUpdateStatusMessage(formattedMessage);

      // Extract details on the active cell
      const evalType = entry.options.context;
      const cellCode = entry.code;
      const qwebrCounter = entry.id;

      if (['output', 'setup'].includes(evalType)) {
        // Disable further global status updates
        const activeContainer = document.getElementById(`qwebr-non-interactive-loading-container-${qwebrCounter}`);
        activeContainer.classList.remove('qwebr-cell-needs-evaluation');
        activeContainer.classList.add('qwebr-cell-evaluated');

        // Update status on the code cell
        const activeStatus = document.getElementById(`qwebr-status-text-${qwebrCounter}`);
        activeStatus.innerText = " Evaluating hidden code cell...";
        activeStatus.classList.remove('qwebr-cell-needs-evaluation');
        activeStatus.classList.add('qwebr-cell-evaluated');
      }

      switch (evalType) {
        case 'interactive':
          // TODO: Make this more standardized.
          // At the moment, we're overriding the interactive status update by pretending its
          // output-like. 
          const tempOptions = entry.options;
          tempOptions["context"] = "output"
          // Run the code in a non-interactive state that is geared to displaying output
          await qwebrExecuteCode(`${cellCode}`, qwebrCounter, tempOptions);
          break;
        case 'output':
          // Run the code in a non-interactive state that is geared to displaying output
          await qwebrExecuteCode(`${cellCode}`, qwebrCounter, entry.options);
          break;
        case 'setup':
          const activeDiv = document.getElementById(`qwebr-noninteractive-setup-area-${qwebrCounter}`);

          // Store code in history
          qwebrLogCodeToHistory(cellCode, entry.options);

          // Run the code in a non-interactive state with all output thrown away
          await mainWebR.evalRVoid(`${cellCode}`);
          break;
        default: 
          break; 
      }

      if (['output', 'setup'].includes(evalType)) {
        // Disable further global status updates
        const activeContainer = document.getElementById(`qwebr-non-interactive-loading-container-${qwebrCounter}`);
        // Disable visibility
        activeContainer.style.visibility = 'hidden';
        activeContainer.style.display = 'none';
      }
    }
  }
).then(
  () => {
    // Release document status as ready

    if (qwebrShowStartupMessage) {
      qwebrStartupMessage.innerText = "🟢 Ready!"
    }
  
    qwebrSetInteractiveButtonState(
      `<i class="fa-solid fa-play qwebr-icon-run-code"></i> <span>Run Code</span>`, 
      true
    );  
  }
);
</script>




</body></html>